+ echo 'Beginning trial 3 of 5'
Beginning trial 3 of 5
++ scontrol show hostname
++ tr '\n' ' '
+ hosts='node047 node048 '
+ echo 'hosts=node047 node048 '
hosts=node047 node048 
+ for node in $hosts
+ srun -N 1 -n 1 -w node047 mpirun --allow-run-as-root -np 1 singularity exec -B /home/mlperf/mlperf-training-v2.0/resnet/scripts:/workspace/image_classification --pwd /workspace/image_classification /mnt/data/resnet_20220509.sif python -c '
import mlperf_log_utils
from mlperf_logging.mllog import constants
mlperf_log_utils.mlperf_submission_log(constants.RESNET)'
:::MLLOG {"namespace": "", "time_ms": 1652470569516, "event_type": "POINT_IN_TIME", "key": "submission_benchmark", "value": "resnet", "metadata": {"file": "/workspace/image_classification/mlperf_log_utils.py", "lineno": 84}}
:::MLLOG {"namespace": "", "time_ms": 1652470569525, "event_type": "POINT_IN_TIME", "key": "submission_org", "value": "Dell", "metadata": {"file": "/workspace/image_classification/mlperf_log_utils.py", "lineno": 89}}
:::MLLOG {"namespace": "", "time_ms": 1652470569526, "event_type": "POINT_IN_TIME", "key": "submission_division", "value": "closed", "metadata": {"file": "/workspace/image_classification/mlperf_log_utils.py", "lineno": 93}}
:::MLLOG {"namespace": "", "time_ms": 1652470569526, "event_type": "POINT_IN_TIME", "key": "submission_status", "value": "onprem", "metadata": {"file": "/workspace/image_classification/mlperf_log_utils.py", "lineno": 97}}
:::MLLOG {"namespace": "", "time_ms": 1652470569526, "event_type": "POINT_IN_TIME", "key": "submission_platform", "value": "2xXE8545x4A100-SXM-80GB", "metadata": {"file": "/workspace/image_classification/mlperf_log_utils.py", "lineno": 101}}
+ '[' 1 -eq 1 ']'
+ srun -N 1 -n 1 -w node047 bash -c 'echo -n '\''Clearing cache on '\'' && hostname && sync && sudo /sbin/sysctl vm.drop_caches=3'
Clearing cache on node047
vm.drop_caches = 3
+ srun -N 1 -n 1 -w node047 mpirun --allow-run-as-root -np 1 singularity exec -B /home/mlperf/mlperf-training-v2.0/resnet/scripts:/workspace/image_classification --pwd /workspace/image_classification /mnt/data/resnet_20220509.sif python -c '
from mlperf_logging.mllog import constants
from mlperf_log_utils import mx_resnet_print_event
mx_resnet_print_event(key=constants.CACHE_CLEAR, val=True)'
:::MLLOG {"namespace": "", "time_ms": 1652470578825, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
+ for node in $hosts
+ srun -N 1 -n 1 -w node048 mpirun --allow-run-as-root -np 1 singularity exec -B /home/mlperf/mlperf-training-v2.0/resnet/scripts:/workspace/image_classification --pwd /workspace/image_classification /mnt/data/resnet_20220509.sif python -c '
import mlperf_log_utils
from mlperf_logging.mllog import constants
mlperf_log_utils.mlperf_submission_log(constants.RESNET)'
:::MLLOG {"namespace": "", "time_ms": 1652470582280, "event_type": "POINT_IN_TIME", "key": "submission_benchmark", "value": "resnet", "metadata": {"file": "/workspace/image_classification/mlperf_log_utils.py", "lineno": 84}}
:::MLLOG {"namespace": "", "time_ms": 1652470582290, "event_type": "POINT_IN_TIME", "key": "submission_org", "value": "Dell", "metadata": {"file": "/workspace/image_classification/mlperf_log_utils.py", "lineno": 89}}
:::MLLOG {"namespace": "", "time_ms": 1652470582290, "event_type": "POINT_IN_TIME", "key": "submission_division", "value": "closed", "metadata": {"file": "/workspace/image_classification/mlperf_log_utils.py", "lineno": 93}}
:::MLLOG {"namespace": "", "time_ms": 1652470582290, "event_type": "POINT_IN_TIME", "key": "submission_status", "value": "onprem", "metadata": {"file": "/workspace/image_classification/mlperf_log_utils.py", "lineno": 97}}
:::MLLOG {"namespace": "", "time_ms": 1652470582290, "event_type": "POINT_IN_TIME", "key": "submission_platform", "value": "2xXE8545x4A100-SXM-80GB", "metadata": {"file": "/workspace/image_classification/mlperf_log_utils.py", "lineno": 101}}
+ '[' 1 -eq 1 ']'
+ srun -N 1 -n 1 -w node048 bash -c 'echo -n '\''Clearing cache on '\'' && hostname && sync && sudo /sbin/sysctl vm.drop_caches=3'
Clearing cache on node048
vm.drop_caches = 3
+ srun -N 1 -n 1 -w node048 mpirun --allow-run-as-root -np 1 singularity exec -B /home/mlperf/mlperf-training-v2.0/resnet/scripts:/workspace/image_classification --pwd /workspace/image_classification /mnt/data/resnet_20220509.sif python -c '
from mlperf_logging.mllog import constants
from mlperf_log_utils import mx_resnet_print_event
mx_resnet_print_event(key=constants.CACHE_CLEAR, val=True)'
:::MLLOG {"namespace": "", "time_ms": 1652470589651, "event_type": "POINT_IN_TIME", "key": "cache_clear", "value": true, "metadata": {"file": "<string>", "lineno": 4}}
+ export SEED=12451
+ SEED=12451
+ MPIRUN='mpirun --allow-run-as-root --bind-to none --report-bindings -np 8'
+ mpirun --allow-run-as-root --bind-to none --report-bindings -np 8 singularity exec --nv -B /dev/shm/ilsvrc12_passthrough:/data -B /home/mlperf/mlperf-training-v2.0/resnet/scripts:/workspace/image_classification --pwd /workspace/image_classification /mnt/data/resnet_20220509.sif bash ./run_and_time_multi.sh
+ source ./config_2xXE8545x4A100-SXM-80GB.sh
+++ dirname ./config_2xXE8545x4A100-SXM-80GB.sh
++ source ./config_XE8545x4A100-SXM-80GB_common.sh
+++ export 'OMPI_MCA_btl=^openib'
+++ OMPI_MCA_btl='^openib'
+++ export DALI_DONT_USE_MMAP=0
+++ DALI_DONT_USE_MMAP=0
+++ export MXNET_EXTENDED_NORMCONV_SUPPORT=1
+++ MXNET_EXTENDED_NORMCONV_SUPPORT=1
+++ export DGXNGPU=4
+++ DGXNGPU=4
+++ export DGXNSOCKET=2
+++ DGXNSOCKET=2
+++ export DGXSOCKETCORES=64
+++ DGXSOCKETCORES=64
+++ export DGXHT=1
+++ DGXHT=1
+++ export HOROVOD_NUM_NCCL_STREAMS=1
+++ HOROVOD_NUM_NCCL_STREAMS=1
+++ export MXNET_HOROVOD_NUM_GROUPS=1
+++ MXNET_HOROVOD_NUM_GROUPS=1
+++ export HOROVOD_CYCLE_TIME=0.1
+++ HOROVOD_CYCLE_TIME=0.1
+++ export MXNET_OPTIMIZER_AGGREGATION_SIZE=54
+++ MXNET_OPTIMIZER_AGGREGATION_SIZE=54
+++ export MXNET_ENABLE_CUDA_GRAPHS=1
+++ MXNET_ENABLE_CUDA_GRAPHS=1
+++ export MXNET_CUDNN_WARN_ON_IGNORED_FLAGS=0
+++ MXNET_CUDNN_WARN_ON_IGNORED_FLAGS=0
+++ export MXNET_CUDNN_NHWC_BN_HEURISTIC_FWD=1
+++ MXNET_CUDNN_NHWC_BN_HEURISTIC_FWD=1
+++ export MXNET_CUDNN_NHWC_BN_HEURISTIC_BWD=1
+++ MXNET_CUDNN_NHWC_BN_HEURISTIC_BWD=1
+++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=1
+++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=1
+++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=1
+++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=1
+++ export RUN_NCCL_BW_TEST=0
+++ RUN_NCCL_BW_TEST=0
++ export MXNET_DETERMINISTIC=1
++ MXNET_DETERMINISTIC=1
++ export OPTIMIZER=sgdwfastlars
++ OPTIMIZER=sgdwfastlars
++ export BATCHSIZE=408
++ BATCHSIZE=408
++ export KVSTORE=horovod
++ KVSTORE=horovod
++ export LR=10.5
++ LR=10.5
++ export WARMUP_EPOCHS=2
++ WARMUP_EPOCHS=2
++ export EVAL_OFFSET=2
++ EVAL_OFFSET=2
++ export EVAL_PERIOD=4
++ EVAL_PERIOD=4
++ export WD=5.0e-05
++ WD=5.0e-05
++ export MOM=0.9
++ MOM=0.9
++ export LARSETA=0.001
++ LARSETA=0.001
++ export LABELSMOOTHING=0.1
++ LABELSMOOTHING=0.1
++ export LRSCHED=pow2
++ LRSCHED=pow2
++ export NUMEPOCHS=37
++ NUMEPOCHS=37
++ export NETWORK=resnet-v1b-stats-fl
++ NETWORK=resnet-v1b-stats-fl
++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=0
++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=0
++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=0
++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=0
++ export DALI_THREADS=6
++ DALI_THREADS=6
++ export DALI_PREFETCH_QUEUE=5
++ DALI_PREFETCH_QUEUE=5
++ export DALI_NVJPEG_MEMPADDING=256
++ DALI_NVJPEG_MEMPADDING=256
++ export DALI_HW_DECODER_LOAD=0
++ DALI_HW_DECODER_LOAD=0
++ export DALI_CACHE_SIZE=0
++ DALI_CACHE_SIZE=0
++ export DALI_ROI_DECODE=1
++ DALI_ROI_DECODE=1
++ export DALI_PREALLOCATE_WIDTH=5980
++ DALI_PREALLOCATE_WIDTH=5980
++ export DALI_PREALLOCATE_HEIGHT=6430
++ DALI_PREALLOCATE_HEIGHT=6430
++ export DALI_DECODER_BUFFER_HINT=1315942
++ DALI_DECODER_BUFFER_HINT=1315942
++ export DALI_CROP_BUFFER_HINT=165581
++ DALI_CROP_BUFFER_HINT=165581
++ export DALI_TMP_BUFFER_HINT=355568328
++ DALI_TMP_BUFFER_HINT=355568328
++ export DALI_NORMALIZE_BUFFER_HINT=441549
++ DALI_NORMALIZE_BUFFER_HINT=441549
++ export HOROVOD_CYCLE_TIME=0.1
++ HOROVOD_CYCLE_TIME=0.1
++ export HOROVOD_FUSION_THRESHOLD=67108864
++ HOROVOD_FUSION_THRESHOLD=67108864
++ export HOROVOD_NUM_NCCL_STREAMS=2
++ HOROVOD_NUM_NCCL_STREAMS=2
++ export MXNET_HOROVOD_NUM_GROUPS=1
++ MXNET_HOROVOD_NUM_GROUPS=1
++ export MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_FWD=999
++ MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_FWD=999
++ export MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_BWD=999
++ MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_BWD=999
++ export DGXNNODES=2
++ DGXNNODES=2
+++ sed 's/^config_//'
+++ sed 's/\.sh$//'
++++ readlink -f ./config_2xXE8545x4A100-SXM-80GB.sh
+++ basename /workspace/image_classification/config_2xXE8545x4A100-SXM-80GB.sh
++ export DGXSYSTEM=2xXE8545x4A100-SXM-80GB
++ DGXSYSTEM=2xXE8545x4A100-SXM-80GB
++ export WALLTIME=00:40:00
++ WALLTIME=00:40:00
++ export NCCL_MAX_RINGS=4
++ NCCL_MAX_RINGS=4
++ export OMPI_MCA_btl_openib_if_include=mlx5_0:1
++ OMPI_MCA_btl_openib_if_include=mlx5_0:1
++ export UCX_NET_DEVICES=mlx5_0:1
++ UCX_NET_DEVICES=mlx5_0:1
++ date +%s
+ start=1652470595
++ date '+%Y-%m-%d %r'
+ start_fmt='2022-05-13 02:36:35 PM'
+ echo 'STARTING TIMING RUN AT 2022-05-13 02:36:35 PM'
STARTING TIMING RUN AT 2022-05-13 02:36:35 PM
+ readonly global_rank=0
+ global_rank=0
+ readonly local_rank=0
+ local_rank=0
+ SLURM_NTASKS_PER_NODE=1
+ OPTIMIZER=sgdwfastlars
+ BATCHSIZE=408
+ INPUT_BATCH_MULTIPLIER=1
+ KVSTORE=horovod
+ LR=10.5
+ MOM=0.9
+ LRSCHED=pow2
+ WARMUP_EPOCHS=2
+ LARSETA=0.001
+ DALI_HW_DECODER_LOAD=0
+ WD=5.0e-05
+ LABELSMOOTHING=0.1
+ SEED=12451
+ EVAL_OFFSET=2
+ EVAL_PERIOD=4
+ DALI_PREFETCH_QUEUE=5
+ DALI_NVJPEG_MEMPADDING=256
+ DALI_THREADS=6
+ DALI_CACHE_SIZE=0
+ DALI_ROI_DECODE=1
+ DALI_PREALLOCATE_WIDTH=5980
+ DALI_PREALLOCATE_HEIGHT=6430
+ DALI_TMP_BUFFER_HINT=355568328
+ DALI_DECODER_BUFFER_HINT=1315942
+ DALI_CROP_BUFFER_HINT=165581
+ DALI_NORMALIZE_BUFFER_HINT=441549
+ DALI_DONT_USE_MMAP=0
+ NUMEPOCHS=37
+ NETWORK=resnet-v1b-stats-fl
+ BN_GROUP=1
+ PROFILE=0
+ PROFILE_EXCEL=0
+ NODALI=0
+ NUMEXAMPLES=
+ PROFILE_ALL_LOCAL_RANKS=0
+ THR=0.759
+ [[ 0 == 1 ]]
+ DATAROOT=/data
running benchmark
+ echo 'running benchmark'
+ export NGPUS=1
+ NGPUS=1
+ export NCCL_DEBUG=WARN
+ NCCL_DEBUG=WARN
+ [[ 0 -ge 1 ]]
++ seq 0 3
++ tr '\n' ,
++ sed 's/,$//'
+ GPUS=0,1,2,3
+ PARAMS=(--gpus "${GPUS}" --batch-size "${BATCHSIZE}" --kv-store "${KVSTORE}" --lr "${LR}" --mom "${MOM}" --lr-step-epochs "${LRSCHED}" --lars-eta "${LARSETA}" --label-smoothing "${LABELSMOOTHING}" --wd "${WD}" --warmup-epochs "${WARMUP_EPOCHS}" --eval-period "${EVAL_PERIOD}" --eval-offset "${EVAL_OFFSET}" --optimizer "${OPTIMIZER}" --network "${NETWORK}" --num-layers "50" --num-epochs "${NUMEPOCHS}" --accuracy-threshold "${THR}" --seed "${SEED}" --dtype "float16" --disp-batches "20" --image-shape "4,224,224" --fuse-bn-relu "1" --fuse-bn-add-relu "1" --bn-group "${BN_GROUP}" --min-random-area "0.05" --max-random-area "1.0" --conv-algo "1" --force-tensor-core "1" --input-layout "NHWC" --conv-layout "NHWC" --batchnorm-layout "NHWC" --pooling-layout "NHWC" --batchnorm-mom "0.9" --batchnorm-eps "1e-5" --data-train "${DATAROOT}/train.rec" --data-train-idx "${DATAROOT}/train.idx" --data-val "${DATAROOT}/val.rec" --data-val-idx "${DATAROOT}/val.idx" --dali-dont-use-mmap "${DALI_DONT_USE_MMAP}" --dali-hw-decoder-load "${DALI_HW_DECODER_LOAD}" --dali-prefetch-queue "${DALI_PREFETCH_QUEUE}" --dali-nvjpeg-memory-padding "${DALI_NVJPEG_MEMPADDING}" --input-batch-multiplier "${INPUT_BATCH_MULTIPLIER}" --dali-threads "${DALI_THREADS}" --dali-cache-size "${DALI_CACHE_SIZE}" --dali-roi-decode "${DALI_ROI_DECODE}" --dali-preallocate-width "${DALI_PREALLOCATE_WIDTH}" --dali-preallocate-height "${DALI_PREALLOCATE_HEIGHT}" --dali-tmp-buffer-hint "${DALI_TMP_BUFFER_HINT}" --dali-decoder-buffer-hint "${DALI_DECODER_BUFFER_HINT}" --dali-crop-buffer-hint "${DALI_CROP_BUFFER_HINT}" --dali-normalize-buffer-hint "${DALI_NORMALIZE_BUFFER_HINT}" --profile "${PROFILE}")
+ [[ 0 -lt 1 ]]
+ PARAMS+=(--use-dali)
+ [[ '' -ge 1 ]]
+ echo PARAMS=--gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
PARAMS=--gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
+ python train_imagenet.py --gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
+ source ./config_2xXE8545x4A100-SXM-80GB.sh
+++ dirname ./config_2xXE8545x4A100-SXM-80GB.sh
++ source ./config_XE8545x4A100-SXM-80GB_common.sh
+++ export 'OMPI_MCA_btl=^openib'
+++ OMPI_MCA_btl='^openib'
+++ export DALI_DONT_USE_MMAP=0
+++ DALI_DONT_USE_MMAP=0
+++ export MXNET_EXTENDED_NORMCONV_SUPPORT=1
+++ MXNET_EXTENDED_NORMCONV_SUPPORT=1
+++ export DGXNGPU=4
+++ DGXNGPU=4
+++ export DGXNSOCKET=2
+++ DGXNSOCKET=2
+++ export DGXSOCKETCORES=64
+++ DGXSOCKETCORES=64
+++ export DGXHT=1
+++ DGXHT=1
+++ export HOROVOD_NUM_NCCL_STREAMS=1
+++ HOROVOD_NUM_NCCL_STREAMS=1
+++ export MXNET_HOROVOD_NUM_GROUPS=1
+++ MXNET_HOROVOD_NUM_GROUPS=1
+++ export HOROVOD_CYCLE_TIME=0.1
+++ HOROVOD_CYCLE_TIME=0.1
+++ export MXNET_OPTIMIZER_AGGREGATION_SIZE=54
+++ MXNET_OPTIMIZER_AGGREGATION_SIZE=54
+++ export MXNET_ENABLE_CUDA_GRAPHS=1
+++ MXNET_ENABLE_CUDA_GRAPHS=1
+++ export MXNET_CUDNN_WARN_ON_IGNORED_FLAGS=0
+++ MXNET_CUDNN_WARN_ON_IGNORED_FLAGS=0
+++ export MXNET_CUDNN_NHWC_BN_HEURISTIC_FWD=1
+++ MXNET_CUDNN_NHWC_BN_HEURISTIC_FWD=1
+++ export MXNET_CUDNN_NHWC_BN_HEURISTIC_BWD=1
+++ MXNET_CUDNN_NHWC_BN_HEURISTIC_BWD=1
+++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=1
+++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=1
+++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=1
+++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=1
+++ export RUN_NCCL_BW_TEST=0
+++ RUN_NCCL_BW_TEST=0
++ export MXNET_DETERMINISTIC=1
++ MXNET_DETERMINISTIC=1
++ export OPTIMIZER=sgdwfastlars
++ OPTIMIZER=sgdwfastlars
++ export BATCHSIZE=408
++ BATCHSIZE=408
++ export KVSTORE=horovod
++ KVSTORE=horovod
++ export LR=10.5
++ LR=10.5
++ export WARMUP_EPOCHS=2
++ WARMUP_EPOCHS=2
++ export EVAL_OFFSET=2
++ EVAL_OFFSET=2
++ export EVAL_PERIOD=4
++ EVAL_PERIOD=4
++ export WD=5.0e-05
++ WD=5.0e-05
++ export MOM=0.9
++ MOM=0.9
++ export LARSETA=0.001
++ LARSETA=0.001
++ export LABELSMOOTHING=0.1
++ LABELSMOOTHING=0.1
++ export LRSCHED=pow2
++ LRSCHED=pow2
++ export NUMEPOCHS=37
++ NUMEPOCHS=37
++ export NETWORK=resnet-v1b-stats-fl
++ NETWORK=resnet-v1b-stats-fl
++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=0
++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=0
++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=0
++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=0
++ export DALI_THREADS=6
++ DALI_THREADS=6
++ export DALI_PREFETCH_QUEUE=5
++ DALI_PREFETCH_QUEUE=5
++ export DALI_NVJPEG_MEMPADDING=256
++ DALI_NVJPEG_MEMPADDING=256
++ export DALI_HW_DECODER_LOAD=0
++ DALI_HW_DECODER_LOAD=0
++ export DALI_CACHE_SIZE=0
++ DALI_CACHE_SIZE=0
++ export DALI_ROI_DECODE=1
++ DALI_ROI_DECODE=1
++ export DALI_PREALLOCATE_WIDTH=5980
++ DALI_PREALLOCATE_WIDTH=5980
++ export DALI_PREALLOCATE_HEIGHT=6430
++ DALI_PREALLOCATE_HEIGHT=6430
++ export DALI_DECODER_BUFFER_HINT=1315942
++ DALI_DECODER_BUFFER_HINT=1315942
++ export DALI_CROP_BUFFER_HINT=165581
++ DALI_CROP_BUFFER_HINT=165581
++ export DALI_TMP_BUFFER_HINT=355568328
++ DALI_TMP_BUFFER_HINT=355568328
++ export DALI_NORMALIZE_BUFFER_HINT=441549
++ DALI_NORMALIZE_BUFFER_HINT=441549
++ export HOROVOD_CYCLE_TIME=0.1
++ HOROVOD_CYCLE_TIME=0.1
++ export HOROVOD_FUSION_THRESHOLD=67108864
++ HOROVOD_FUSION_THRESHOLD=67108864
++ export HOROVOD_NUM_NCCL_STREAMS=2
++ HOROVOD_NUM_NCCL_STREAMS=2
++ export MXNET_HOROVOD_NUM_GROUPS=1
++ MXNET_HOROVOD_NUM_GROUPS=1
++ export MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_FWD=999
++ MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_FWD=999
++ export MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_BWD=999
++ MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_BWD=999
++ export DGXNNODES=2
++ DGXNNODES=2
+++ sed 's/^config_//'
+++ sed 's/\.sh$//'
++++ readlink -f ./config_2xXE8545x4A100-SXM-80GB.sh
+++ basename /workspace/image_classification/config_2xXE8545x4A100-SXM-80GB.sh
++ export DGXSYSTEM=2xXE8545x4A100-SXM-80GB
++ DGXSYSTEM=2xXE8545x4A100-SXM-80GB
++ export WALLTIME=00:40:00
++ WALLTIME=00:40:00
++ export NCCL_MAX_RINGS=4
++ NCCL_MAX_RINGS=4
++ export OMPI_MCA_btl_openib_if_include=mlx5_0:1
++ OMPI_MCA_btl_openib_if_include=mlx5_0:1
++ export UCX_NET_DEVICES=mlx5_0:1
++ UCX_NET_DEVICES=mlx5_0:1
++ date +%s
+ start=1652470595
++ date '+%Y-%m-%d %r'
+ start_fmt='2022-05-13 02:36:35 PM'
STARTING TIMING RUN AT 2022-05-13 02:36:35 PM
+ echo 'STARTING TIMING RUN AT 2022-05-13 02:36:35 PM'
+ readonly global_rank=0
+ global_rank=0
+ readonly local_rank=0
+ local_rank=0
+ SLURM_NTASKS_PER_NODE=1
+ OPTIMIZER=sgdwfastlars
+ BATCHSIZE=408
+ INPUT_BATCH_MULTIPLIER=1
+ KVSTORE=horovod
+ LR=10.5
+ MOM=0.9
+ LRSCHED=pow2
+ WARMUP_EPOCHS=2
+ LARSETA=0.001
+ DALI_HW_DECODER_LOAD=0
+ WD=5.0e-05
+ LABELSMOOTHING=0.1
+ SEED=12451
+ EVAL_OFFSET=2
+ EVAL_PERIOD=4
+ DALI_PREFETCH_QUEUE=5
+ DALI_NVJPEG_MEMPADDING=256
+ DALI_THREADS=6
+ DALI_CACHE_SIZE=0
+ DALI_ROI_DECODE=1
+ DALI_PREALLOCATE_WIDTH=5980
+ DALI_PREALLOCATE_HEIGHT=6430
+ DALI_TMP_BUFFER_HINT=355568328
+ DALI_DECODER_BUFFER_HINT=1315942
+ DALI_CROP_BUFFER_HINT=165581
+ DALI_NORMALIZE_BUFFER_HINT=441549
+ DALI_DONT_USE_MMAP=0
+ NUMEPOCHS=37
+ NETWORK=resnet-v1b-stats-fl
+ BN_GROUP=1
+ PROFILE=0
+ PROFILE_EXCEL=0
+ NODALI=0
+ NUMEXAMPLES=
+ PROFILE_ALL_LOCAL_RANKS=0
+ THR=0.759
+ [[ 0 == 1 ]]
+ DATAROOT=/data
running benchmark
+ echo 'running benchmark'
+ export NGPUS=1
+ NGPUS=1
+ export NCCL_DEBUG=WARN
+ NCCL_DEBUG=WARN
+ [[ 0 -ge 1 ]]
++ seq 0 3
++ tr '\n' ,
++ sed 's/,$//'
+ GPUS=0,1,2,3
+ PARAMS=(--gpus "${GPUS}" --batch-size "${BATCHSIZE}" --kv-store "${KVSTORE}" --lr "${LR}" --mom "${MOM}" --lr-step-epochs "${LRSCHED}" --lars-eta "${LARSETA}" --label-smoothing "${LABELSMOOTHING}" --wd "${WD}" --warmup-epochs "${WARMUP_EPOCHS}" --eval-period "${EVAL_PERIOD}" --eval-offset "${EVAL_OFFSET}" --optimizer "${OPTIMIZER}" --network "${NETWORK}" --num-layers "50" --num-epochs "${NUMEPOCHS}" --accuracy-threshold "${THR}" --seed "${SEED}" --dtype "float16" --disp-batches "20" --image-shape "4,224,224" --fuse-bn-relu "1" --fuse-bn-add-relu "1" --bn-group "${BN_GROUP}" --min-random-area "0.05" --max-random-area "1.0" --conv-algo "1" --force-tensor-core "1" --input-layout "NHWC" --conv-layout "NHWC" --batchnorm-layout "NHWC" --pooling-layout "NHWC" --batchnorm-mom "0.9" --batchnorm-eps "1e-5" --data-train "${DATAROOT}/train.rec" --data-train-idx "${DATAROOT}/train.idx" --data-val "${DATAROOT}/val.rec" --data-val-idx "${DATAROOT}/val.idx" --dali-dont-use-mmap "${DALI_DONT_USE_MMAP}" --dali-hw-decoder-load "${DALI_HW_DECODER_LOAD}" --dali-prefetch-queue "${DALI_PREFETCH_QUEUE}" --dali-nvjpeg-memory-padding "${DALI_NVJPEG_MEMPADDING}" --input-batch-multiplier "${INPUT_BATCH_MULTIPLIER}" --dali-threads "${DALI_THREADS}" --dali-cache-size "${DALI_CACHE_SIZE}" --dali-roi-decode "${DALI_ROI_DECODE}" --dali-preallocate-width "${DALI_PREALLOCATE_WIDTH}" --dali-preallocate-height "${DALI_PREALLOCATE_HEIGHT}" --dali-tmp-buffer-hint "${DALI_TMP_BUFFER_HINT}" --dali-decoder-buffer-hint "${DALI_DECODER_BUFFER_HINT}" --dali-crop-buffer-hint "${DALI_CROP_BUFFER_HINT}" --dali-normalize-buffer-hint "${DALI_NORMALIZE_BUFFER_HINT}" --profile "${PROFILE}")
+ [[ 0 -lt 1 ]]
+ PARAMS+=(--use-dali)
+ [[ '' -ge 1 ]]
+ echo PARAMS=--gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
PARAMS=--gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
+ python train_imagenet.py --gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
+ source ./config_2xXE8545x4A100-SXM-80GB.sh
+++ dirname ./config_2xXE8545x4A100-SXM-80GB.sh
++ source ./config_XE8545x4A100-SXM-80GB_common.sh
+++ export 'OMPI_MCA_btl=^openib'
+++ OMPI_MCA_btl='^openib'
+++ export DALI_DONT_USE_MMAP=0
+++ DALI_DONT_USE_MMAP=0
+++ export MXNET_EXTENDED_NORMCONV_SUPPORT=1
+++ MXNET_EXTENDED_NORMCONV_SUPPORT=1
+++ export DGXNGPU=4
+++ DGXNGPU=4
+++ export DGXNSOCKET=2
+++ DGXNSOCKET=2
+++ export DGXSOCKETCORES=64
+++ DGXSOCKETCORES=64
+++ export DGXHT=1
+++ DGXHT=1
+++ export HOROVOD_NUM_NCCL_STREAMS=1
+++ HOROVOD_NUM_NCCL_STREAMS=1
+++ export MXNET_HOROVOD_NUM_GROUPS=1
+++ MXNET_HOROVOD_NUM_GROUPS=1
+++ export HOROVOD_CYCLE_TIME=0.1
+++ HOROVOD_CYCLE_TIME=0.1
+++ export MXNET_OPTIMIZER_AGGREGATION_SIZE=54
+++ MXNET_OPTIMIZER_AGGREGATION_SIZE=54
+++ export MXNET_ENABLE_CUDA_GRAPHS=1
+++ MXNET_ENABLE_CUDA_GRAPHS=1
+++ export MXNET_CUDNN_WARN_ON_IGNORED_FLAGS=0
+++ MXNET_CUDNN_WARN_ON_IGNORED_FLAGS=0
+++ export MXNET_CUDNN_NHWC_BN_HEURISTIC_FWD=1
+++ MXNET_CUDNN_NHWC_BN_HEURISTIC_FWD=1
+++ export MXNET_CUDNN_NHWC_BN_HEURISTIC_BWD=1
+++ MXNET_CUDNN_NHWC_BN_HEURISTIC_BWD=1
+++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=1
+++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=1
+++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=1
+++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=1
+++ export RUN_NCCL_BW_TEST=0
+++ RUN_NCCL_BW_TEST=0
++ export MXNET_DETERMINISTIC=1
++ MXNET_DETERMINISTIC=1
++ export OPTIMIZER=sgdwfastlars
++ OPTIMIZER=sgdwfastlars
++ export BATCHSIZE=408
++ BATCHSIZE=408
++ export KVSTORE=horovod
++ KVSTORE=horovod
++ export LR=10.5
++ LR=10.5
++ export WARMUP_EPOCHS=2
++ WARMUP_EPOCHS=2
++ export EVAL_OFFSET=2
++ EVAL_OFFSET=2
++ export EVAL_PERIOD=4
++ EVAL_PERIOD=4
++ export WD=5.0e-05
++ WD=5.0e-05
++ export MOM=0.9
++ MOM=0.9
++ export LARSETA=0.001
++ LARSETA=0.001
++ export LABELSMOOTHING=0.1
++ LABELSMOOTHING=0.1
++ export LRSCHED=pow2
++ LRSCHED=pow2
++ export NUMEPOCHS=37
++ NUMEPOCHS=37
++ export NETWORK=resnet-v1b-stats-fl
++ NETWORK=resnet-v1b-stats-fl
++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=0
++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=0
++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=0
++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=0
++ export DALI_THREADS=6
++ DALI_THREADS=6
++ export DALI_PREFETCH_QUEUE=5
++ DALI_PREFETCH_QUEUE=5
++ export DALI_NVJPEG_MEMPADDING=256
++ DALI_NVJPEG_MEMPADDING=256
++ export DALI_HW_DECODER_LOAD=0
++ DALI_HW_DECODER_LOAD=0
++ export DALI_CACHE_SIZE=0
++ DALI_CACHE_SIZE=0
++ export DALI_ROI_DECODE=1
++ DALI_ROI_DECODE=1
++ export DALI_PREALLOCATE_WIDTH=5980
++ DALI_PREALLOCATE_WIDTH=5980
++ export DALI_PREALLOCATE_HEIGHT=6430
++ DALI_PREALLOCATE_HEIGHT=6430
++ export DALI_DECODER_BUFFER_HINT=1315942
++ DALI_DECODER_BUFFER_HINT=1315942
++ export DALI_CROP_BUFFER_HINT=165581
++ DALI_CROP_BUFFER_HINT=165581
++ export DALI_TMP_BUFFER_HINT=355568328
++ DALI_TMP_BUFFER_HINT=355568328
++ export DALI_NORMALIZE_BUFFER_HINT=441549
++ DALI_NORMALIZE_BUFFER_HINT=441549
++ export HOROVOD_CYCLE_TIME=0.1
++ HOROVOD_CYCLE_TIME=0.1
++ export HOROVOD_FUSION_THRESHOLD=67108864
++ HOROVOD_FUSION_THRESHOLD=67108864
++ export HOROVOD_NUM_NCCL_STREAMS=2
++ HOROVOD_NUM_NCCL_STREAMS=2
++ export MXNET_HOROVOD_NUM_GROUPS=1
++ MXNET_HOROVOD_NUM_GROUPS=1
++ export MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_FWD=999
++ MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_FWD=999
++ export MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_BWD=999
++ MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_BWD=999
++ export DGXNNODES=2
++ DGXNNODES=2
+++ sed 's/^config_//'
+++ sed 's/\.sh$//'
++++ readlink -f ./config_2xXE8545x4A100-SXM-80GB.sh
+++ basename /workspace/image_classification/config_2xXE8545x4A100-SXM-80GB.sh
++ export DGXSYSTEM=2xXE8545x4A100-SXM-80GB
++ DGXSYSTEM=2xXE8545x4A100-SXM-80GB
++ export WALLTIME=00:40:00
++ WALLTIME=00:40:00
++ export NCCL_MAX_RINGS=4
++ NCCL_MAX_RINGS=4
++ export OMPI_MCA_btl_openib_if_include=mlx5_0:1
++ OMPI_MCA_btl_openib_if_include=mlx5_0:1
++ export UCX_NET_DEVICES=mlx5_0:1
++ UCX_NET_DEVICES=mlx5_0:1
++ date +%s
+ start=1652470596
++ date '+%Y-%m-%d %r'
+ start_fmt='2022-05-13 02:36:36 PM'
STARTING TIMING RUN AT 2022-05-13 02:36:36 PM
+ echo 'STARTING TIMING RUN AT 2022-05-13 02:36:36 PM'
+ readonly global_rank=0
+ global_rank=0
+ readonly local_rank=0
+ local_rank=0
+ SLURM_NTASKS_PER_NODE=1
+ OPTIMIZER=sgdwfastlars
+ BATCHSIZE=408
+ INPUT_BATCH_MULTIPLIER=1
+ KVSTORE=horovod
+ LR=10.5
+ MOM=0.9
+ LRSCHED=pow2
+ WARMUP_EPOCHS=2
+ LARSETA=0.001
+ DALI_HW_DECODER_LOAD=0
+ WD=5.0e-05
+ LABELSMOOTHING=0.1
+ SEED=12451
+ EVAL_OFFSET=2
+ EVAL_PERIOD=4
+ DALI_PREFETCH_QUEUE=5
+ DALI_NVJPEG_MEMPADDING=256
+ DALI_THREADS=6
+ DALI_CACHE_SIZE=0
+ DALI_ROI_DECODE=1
+ DALI_PREALLOCATE_WIDTH=5980
+ DALI_PREALLOCATE_HEIGHT=6430
+ DALI_TMP_BUFFER_HINT=355568328
+ DALI_DECODER_BUFFER_HINT=1315942
+ DALI_CROP_BUFFER_HINT=165581
+ DALI_NORMALIZE_BUFFER_HINT=441549
+ DALI_DONT_USE_MMAP=0
+ NUMEPOCHS=37
+ NETWORK=resnet-v1b-stats-fl
+ BN_GROUP=1
+ PROFILE=0
+ PROFILE_EXCEL=0
+ NODALI=0
+ NUMEXAMPLES=
+ PROFILE_ALL_LOCAL_RANKS=0
+ THR=0.759
+ [[ 0 == 1 ]]
+ DATAROOT=/data
+ echo 'running benchmark'
running benchmark
+ export NGPUS=1
+ NGPUS=1
+ export NCCL_DEBUG=WARN
+ NCCL_DEBUG=WARN
+ [[ 0 -ge 1 ]]
++ seq 0 3
++ tr '\n' ,
++ sed 's/,$//'
+ GPUS=0,1,2,3
+ PARAMS=(--gpus "${GPUS}" --batch-size "${BATCHSIZE}" --kv-store "${KVSTORE}" --lr "${LR}" --mom "${MOM}" --lr-step-epochs "${LRSCHED}" --lars-eta "${LARSETA}" --label-smoothing "${LABELSMOOTHING}" --wd "${WD}" --warmup-epochs "${WARMUP_EPOCHS}" --eval-period "${EVAL_PERIOD}" --eval-offset "${EVAL_OFFSET}" --optimizer "${OPTIMIZER}" --network "${NETWORK}" --num-layers "50" --num-epochs "${NUMEPOCHS}" --accuracy-threshold "${THR}" --seed "${SEED}" --dtype "float16" --disp-batches "20" --image-shape "4,224,224" --fuse-bn-relu "1" --fuse-bn-add-relu "1" --bn-group "${BN_GROUP}" --min-random-area "0.05" --max-random-area "1.0" --conv-algo "1" --force-tensor-core "1" --input-layout "NHWC" --conv-layout "NHWC" --batchnorm-layout "NHWC" --pooling-layout "NHWC" --batchnorm-mom "0.9" --batchnorm-eps "1e-5" --data-train "${DATAROOT}/train.rec" --data-train-idx "${DATAROOT}/train.idx" --data-val "${DATAROOT}/val.rec" --data-val-idx "${DATAROOT}/val.idx" --dali-dont-use-mmap "${DALI_DONT_USE_MMAP}" --dali-hw-decoder-load "${DALI_HW_DECODER_LOAD}" --dali-prefetch-queue "${DALI_PREFETCH_QUEUE}" --dali-nvjpeg-memory-padding "${DALI_NVJPEG_MEMPADDING}" --input-batch-multiplier "${INPUT_BATCH_MULTIPLIER}" --dali-threads "${DALI_THREADS}" --dali-cache-size "${DALI_CACHE_SIZE}" --dali-roi-decode "${DALI_ROI_DECODE}" --dali-preallocate-width "${DALI_PREALLOCATE_WIDTH}" --dali-preallocate-height "${DALI_PREALLOCATE_HEIGHT}" --dali-tmp-buffer-hint "${DALI_TMP_BUFFER_HINT}" --dali-decoder-buffer-hint "${DALI_DECODER_BUFFER_HINT}" --dali-crop-buffer-hint "${DALI_CROP_BUFFER_HINT}" --dali-normalize-buffer-hint "${DALI_NORMALIZE_BUFFER_HINT}" --profile "${PROFILE}")
+ [[ 0 -lt 1 ]]
+ PARAMS+=(--use-dali)
+ [[ '' -ge 1 ]]
+ echo PARAMS=--gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
PARAMS=--gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
+ python train_imagenet.py --gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
+ source ./config_2xXE8545x4A100-SXM-80GB.sh
+++ dirname ./config_2xXE8545x4A100-SXM-80GB.sh
++ source ./config_XE8545x4A100-SXM-80GB_common.sh
+++ export 'OMPI_MCA_btl=^openib'
+++ OMPI_MCA_btl='^openib'
+++ export DALI_DONT_USE_MMAP=0
+++ DALI_DONT_USE_MMAP=0
+++ export MXNET_EXTENDED_NORMCONV_SUPPORT=1
+++ MXNET_EXTENDED_NORMCONV_SUPPORT=1
+++ export DGXNGPU=4
+++ DGXNGPU=4
+++ export DGXNSOCKET=2
+++ DGXNSOCKET=2
+++ export DGXSOCKETCORES=64
+++ DGXSOCKETCORES=64
+++ export DGXHT=1
+++ DGXHT=1
+++ export HOROVOD_NUM_NCCL_STREAMS=1
+++ HOROVOD_NUM_NCCL_STREAMS=1
+++ export MXNET_HOROVOD_NUM_GROUPS=1
+++ MXNET_HOROVOD_NUM_GROUPS=1
+++ export HOROVOD_CYCLE_TIME=0.1
+++ HOROVOD_CYCLE_TIME=0.1
+++ export MXNET_OPTIMIZER_AGGREGATION_SIZE=54
+++ MXNET_OPTIMIZER_AGGREGATION_SIZE=54
+++ export MXNET_ENABLE_CUDA_GRAPHS=1
+++ MXNET_ENABLE_CUDA_GRAPHS=1
+++ export MXNET_CUDNN_WARN_ON_IGNORED_FLAGS=0
+++ MXNET_CUDNN_WARN_ON_IGNORED_FLAGS=0
+++ export MXNET_CUDNN_NHWC_BN_HEURISTIC_FWD=1
+++ MXNET_CUDNN_NHWC_BN_HEURISTIC_FWD=1
+++ export MXNET_CUDNN_NHWC_BN_HEURISTIC_BWD=1
+++ MXNET_CUDNN_NHWC_BN_HEURISTIC_BWD=1
+++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=1
+++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=1
+++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=1
+++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=1
+++ export RUN_NCCL_BW_TEST=0
+++ RUN_NCCL_BW_TEST=0
++ export MXNET_DETERMINISTIC=1
++ MXNET_DETERMINISTIC=1
++ export OPTIMIZER=sgdwfastlars
++ OPTIMIZER=sgdwfastlars
++ export BATCHSIZE=408
++ BATCHSIZE=408
++ export KVSTORE=horovod
++ KVSTORE=horovod
++ export LR=10.5
++ LR=10.5
++ export WARMUP_EPOCHS=2
++ WARMUP_EPOCHS=2
++ export EVAL_OFFSET=2
++ EVAL_OFFSET=2
++ export EVAL_PERIOD=4
++ EVAL_PERIOD=4
++ export WD=5.0e-05
++ WD=5.0e-05
++ export MOM=0.9
++ MOM=0.9
++ export LARSETA=0.001
++ LARSETA=0.001
++ export LABELSMOOTHING=0.1
++ LABELSMOOTHING=0.1
++ export LRSCHED=pow2
++ LRSCHED=pow2
++ export NUMEPOCHS=37
++ NUMEPOCHS=37
++ export NETWORK=resnet-v1b-stats-fl
++ NETWORK=resnet-v1b-stats-fl
++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=0
++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=0
++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=0
++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=0
++ export DALI_THREADS=6
++ DALI_THREADS=6
++ export DALI_PREFETCH_QUEUE=5
++ DALI_PREFETCH_QUEUE=5
++ export DALI_NVJPEG_MEMPADDING=256
++ DALI_NVJPEG_MEMPADDING=256
++ export DALI_HW_DECODER_LOAD=0
++ DALI_HW_DECODER_LOAD=0
++ export DALI_CACHE_SIZE=0
++ DALI_CACHE_SIZE=0
++ export DALI_ROI_DECODE=1
++ DALI_ROI_DECODE=1
++ export DALI_PREALLOCATE_WIDTH=5980
++ DALI_PREALLOCATE_WIDTH=5980
++ export DALI_PREALLOCATE_HEIGHT=6430
++ DALI_PREALLOCATE_HEIGHT=6430
++ export DALI_DECODER_BUFFER_HINT=1315942
++ DALI_DECODER_BUFFER_HINT=1315942
++ export DALI_CROP_BUFFER_HINT=165581
++ DALI_CROP_BUFFER_HINT=165581
++ export DALI_TMP_BUFFER_HINT=355568328
++ DALI_TMP_BUFFER_HINT=355568328
++ export DALI_NORMALIZE_BUFFER_HINT=441549
++ DALI_NORMALIZE_BUFFER_HINT=441549
++ export HOROVOD_CYCLE_TIME=0.1
++ HOROVOD_CYCLE_TIME=0.1
++ export HOROVOD_FUSION_THRESHOLD=67108864
++ HOROVOD_FUSION_THRESHOLD=67108864
++ export HOROVOD_NUM_NCCL_STREAMS=2
++ HOROVOD_NUM_NCCL_STREAMS=2
++ export MXNET_HOROVOD_NUM_GROUPS=1
++ MXNET_HOROVOD_NUM_GROUPS=1
++ export MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_FWD=999
++ MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_FWD=999
++ export MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_BWD=999
++ MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_BWD=999
++ export DGXNNODES=2
++ DGXNNODES=2
+++ sed 's/^config_//'
+++ sed 's/\.sh$//'
++++ readlink -f ./config_2xXE8545x4A100-SXM-80GB.sh
+++ basename /workspace/image_classification/config_2xXE8545x4A100-SXM-80GB.sh
++ export DGXSYSTEM=2xXE8545x4A100-SXM-80GB
++ DGXSYSTEM=2xXE8545x4A100-SXM-80GB
++ export WALLTIME=00:40:00
++ WALLTIME=00:40:00
++ export NCCL_MAX_RINGS=4
++ NCCL_MAX_RINGS=4
++ export OMPI_MCA_btl_openib_if_include=mlx5_0:1
++ OMPI_MCA_btl_openib_if_include=mlx5_0:1
++ export UCX_NET_DEVICES=mlx5_0:1
++ UCX_NET_DEVICES=mlx5_0:1
++ date +%s
+ start=1652470596
++ date '+%Y-%m-%d %r'
+ start_fmt='2022-05-13 02:36:36 PM'
+ echo 'STARTING TIMING RUN AT 2022-05-13 02:36:36 PM'
STARTING TIMING RUN AT 2022-05-13 02:36:36 PM
+ readonly global_rank=0
+ global_rank=0
+ readonly local_rank=0
+ local_rank=0
+ SLURM_NTASKS_PER_NODE=1
+ OPTIMIZER=sgdwfastlars
+ BATCHSIZE=408
+ INPUT_BATCH_MULTIPLIER=1
+ KVSTORE=horovod
+ LR=10.5
+ MOM=0.9
+ LRSCHED=pow2
+ WARMUP_EPOCHS=2
+ LARSETA=0.001
+ DALI_HW_DECODER_LOAD=0
+ WD=5.0e-05
+ LABELSMOOTHING=0.1
+ SEED=12451
+ EVAL_OFFSET=2
+ EVAL_PERIOD=4
+ DALI_PREFETCH_QUEUE=5
+ DALI_NVJPEG_MEMPADDING=256
+ DALI_THREADS=6
+ DALI_CACHE_SIZE=0
+ DALI_ROI_DECODE=1
+ DALI_PREALLOCATE_WIDTH=5980
+ DALI_PREALLOCATE_HEIGHT=6430
+ DALI_TMP_BUFFER_HINT=355568328
+ DALI_DECODER_BUFFER_HINT=1315942
+ DALI_CROP_BUFFER_HINT=165581
+ DALI_NORMALIZE_BUFFER_HINT=441549
+ DALI_DONT_USE_MMAP=0
+ NUMEPOCHS=37
+ NETWORK=resnet-v1b-stats-fl
+ BN_GROUP=1
+ PROFILE=0
+ PROFILE_EXCEL=0
+ NODALI=0
+ NUMEXAMPLES=
+ PROFILE_ALL_LOCAL_RANKS=0
+ THR=0.759
+ [[ 0 == 1 ]]
+ DATAROOT=/data
running benchmark
+ echo 'running benchmark'
+ export NGPUS=1
+ NGPUS=1
+ export NCCL_DEBUG=WARN
+ NCCL_DEBUG=WARN
+ [[ 0 -ge 1 ]]
++ seq 0 3
++ tr '\n' ,
++ sed 's/,$//'
+ GPUS=0,1,2,3
+ PARAMS=(--gpus "${GPUS}" --batch-size "${BATCHSIZE}" --kv-store "${KVSTORE}" --lr "${LR}" --mom "${MOM}" --lr-step-epochs "${LRSCHED}" --lars-eta "${LARSETA}" --label-smoothing "${LABELSMOOTHING}" --wd "${WD}" --warmup-epochs "${WARMUP_EPOCHS}" --eval-period "${EVAL_PERIOD}" --eval-offset "${EVAL_OFFSET}" --optimizer "${OPTIMIZER}" --network "${NETWORK}" --num-layers "50" --num-epochs "${NUMEPOCHS}" --accuracy-threshold "${THR}" --seed "${SEED}" --dtype "float16" --disp-batches "20" --image-shape "4,224,224" --fuse-bn-relu "1" --fuse-bn-add-relu "1" --bn-group "${BN_GROUP}" --min-random-area "0.05" --max-random-area "1.0" --conv-algo "1" --force-tensor-core "1" --input-layout "NHWC" --conv-layout "NHWC" --batchnorm-layout "NHWC" --pooling-layout "NHWC" --batchnorm-mom "0.9" --batchnorm-eps "1e-5" --data-train "${DATAROOT}/train.rec" --data-train-idx "${DATAROOT}/train.idx" --data-val "${DATAROOT}/val.rec" --data-val-idx "${DATAROOT}/val.idx" --dali-dont-use-mmap "${DALI_DONT_USE_MMAP}" --dali-hw-decoder-load "${DALI_HW_DECODER_LOAD}" --dali-prefetch-queue "${DALI_PREFETCH_QUEUE}" --dali-nvjpeg-memory-padding "${DALI_NVJPEG_MEMPADDING}" --input-batch-multiplier "${INPUT_BATCH_MULTIPLIER}" --dali-threads "${DALI_THREADS}" --dali-cache-size "${DALI_CACHE_SIZE}" --dali-roi-decode "${DALI_ROI_DECODE}" --dali-preallocate-width "${DALI_PREALLOCATE_WIDTH}" --dali-preallocate-height "${DALI_PREALLOCATE_HEIGHT}" --dali-tmp-buffer-hint "${DALI_TMP_BUFFER_HINT}" --dali-decoder-buffer-hint "${DALI_DECODER_BUFFER_HINT}" --dali-crop-buffer-hint "${DALI_CROP_BUFFER_HINT}" --dali-normalize-buffer-hint "${DALI_NORMALIZE_BUFFER_HINT}" --profile "${PROFILE}")
+ [[ 0 -lt 1 ]]
+ PARAMS+=(--use-dali)
+ [[ '' -ge 1 ]]
+ echo PARAMS=--gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
PARAMS=--gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
+ python train_imagenet.py --gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
+ source ./config_2xXE8545x4A100-SXM-80GB.sh
+++ dirname ./config_2xXE8545x4A100-SXM-80GB.sh
++ source ./config_XE8545x4A100-SXM-80GB_common.sh
+++ export 'OMPI_MCA_btl=^openib'
+++ OMPI_MCA_btl='^openib'
+++ export DALI_DONT_USE_MMAP=0
+++ DALI_DONT_USE_MMAP=0
+++ export MXNET_EXTENDED_NORMCONV_SUPPORT=1
+++ MXNET_EXTENDED_NORMCONV_SUPPORT=1
+++ export DGXNGPU=4
+++ DGXNGPU=4
+++ export DGXNSOCKET=2
+++ DGXNSOCKET=2
+++ export DGXSOCKETCORES=64
+++ DGXSOCKETCORES=64
+++ export DGXHT=1
+++ DGXHT=1
+++ export HOROVOD_NUM_NCCL_STREAMS=1
+++ HOROVOD_NUM_NCCL_STREAMS=1
+++ export MXNET_HOROVOD_NUM_GROUPS=1
+++ MXNET_HOROVOD_NUM_GROUPS=1
+++ export HOROVOD_CYCLE_TIME=0.1
+++ HOROVOD_CYCLE_TIME=0.1
+++ export MXNET_OPTIMIZER_AGGREGATION_SIZE=54
+++ MXNET_OPTIMIZER_AGGREGATION_SIZE=54
+++ export MXNET_ENABLE_CUDA_GRAPHS=1
+++ MXNET_ENABLE_CUDA_GRAPHS=1
+++ export MXNET_CUDNN_WARN_ON_IGNORED_FLAGS=0
+++ MXNET_CUDNN_WARN_ON_IGNORED_FLAGS=0
+++ export MXNET_CUDNN_NHWC_BN_HEURISTIC_FWD=1
+++ MXNET_CUDNN_NHWC_BN_HEURISTIC_FWD=1
+++ export MXNET_CUDNN_NHWC_BN_HEURISTIC_BWD=1
+++ MXNET_CUDNN_NHWC_BN_HEURISTIC_BWD=1
+++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=1
+++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=1
+++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=1
+++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=1
+++ export RUN_NCCL_BW_TEST=0
+++ RUN_NCCL_BW_TEST=0
++ export MXNET_DETERMINISTIC=1
++ MXNET_DETERMINISTIC=1
++ export OPTIMIZER=sgdwfastlars
++ OPTIMIZER=sgdwfastlars
++ export BATCHSIZE=408
++ BATCHSIZE=408
++ export KVSTORE=horovod
++ KVSTORE=horovod
++ export LR=10.5
++ LR=10.5
++ export WARMUP_EPOCHS=2
++ WARMUP_EPOCHS=2
++ export EVAL_OFFSET=2
++ EVAL_OFFSET=2
++ export EVAL_PERIOD=4
++ EVAL_PERIOD=4
++ export WD=5.0e-05
++ WD=5.0e-05
++ export MOM=0.9
++ MOM=0.9
++ export LARSETA=0.001
++ LARSETA=0.001
++ export LABELSMOOTHING=0.1
++ LABELSMOOTHING=0.1
++ export LRSCHED=pow2
++ LRSCHED=pow2
++ export NUMEPOCHS=37
++ NUMEPOCHS=37
++ export NETWORK=resnet-v1b-stats-fl
++ NETWORK=resnet-v1b-stats-fl
++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=0
++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=0
++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=0
++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=0
++ export DALI_THREADS=6
++ DALI_THREADS=6
++ export DALI_PREFETCH_QUEUE=5
++ DALI_PREFETCH_QUEUE=5
++ export DALI_NVJPEG_MEMPADDING=256
++ DALI_NVJPEG_MEMPADDING=256
++ export DALI_HW_DECODER_LOAD=0
++ DALI_HW_DECODER_LOAD=0
++ export DALI_CACHE_SIZE=0
++ DALI_CACHE_SIZE=0
++ export DALI_ROI_DECODE=1
++ DALI_ROI_DECODE=1
++ export DALI_PREALLOCATE_WIDTH=5980
++ DALI_PREALLOCATE_WIDTH=5980
++ export DALI_PREALLOCATE_HEIGHT=6430
++ DALI_PREALLOCATE_HEIGHT=6430
++ export DALI_DECODER_BUFFER_HINT=1315942
++ DALI_DECODER_BUFFER_HINT=1315942
++ export DALI_CROP_BUFFER_HINT=165581
++ DALI_CROP_BUFFER_HINT=165581
++ export DALI_TMP_BUFFER_HINT=355568328
++ DALI_TMP_BUFFER_HINT=355568328
++ export DALI_NORMALIZE_BUFFER_HINT=441549
++ DALI_NORMALIZE_BUFFER_HINT=441549
++ export HOROVOD_CYCLE_TIME=0.1
++ HOROVOD_CYCLE_TIME=0.1
++ export HOROVOD_FUSION_THRESHOLD=67108864
++ HOROVOD_FUSION_THRESHOLD=67108864
++ export HOROVOD_NUM_NCCL_STREAMS=2
++ HOROVOD_NUM_NCCL_STREAMS=2
++ export MXNET_HOROVOD_NUM_GROUPS=1
++ MXNET_HOROVOD_NUM_GROUPS=1
++ export MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_FWD=999
++ MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_FWD=999
++ export MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_BWD=999
++ MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_BWD=999
++ export DGXNNODES=2
++ DGXNNODES=2
+++ sed 's/^config_//'
+++ sed 's/\.sh$//'
++++ readlink -f ./config_2xXE8545x4A100-SXM-80GB.sh
+++ basename /workspace/image_classification/config_2xXE8545x4A100-SXM-80GB.sh
++ export DGXSYSTEM=2xXE8545x4A100-SXM-80GB
++ DGXSYSTEM=2xXE8545x4A100-SXM-80GB
++ export WALLTIME=00:40:00
++ WALLTIME=00:40:00
++ export NCCL_MAX_RINGS=4
++ NCCL_MAX_RINGS=4
++ export OMPI_MCA_btl_openib_if_include=mlx5_0:1
++ OMPI_MCA_btl_openib_if_include=mlx5_0:1
++ export UCX_NET_DEVICES=mlx5_0:1
++ UCX_NET_DEVICES=mlx5_0:1
++ date +%s
+ start=1652470596
++ date '+%Y-%m-%d %r'
+ start_fmt='2022-05-13 02:36:36 PM'
+ echo 'STARTING TIMING RUN AT 2022-05-13 02:36:36 PM'
STARTING TIMING RUN AT 2022-05-13 02:36:36 PM
+ readonly global_rank=0
+ global_rank=0
+ readonly local_rank=0
+ local_rank=0
+ SLURM_NTASKS_PER_NODE=4
+ OPTIMIZER=sgdwfastlars
+ BATCHSIZE=408
+ INPUT_BATCH_MULTIPLIER=1
+ KVSTORE=horovod
+ LR=10.5
+ MOM=0.9
+ LRSCHED=pow2
+ WARMUP_EPOCHS=2
+ LARSETA=0.001
+ DALI_HW_DECODER_LOAD=0
+ WD=5.0e-05
+ LABELSMOOTHING=0.1
+ SEED=12451
+ EVAL_OFFSET=2
+ EVAL_PERIOD=4
+ DALI_PREFETCH_QUEUE=5
+ DALI_NVJPEG_MEMPADDING=256
+ DALI_THREADS=6
+ DALI_CACHE_SIZE=0
+ DALI_ROI_DECODE=1
+ DALI_PREALLOCATE_WIDTH=5980
+ DALI_PREALLOCATE_HEIGHT=6430
+ DALI_TMP_BUFFER_HINT=355568328
+ DALI_DECODER_BUFFER_HINT=1315942
+ DALI_CROP_BUFFER_HINT=165581
+ DALI_NORMALIZE_BUFFER_HINT=441549
+ DALI_DONT_USE_MMAP=0
+ NUMEPOCHS=37
+ NETWORK=resnet-v1b-stats-fl
+ BN_GROUP=1
+ PROFILE=0
+ PROFILE_EXCEL=0
+ NODALI=0
+ NUMEXAMPLES=
+ PROFILE_ALL_LOCAL_RANKS=0
+ THR=0.759
+ [[ 0 == 1 ]]
+ DATAROOT=/data
running benchmark
+ echo 'running benchmark'
+ export NGPUS=4
+ NGPUS=4
+ export NCCL_DEBUG=WARN
+ NCCL_DEBUG=WARN
+ [[ 0 -ge 1 ]]
++ seq 0 3
++ tr '\n' ,
++ sed 's/,$//'
+ GPUS=0,1,2,3
+ PARAMS=(--gpus "${GPUS}" --batch-size "${BATCHSIZE}" --kv-store "${KVSTORE}" --lr "${LR}" --mom "${MOM}" --lr-step-epochs "${LRSCHED}" --lars-eta "${LARSETA}" --label-smoothing "${LABELSMOOTHING}" --wd "${WD}" --warmup-epochs "${WARMUP_EPOCHS}" --eval-period "${EVAL_PERIOD}" --eval-offset "${EVAL_OFFSET}" --optimizer "${OPTIMIZER}" --network "${NETWORK}" --num-layers "50" --num-epochs "${NUMEPOCHS}" --accuracy-threshold "${THR}" --seed "${SEED}" --dtype "float16" --disp-batches "20" --image-shape "4,224,224" --fuse-bn-relu "1" --fuse-bn-add-relu "1" --bn-group "${BN_GROUP}" --min-random-area "0.05" --max-random-area "1.0" --conv-algo "1" --force-tensor-core "1" --input-layout "NHWC" --conv-layout "NHWC" --batchnorm-layout "NHWC" --pooling-layout "NHWC" --batchnorm-mom "0.9" --batchnorm-eps "1e-5" --data-train "${DATAROOT}/train.rec" --data-train-idx "${DATAROOT}/train.idx" --data-val "${DATAROOT}/val.rec" --data-val-idx "${DATAROOT}/val.idx" --dali-dont-use-mmap "${DALI_DONT_USE_MMAP}" --dali-hw-decoder-load "${DALI_HW_DECODER_LOAD}" --dali-prefetch-queue "${DALI_PREFETCH_QUEUE}" --dali-nvjpeg-memory-padding "${DALI_NVJPEG_MEMPADDING}" --input-batch-multiplier "${INPUT_BATCH_MULTIPLIER}" --dali-threads "${DALI_THREADS}" --dali-cache-size "${DALI_CACHE_SIZE}" --dali-roi-decode "${DALI_ROI_DECODE}" --dali-preallocate-width "${DALI_PREALLOCATE_WIDTH}" --dali-preallocate-height "${DALI_PREALLOCATE_HEIGHT}" --dali-tmp-buffer-hint "${DALI_TMP_BUFFER_HINT}" --dali-decoder-buffer-hint "${DALI_DECODER_BUFFER_HINT}" --dali-crop-buffer-hint "${DALI_CROP_BUFFER_HINT}" --dali-normalize-buffer-hint "${DALI_NORMALIZE_BUFFER_HINT}" --profile "${PROFILE}")
+ [[ 0 -lt 1 ]]
+ PARAMS+=(--use-dali)
+ [[ '' -ge 1 ]]
+ echo PARAMS=--gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
PARAMS=--gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
+ python train_imagenet.py --gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
+ source ./config_2xXE8545x4A100-SXM-80GB.sh
+++ dirname ./config_2xXE8545x4A100-SXM-80GB.sh
++ source ./config_XE8545x4A100-SXM-80GB_common.sh
+++ export 'OMPI_MCA_btl=^openib'
+++ OMPI_MCA_btl='^openib'
+++ export DALI_DONT_USE_MMAP=0
+++ DALI_DONT_USE_MMAP=0
+++ export MXNET_EXTENDED_NORMCONV_SUPPORT=1
+++ MXNET_EXTENDED_NORMCONV_SUPPORT=1
+++ export DGXNGPU=4
+++ DGXNGPU=4
+++ export DGXNSOCKET=2
+++ DGXNSOCKET=2
+++ export DGXSOCKETCORES=64
+++ DGXSOCKETCORES=64
+++ export DGXHT=1
+++ DGXHT=1
+++ export HOROVOD_NUM_NCCL_STREAMS=1
+++ HOROVOD_NUM_NCCL_STREAMS=1
+++ export MXNET_HOROVOD_NUM_GROUPS=1
+++ MXNET_HOROVOD_NUM_GROUPS=1
+++ export HOROVOD_CYCLE_TIME=0.1
+++ HOROVOD_CYCLE_TIME=0.1
+++ export MXNET_OPTIMIZER_AGGREGATION_SIZE=54
+++ MXNET_OPTIMIZER_AGGREGATION_SIZE=54
+++ export MXNET_ENABLE_CUDA_GRAPHS=1
+++ MXNET_ENABLE_CUDA_GRAPHS=1
+++ export MXNET_CUDNN_WARN_ON_IGNORED_FLAGS=0
+++ MXNET_CUDNN_WARN_ON_IGNORED_FLAGS=0
+++ export MXNET_CUDNN_NHWC_BN_HEURISTIC_FWD=1
+++ MXNET_CUDNN_NHWC_BN_HEURISTIC_FWD=1
+++ export MXNET_CUDNN_NHWC_BN_HEURISTIC_BWD=1
+++ MXNET_CUDNN_NHWC_BN_HEURISTIC_BWD=1
+++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=1
+++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=1
+++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=1
+++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=1
+++ export RUN_NCCL_BW_TEST=0
+++ RUN_NCCL_BW_TEST=0
++ export MXNET_DETERMINISTIC=1
++ MXNET_DETERMINISTIC=1
++ export OPTIMIZER=sgdwfastlars
++ OPTIMIZER=sgdwfastlars
++ export BATCHSIZE=408
++ BATCHSIZE=408
++ export KVSTORE=horovod
++ KVSTORE=horovod
++ export LR=10.5
++ LR=10.5
++ export WARMUP_EPOCHS=2
++ WARMUP_EPOCHS=2
++ export EVAL_OFFSET=2
++ EVAL_OFFSET=2
++ export EVAL_PERIOD=4
++ EVAL_PERIOD=4
++ export WD=5.0e-05
++ WD=5.0e-05
++ export MOM=0.9
++ MOM=0.9
++ export LARSETA=0.001
++ LARSETA=0.001
++ export LABELSMOOTHING=0.1
++ LABELSMOOTHING=0.1
++ export LRSCHED=pow2
++ LRSCHED=pow2
++ export NUMEPOCHS=37
++ NUMEPOCHS=37
++ export NETWORK=resnet-v1b-stats-fl
++ NETWORK=resnet-v1b-stats-fl
++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=0
++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=0
++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=0
++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=0
++ export DALI_THREADS=6
++ DALI_THREADS=6
++ export DALI_PREFETCH_QUEUE=5
++ DALI_PREFETCH_QUEUE=5
++ export DALI_NVJPEG_MEMPADDING=256
++ DALI_NVJPEG_MEMPADDING=256
++ export DALI_HW_DECODER_LOAD=0
++ DALI_HW_DECODER_LOAD=0
++ export DALI_CACHE_SIZE=0
++ DALI_CACHE_SIZE=0
++ export DALI_ROI_DECODE=1
++ DALI_ROI_DECODE=1
++ export DALI_PREALLOCATE_WIDTH=5980
++ DALI_PREALLOCATE_WIDTH=5980
++ export DALI_PREALLOCATE_HEIGHT=6430
++ DALI_PREALLOCATE_HEIGHT=6430
++ export DALI_DECODER_BUFFER_HINT=1315942
++ DALI_DECODER_BUFFER_HINT=1315942
++ export DALI_CROP_BUFFER_HINT=165581
++ DALI_CROP_BUFFER_HINT=165581
++ export DALI_TMP_BUFFER_HINT=355568328
++ DALI_TMP_BUFFER_HINT=355568328
++ export DALI_NORMALIZE_BUFFER_HINT=441549
++ DALI_NORMALIZE_BUFFER_HINT=441549
++ export HOROVOD_CYCLE_TIME=0.1
++ HOROVOD_CYCLE_TIME=0.1
++ export HOROVOD_FUSION_THRESHOLD=67108864
++ HOROVOD_FUSION_THRESHOLD=67108864
++ export HOROVOD_NUM_NCCL_STREAMS=2
++ HOROVOD_NUM_NCCL_STREAMS=2
++ export MXNET_HOROVOD_NUM_GROUPS=1
++ MXNET_HOROVOD_NUM_GROUPS=1
++ export MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_FWD=999
++ MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_FWD=999
++ export MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_BWD=999
++ MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_BWD=999
++ export DGXNNODES=2
++ DGXNNODES=2
+++ sed 's/^config_//'
+++ sed 's/\.sh$//'
++++ readlink -f ./config_2xXE8545x4A100-SXM-80GB.sh
+++ basename /workspace/image_classification/config_2xXE8545x4A100-SXM-80GB.sh
++ export DGXSYSTEM=2xXE8545x4A100-SXM-80GB
++ DGXSYSTEM=2xXE8545x4A100-SXM-80GB
++ export WALLTIME=00:40:00
++ WALLTIME=00:40:00
++ export NCCL_MAX_RINGS=4
++ NCCL_MAX_RINGS=4
++ export OMPI_MCA_btl_openib_if_include=mlx5_0:1
++ OMPI_MCA_btl_openib_if_include=mlx5_0:1
++ export UCX_NET_DEVICES=mlx5_0:1
++ UCX_NET_DEVICES=mlx5_0:1
++ date +%s
+ start=1652470596
++ date '+%Y-%m-%d %r'
+ start_fmt='2022-05-13 02:36:36 PM'
+ echo 'STARTING TIMING RUN AT 2022-05-13 02:36:36 PM'
STARTING TIMING RUN AT 2022-05-13 02:36:36 PM
+ readonly global_rank=0
+ global_rank=0
+ readonly local_rank=0
+ local_rank=0
+ SLURM_NTASKS_PER_NODE=4
+ OPTIMIZER=sgdwfastlars
+ BATCHSIZE=408
+ INPUT_BATCH_MULTIPLIER=1
+ KVSTORE=horovod
+ LR=10.5
+ MOM=0.9
+ LRSCHED=pow2
+ WARMUP_EPOCHS=2
+ LARSETA=0.001
+ DALI_HW_DECODER_LOAD=0
+ WD=5.0e-05
+ LABELSMOOTHING=0.1
+ SEED=12451
+ EVAL_OFFSET=2
+ EVAL_PERIOD=4
+ DALI_PREFETCH_QUEUE=5
+ DALI_NVJPEG_MEMPADDING=256
+ DALI_THREADS=6
+ DALI_CACHE_SIZE=0
+ DALI_ROI_DECODE=1
+ DALI_PREALLOCATE_WIDTH=5980
+ DALI_PREALLOCATE_HEIGHT=6430
+ DALI_TMP_BUFFER_HINT=355568328
+ DALI_DECODER_BUFFER_HINT=1315942
+ DALI_CROP_BUFFER_HINT=165581
+ DALI_NORMALIZE_BUFFER_HINT=441549
+ DALI_DONT_USE_MMAP=0
+ NUMEPOCHS=37
+ NETWORK=resnet-v1b-stats-fl
+ BN_GROUP=1
+ PROFILE=0
+ PROFILE_EXCEL=0
+ NODALI=0
+ NUMEXAMPLES=
+ PROFILE_ALL_LOCAL_RANKS=0
+ THR=0.759
+ [[ 0 == 1 ]]
+ DATAROOT=/data
running benchmark
+ echo 'running benchmark'
+ export NGPUS=4
+ NGPUS=4
+ export NCCL_DEBUG=WARN
+ NCCL_DEBUG=WARN
+ [[ 0 -ge 1 ]]
++ seq 0 3
++ tr '\n' ,
++ sed 's/,$//'
+ GPUS=0,1,2,3
+ PARAMS=(--gpus "${GPUS}" --batch-size "${BATCHSIZE}" --kv-store "${KVSTORE}" --lr "${LR}" --mom "${MOM}" --lr-step-epochs "${LRSCHED}" --lars-eta "${LARSETA}" --label-smoothing "${LABELSMOOTHING}" --wd "${WD}" --warmup-epochs "${WARMUP_EPOCHS}" --eval-period "${EVAL_PERIOD}" --eval-offset "${EVAL_OFFSET}" --optimizer "${OPTIMIZER}" --network "${NETWORK}" --num-layers "50" --num-epochs "${NUMEPOCHS}" --accuracy-threshold "${THR}" --seed "${SEED}" --dtype "float16" --disp-batches "20" --image-shape "4,224,224" --fuse-bn-relu "1" --fuse-bn-add-relu "1" --bn-group "${BN_GROUP}" --min-random-area "0.05" --max-random-area "1.0" --conv-algo "1" --force-tensor-core "1" --input-layout "NHWC" --conv-layout "NHWC" --batchnorm-layout "NHWC" --pooling-layout "NHWC" --batchnorm-mom "0.9" --batchnorm-eps "1e-5" --data-train "${DATAROOT}/train.rec" --data-train-idx "${DATAROOT}/train.idx" --data-val "${DATAROOT}/val.rec" --data-val-idx "${DATAROOT}/val.idx" --dali-dont-use-mmap "${DALI_DONT_USE_MMAP}" --dali-hw-decoder-load "${DALI_HW_DECODER_LOAD}" --dali-prefetch-queue "${DALI_PREFETCH_QUEUE}" --dali-nvjpeg-memory-padding "${DALI_NVJPEG_MEMPADDING}" --input-batch-multiplier "${INPUT_BATCH_MULTIPLIER}" --dali-threads "${DALI_THREADS}" --dali-cache-size "${DALI_CACHE_SIZE}" --dali-roi-decode "${DALI_ROI_DECODE}" --dali-preallocate-width "${DALI_PREALLOCATE_WIDTH}" --dali-preallocate-height "${DALI_PREALLOCATE_HEIGHT}" --dali-tmp-buffer-hint "${DALI_TMP_BUFFER_HINT}" --dali-decoder-buffer-hint "${DALI_DECODER_BUFFER_HINT}" --dali-crop-buffer-hint "${DALI_CROP_BUFFER_HINT}" --dali-normalize-buffer-hint "${DALI_NORMALIZE_BUFFER_HINT}" --profile "${PROFILE}")
+ [[ 0 -lt 1 ]]
+ PARAMS+=(--use-dali)
+ [[ '' -ge 1 ]]
+ echo PARAMS=--gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
PARAMS=--gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
+ python train_imagenet.py --gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
+ source ./config_2xXE8545x4A100-SXM-80GB.sh
+++ dirname ./config_2xXE8545x4A100-SXM-80GB.sh
++ source ./config_XE8545x4A100-SXM-80GB_common.sh
+++ export 'OMPI_MCA_btl=^openib'
+++ OMPI_MCA_btl='^openib'
+++ export DALI_DONT_USE_MMAP=0
+++ DALI_DONT_USE_MMAP=0
+++ export MXNET_EXTENDED_NORMCONV_SUPPORT=1
+++ MXNET_EXTENDED_NORMCONV_SUPPORT=1
+++ export DGXNGPU=4
+++ DGXNGPU=4
+++ export DGXNSOCKET=2
+++ DGXNSOCKET=2
+++ export DGXSOCKETCORES=64
+++ DGXSOCKETCORES=64
+++ export DGXHT=1
+++ DGXHT=1
+++ export HOROVOD_NUM_NCCL_STREAMS=1
+++ HOROVOD_NUM_NCCL_STREAMS=1
+++ export MXNET_HOROVOD_NUM_GROUPS=1
+++ MXNET_HOROVOD_NUM_GROUPS=1
+++ export HOROVOD_CYCLE_TIME=0.1
+++ HOROVOD_CYCLE_TIME=0.1
+++ export MXNET_OPTIMIZER_AGGREGATION_SIZE=54
+++ MXNET_OPTIMIZER_AGGREGATION_SIZE=54
+++ export MXNET_ENABLE_CUDA_GRAPHS=1
+++ MXNET_ENABLE_CUDA_GRAPHS=1
+++ export MXNET_CUDNN_WARN_ON_IGNORED_FLAGS=0
+++ MXNET_CUDNN_WARN_ON_IGNORED_FLAGS=0
+++ export MXNET_CUDNN_NHWC_BN_HEURISTIC_FWD=1
+++ MXNET_CUDNN_NHWC_BN_HEURISTIC_FWD=1
+++ export MXNET_CUDNN_NHWC_BN_HEURISTIC_BWD=1
+++ MXNET_CUDNN_NHWC_BN_HEURISTIC_BWD=1
+++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=1
+++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=1
+++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=1
+++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=1
+++ export RUN_NCCL_BW_TEST=0
+++ RUN_NCCL_BW_TEST=0
++ export MXNET_DETERMINISTIC=1
++ MXNET_DETERMINISTIC=1
++ export OPTIMIZER=sgdwfastlars
++ OPTIMIZER=sgdwfastlars
++ export BATCHSIZE=408
++ BATCHSIZE=408
++ export KVSTORE=horovod
++ KVSTORE=horovod
++ export LR=10.5
++ LR=10.5
++ export WARMUP_EPOCHS=2
++ WARMUP_EPOCHS=2
++ export EVAL_OFFSET=2
++ EVAL_OFFSET=2
++ export EVAL_PERIOD=4
++ EVAL_PERIOD=4
++ export WD=5.0e-05
++ WD=5.0e-05
++ export MOM=0.9
++ MOM=0.9
++ export LARSETA=0.001
++ LARSETA=0.001
++ export LABELSMOOTHING=0.1
++ LABELSMOOTHING=0.1
++ export LRSCHED=pow2
++ LRSCHED=pow2
++ export NUMEPOCHS=37
++ NUMEPOCHS=37
++ export NETWORK=resnet-v1b-stats-fl
++ NETWORK=resnet-v1b-stats-fl
++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=0
++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=0
++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=0
++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=0
++ export DALI_THREADS=6
++ DALI_THREADS=6
++ export DALI_PREFETCH_QUEUE=5
++ DALI_PREFETCH_QUEUE=5
++ export DALI_NVJPEG_MEMPADDING=256
++ DALI_NVJPEG_MEMPADDING=256
++ export DALI_HW_DECODER_LOAD=0
++ DALI_HW_DECODER_LOAD=0
++ export DALI_CACHE_SIZE=0
++ DALI_CACHE_SIZE=0
++ export DALI_ROI_DECODE=1
++ DALI_ROI_DECODE=1
++ export DALI_PREALLOCATE_WIDTH=5980
++ DALI_PREALLOCATE_WIDTH=5980
++ export DALI_PREALLOCATE_HEIGHT=6430
++ DALI_PREALLOCATE_HEIGHT=6430
++ export DALI_DECODER_BUFFER_HINT=1315942
++ DALI_DECODER_BUFFER_HINT=1315942
++ export DALI_CROP_BUFFER_HINT=165581
++ DALI_CROP_BUFFER_HINT=165581
++ export DALI_TMP_BUFFER_HINT=355568328
++ DALI_TMP_BUFFER_HINT=355568328
++ export DALI_NORMALIZE_BUFFER_HINT=441549
++ DALI_NORMALIZE_BUFFER_HINT=441549
++ export HOROVOD_CYCLE_TIME=0.1
++ HOROVOD_CYCLE_TIME=0.1
++ export HOROVOD_FUSION_THRESHOLD=67108864
++ HOROVOD_FUSION_THRESHOLD=67108864
++ export HOROVOD_NUM_NCCL_STREAMS=2
++ HOROVOD_NUM_NCCL_STREAMS=2
++ export MXNET_HOROVOD_NUM_GROUPS=1
++ MXNET_HOROVOD_NUM_GROUPS=1
++ export MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_FWD=999
++ MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_FWD=999
++ export MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_BWD=999
++ MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_BWD=999
++ export DGXNNODES=2
++ DGXNNODES=2
+++ sed 's/^config_//'
+++ sed 's/\.sh$//'
++++ readlink -f ./config_2xXE8545x4A100-SXM-80GB.sh
+++ basename /workspace/image_classification/config_2xXE8545x4A100-SXM-80GB.sh
++ export DGXSYSTEM=2xXE8545x4A100-SXM-80GB
++ DGXSYSTEM=2xXE8545x4A100-SXM-80GB
++ export WALLTIME=00:40:00
++ WALLTIME=00:40:00
++ export NCCL_MAX_RINGS=4
++ NCCL_MAX_RINGS=4
++ export OMPI_MCA_btl_openib_if_include=mlx5_0:1
++ OMPI_MCA_btl_openib_if_include=mlx5_0:1
++ export UCX_NET_DEVICES=mlx5_0:1
++ UCX_NET_DEVICES=mlx5_0:1
++ date +%s
+ start=1652470596
++ date '+%Y-%m-%d %r'
+ start_fmt='2022-05-13 02:36:36 PM'
+ echo 'STARTING TIMING RUN AT 2022-05-13 02:36:36 PM'
STARTING TIMING RUN AT 2022-05-13 02:36:36 PM
+ readonly global_rank=0
+ global_rank=0
+ readonly local_rank=0
+ local_rank=0
+ SLURM_NTASKS_PER_NODE=4
+ OPTIMIZER=sgdwfastlars
+ BATCHSIZE=408
+ INPUT_BATCH_MULTIPLIER=1
+ KVSTORE=horovod
+ LR=10.5
+ MOM=0.9
+ LRSCHED=pow2
+ WARMUP_EPOCHS=2
+ LARSETA=0.001
+ DALI_HW_DECODER_LOAD=0
+ WD=5.0e-05
+ LABELSMOOTHING=0.1
+ SEED=12451
+ EVAL_OFFSET=2
+ EVAL_PERIOD=4
+ DALI_PREFETCH_QUEUE=5
+ DALI_NVJPEG_MEMPADDING=256
+ DALI_THREADS=6
+ DALI_CACHE_SIZE=0
+ DALI_ROI_DECODE=1
+ DALI_PREALLOCATE_WIDTH=5980
+ DALI_PREALLOCATE_HEIGHT=6430
+ DALI_TMP_BUFFER_HINT=355568328
+ DALI_DECODER_BUFFER_HINT=1315942
+ DALI_CROP_BUFFER_HINT=165581
+ DALI_NORMALIZE_BUFFER_HINT=441549
+ DALI_DONT_USE_MMAP=0
+ NUMEPOCHS=37
+ NETWORK=resnet-v1b-stats-fl
+ BN_GROUP=1
+ PROFILE=0
+ PROFILE_EXCEL=0
+ NODALI=0
+ NUMEXAMPLES=
+ PROFILE_ALL_LOCAL_RANKS=0
+ THR=0.759
+ [[ 0 == 1 ]]
+ DATAROOT=/data
+ echo 'running benchmark'
running benchmark
+ export NGPUS=4
+ NGPUS=4
+ export NCCL_DEBUG=WARN
+ NCCL_DEBUG=WARN
+ [[ 0 -ge 1 ]]
++ seq 0 3
++ tr '\n' ,
++ sed 's/,$//'
+ GPUS=0,1,2,3
+ PARAMS=(--gpus "${GPUS}" --batch-size "${BATCHSIZE}" --kv-store "${KVSTORE}" --lr "${LR}" --mom "${MOM}" --lr-step-epochs "${LRSCHED}" --lars-eta "${LARSETA}" --label-smoothing "${LABELSMOOTHING}" --wd "${WD}" --warmup-epochs "${WARMUP_EPOCHS}" --eval-period "${EVAL_PERIOD}" --eval-offset "${EVAL_OFFSET}" --optimizer "${OPTIMIZER}" --network "${NETWORK}" --num-layers "50" --num-epochs "${NUMEPOCHS}" --accuracy-threshold "${THR}" --seed "${SEED}" --dtype "float16" --disp-batches "20" --image-shape "4,224,224" --fuse-bn-relu "1" --fuse-bn-add-relu "1" --bn-group "${BN_GROUP}" --min-random-area "0.05" --max-random-area "1.0" --conv-algo "1" --force-tensor-core "1" --input-layout "NHWC" --conv-layout "NHWC" --batchnorm-layout "NHWC" --pooling-layout "NHWC" --batchnorm-mom "0.9" --batchnorm-eps "1e-5" --data-train "${DATAROOT}/train.rec" --data-train-idx "${DATAROOT}/train.idx" --data-val "${DATAROOT}/val.rec" --data-val-idx "${DATAROOT}/val.idx" --dali-dont-use-mmap "${DALI_DONT_USE_MMAP}" --dali-hw-decoder-load "${DALI_HW_DECODER_LOAD}" --dali-prefetch-queue "${DALI_PREFETCH_QUEUE}" --dali-nvjpeg-memory-padding "${DALI_NVJPEG_MEMPADDING}" --input-batch-multiplier "${INPUT_BATCH_MULTIPLIER}" --dali-threads "${DALI_THREADS}" --dali-cache-size "${DALI_CACHE_SIZE}" --dali-roi-decode "${DALI_ROI_DECODE}" --dali-preallocate-width "${DALI_PREALLOCATE_WIDTH}" --dali-preallocate-height "${DALI_PREALLOCATE_HEIGHT}" --dali-tmp-buffer-hint "${DALI_TMP_BUFFER_HINT}" --dali-decoder-buffer-hint "${DALI_DECODER_BUFFER_HINT}" --dali-crop-buffer-hint "${DALI_CROP_BUFFER_HINT}" --dali-normalize-buffer-hint "${DALI_NORMALIZE_BUFFER_HINT}" --profile "${PROFILE}")
+ [[ 0 -lt 1 ]]
+ PARAMS+=(--use-dali)
+ [[ '' -ge 1 ]]
+ echo PARAMS=--gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
PARAMS=--gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
+ python train_imagenet.py --gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
+ source ./config_2xXE8545x4A100-SXM-80GB.sh
+++ dirname ./config_2xXE8545x4A100-SXM-80GB.sh
++ source ./config_XE8545x4A100-SXM-80GB_common.sh
+++ export 'OMPI_MCA_btl=^openib'
+++ OMPI_MCA_btl='^openib'
+++ export DALI_DONT_USE_MMAP=0
+++ DALI_DONT_USE_MMAP=0
+++ export MXNET_EXTENDED_NORMCONV_SUPPORT=1
+++ MXNET_EXTENDED_NORMCONV_SUPPORT=1
+++ export DGXNGPU=4
+++ DGXNGPU=4
+++ export DGXNSOCKET=2
+++ DGXNSOCKET=2
+++ export DGXSOCKETCORES=64
+++ DGXSOCKETCORES=64
+++ export DGXHT=1
+++ DGXHT=1
+++ export HOROVOD_NUM_NCCL_STREAMS=1
+++ HOROVOD_NUM_NCCL_STREAMS=1
+++ export MXNET_HOROVOD_NUM_GROUPS=1
+++ MXNET_HOROVOD_NUM_GROUPS=1
+++ export HOROVOD_CYCLE_TIME=0.1
+++ HOROVOD_CYCLE_TIME=0.1
+++ export MXNET_OPTIMIZER_AGGREGATION_SIZE=54
+++ MXNET_OPTIMIZER_AGGREGATION_SIZE=54
+++ export MXNET_ENABLE_CUDA_GRAPHS=1
+++ MXNET_ENABLE_CUDA_GRAPHS=1
+++ export MXNET_CUDNN_WARN_ON_IGNORED_FLAGS=0
+++ MXNET_CUDNN_WARN_ON_IGNORED_FLAGS=0
+++ export MXNET_CUDNN_NHWC_BN_HEURISTIC_FWD=1
+++ MXNET_CUDNN_NHWC_BN_HEURISTIC_FWD=1
+++ export MXNET_CUDNN_NHWC_BN_HEURISTIC_BWD=1
+++ MXNET_CUDNN_NHWC_BN_HEURISTIC_BWD=1
+++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=1
+++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=1
+++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=1
+++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=1
+++ export RUN_NCCL_BW_TEST=0
+++ RUN_NCCL_BW_TEST=0
++ export MXNET_DETERMINISTIC=1
++ MXNET_DETERMINISTIC=1
++ export OPTIMIZER=sgdwfastlars
++ OPTIMIZER=sgdwfastlars
++ export BATCHSIZE=408
++ BATCHSIZE=408
++ export KVSTORE=horovod
++ KVSTORE=horovod
++ export LR=10.5
++ LR=10.5
++ export WARMUP_EPOCHS=2
++ WARMUP_EPOCHS=2
++ export EVAL_OFFSET=2
++ EVAL_OFFSET=2
++ export EVAL_PERIOD=4
++ EVAL_PERIOD=4
++ export WD=5.0e-05
++ WD=5.0e-05
++ export MOM=0.9
++ MOM=0.9
++ export LARSETA=0.001
++ LARSETA=0.001
++ export LABELSMOOTHING=0.1
++ LABELSMOOTHING=0.1
++ export LRSCHED=pow2
++ LRSCHED=pow2
++ export NUMEPOCHS=37
++ NUMEPOCHS=37
++ export NETWORK=resnet-v1b-stats-fl
++ NETWORK=resnet-v1b-stats-fl
++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=0
++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_BWD=0
++ export MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=0
++ MXNET_CUDNN_NHWC_BN_ADD_HEURISTIC_FWD=0
++ export DALI_THREADS=6
++ DALI_THREADS=6
++ export DALI_PREFETCH_QUEUE=5
++ DALI_PREFETCH_QUEUE=5
++ export DALI_NVJPEG_MEMPADDING=256
++ DALI_NVJPEG_MEMPADDING=256
++ export DALI_HW_DECODER_LOAD=0
++ DALI_HW_DECODER_LOAD=0
++ export DALI_CACHE_SIZE=0
++ DALI_CACHE_SIZE=0
++ export DALI_ROI_DECODE=1
++ DALI_ROI_DECODE=1
++ export DALI_PREALLOCATE_WIDTH=5980
++ DALI_PREALLOCATE_WIDTH=5980
++ export DALI_PREALLOCATE_HEIGHT=6430
++ DALI_PREALLOCATE_HEIGHT=6430
++ export DALI_DECODER_BUFFER_HINT=1315942
++ DALI_DECODER_BUFFER_HINT=1315942
++ export DALI_CROP_BUFFER_HINT=165581
++ DALI_CROP_BUFFER_HINT=165581
++ export DALI_TMP_BUFFER_HINT=355568328
++ DALI_TMP_BUFFER_HINT=355568328
++ export DALI_NORMALIZE_BUFFER_HINT=441549
++ DALI_NORMALIZE_BUFFER_HINT=441549
++ export HOROVOD_CYCLE_TIME=0.1
++ HOROVOD_CYCLE_TIME=0.1
++ export HOROVOD_FUSION_THRESHOLD=67108864
++ HOROVOD_FUSION_THRESHOLD=67108864
++ export HOROVOD_NUM_NCCL_STREAMS=2
++ HOROVOD_NUM_NCCL_STREAMS=2
++ export MXNET_HOROVOD_NUM_GROUPS=1
++ MXNET_HOROVOD_NUM_GROUPS=1
++ export MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_FWD=999
++ MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_FWD=999
++ export MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_BWD=999
++ MXNET_EXEC_BULK_EXEC_MAX_NODE_TRAIN_BWD=999
++ export DGXNNODES=2
++ DGXNNODES=2
+++ sed 's/^config_//'
+++ sed 's/\.sh$//'
++++ readlink -f ./config_2xXE8545x4A100-SXM-80GB.sh
+++ basename /workspace/image_classification/config_2xXE8545x4A100-SXM-80GB.sh
++ export DGXSYSTEM=2xXE8545x4A100-SXM-80GB
++ DGXSYSTEM=2xXE8545x4A100-SXM-80GB
++ export WALLTIME=00:40:00
++ WALLTIME=00:40:00
++ export NCCL_MAX_RINGS=4
++ NCCL_MAX_RINGS=4
++ export OMPI_MCA_btl_openib_if_include=mlx5_0:1
++ OMPI_MCA_btl_openib_if_include=mlx5_0:1
++ export UCX_NET_DEVICES=mlx5_0:1
++ UCX_NET_DEVICES=mlx5_0:1
++ date +%s
+ start=1652470596
++ date '+%Y-%m-%d %r'
+ start_fmt='2022-05-13 02:36:36 PM'
+ echo 'STARTING TIMING RUN AT 2022-05-13 02:36:36 PM'
STARTING TIMING RUN AT 2022-05-13 02:36:36 PM
+ readonly global_rank=0
+ global_rank=0
+ readonly local_rank=0
+ local_rank=0
+ SLURM_NTASKS_PER_NODE=4
+ OPTIMIZER=sgdwfastlars
+ BATCHSIZE=408
+ INPUT_BATCH_MULTIPLIER=1
+ KVSTORE=horovod
+ LR=10.5
+ MOM=0.9
+ LRSCHED=pow2
+ WARMUP_EPOCHS=2
+ LARSETA=0.001
+ DALI_HW_DECODER_LOAD=0
+ WD=5.0e-05
+ LABELSMOOTHING=0.1
+ SEED=12451
+ EVAL_OFFSET=2
+ EVAL_PERIOD=4
+ DALI_PREFETCH_QUEUE=5
+ DALI_NVJPEG_MEMPADDING=256
+ DALI_THREADS=6
+ DALI_CACHE_SIZE=0
+ DALI_ROI_DECODE=1
+ DALI_PREALLOCATE_WIDTH=5980
+ DALI_PREALLOCATE_HEIGHT=6430
+ DALI_TMP_BUFFER_HINT=355568328
+ DALI_DECODER_BUFFER_HINT=1315942
+ DALI_CROP_BUFFER_HINT=165581
+ DALI_NORMALIZE_BUFFER_HINT=441549
+ DALI_DONT_USE_MMAP=0
+ NUMEPOCHS=37
+ NETWORK=resnet-v1b-stats-fl
+ BN_GROUP=1
+ PROFILE=0
+ PROFILE_EXCEL=0
+ NODALI=0
+ NUMEXAMPLES=
+ PROFILE_ALL_LOCAL_RANKS=0
+ THR=0.759
+ [[ 0 == 1 ]]
+ DATAROOT=/data
+ echo 'running benchmark'
running benchmark
+ export NGPUS=4
+ NGPUS=4
+ export NCCL_DEBUG=WARN
+ NCCL_DEBUG=WARN
+ [[ 0 -ge 1 ]]
++ seq 0 3
++ tr '\n' ,
++ sed 's/,$//'
+ GPUS=0,1,2,3
+ PARAMS=(--gpus "${GPUS}" --batch-size "${BATCHSIZE}" --kv-store "${KVSTORE}" --lr "${LR}" --mom "${MOM}" --lr-step-epochs "${LRSCHED}" --lars-eta "${LARSETA}" --label-smoothing "${LABELSMOOTHING}" --wd "${WD}" --warmup-epochs "${WARMUP_EPOCHS}" --eval-period "${EVAL_PERIOD}" --eval-offset "${EVAL_OFFSET}" --optimizer "${OPTIMIZER}" --network "${NETWORK}" --num-layers "50" --num-epochs "${NUMEPOCHS}" --accuracy-threshold "${THR}" --seed "${SEED}" --dtype "float16" --disp-batches "20" --image-shape "4,224,224" --fuse-bn-relu "1" --fuse-bn-add-relu "1" --bn-group "${BN_GROUP}" --min-random-area "0.05" --max-random-area "1.0" --conv-algo "1" --force-tensor-core "1" --input-layout "NHWC" --conv-layout "NHWC" --batchnorm-layout "NHWC" --pooling-layout "NHWC" --batchnorm-mom "0.9" --batchnorm-eps "1e-5" --data-train "${DATAROOT}/train.rec" --data-train-idx "${DATAROOT}/train.idx" --data-val "${DATAROOT}/val.rec" --data-val-idx "${DATAROOT}/val.idx" --dali-dont-use-mmap "${DALI_DONT_USE_MMAP}" --dali-hw-decoder-load "${DALI_HW_DECODER_LOAD}" --dali-prefetch-queue "${DALI_PREFETCH_QUEUE}" --dali-nvjpeg-memory-padding "${DALI_NVJPEG_MEMPADDING}" --input-batch-multiplier "${INPUT_BATCH_MULTIPLIER}" --dali-threads "${DALI_THREADS}" --dali-cache-size "${DALI_CACHE_SIZE}" --dali-roi-decode "${DALI_ROI_DECODE}" --dali-preallocate-width "${DALI_PREALLOCATE_WIDTH}" --dali-preallocate-height "${DALI_PREALLOCATE_HEIGHT}" --dali-tmp-buffer-hint "${DALI_TMP_BUFFER_HINT}" --dali-decoder-buffer-hint "${DALI_DECODER_BUFFER_HINT}" --dali-crop-buffer-hint "${DALI_CROP_BUFFER_HINT}" --dali-normalize-buffer-hint "${DALI_NORMALIZE_BUFFER_HINT}" --profile "${PROFILE}")
+ [[ 0 -lt 1 ]]
+ PARAMS+=(--use-dali)
+ [[ '' -ge 1 ]]
+ echo PARAMS=--gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
PARAMS=--gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
+ python train_imagenet.py --gpus 0,1,2,3 --batch-size 408 --kv-store horovod --lr 10.5 --mom 0.9 --lr-step-epochs pow2 --lars-eta 0.001 --label-smoothing 0.1 --wd 5.0e-05 --warmup-epochs 2 --eval-period 4 --eval-offset 2 --optimizer sgdwfastlars --network resnet-v1b-stats-fl --num-layers 50 --num-epochs 37 --accuracy-threshold 0.759 --seed 12451 --dtype float16 --disp-batches 20 --image-shape 4,224,224 --fuse-bn-relu 1 --fuse-bn-add-relu 1 --bn-group 1 --min-random-area 0.05 --max-random-area 1.0 --conv-algo 1 --force-tensor-core 1 --input-layout NHWC --conv-layout NHWC --batchnorm-layout NHWC --pooling-layout NHWC --batchnorm-mom 0.9 --batchnorm-eps 1e-5 --data-train /data/train.rec --data-train-idx /data/train.idx --data-val /data/val.rec --data-val-idx /data/val.idx --dali-dont-use-mmap 0 --dali-hw-decoder-load 0 --dali-prefetch-queue 5 --dali-nvjpeg-memory-padding 256 --input-batch-multiplier 1 --dali-threads 6 --dali-cache-size 0 --dali-roi-decode 1 --dali-preallocate-width 5980 --dali-preallocate-height 6430 --dali-tmp-buffer-hint 355568328 --dali-decoder-buffer-hint 1315942 --dali-crop-buffer-hint 165581 --dali-normalize-buffer-hint 441549 --profile 0 --use-dali
[node048:2031091] MCW rank 7 is not bound (or bound to all available processors)
[node048:2031117] MCW rank 4 is not bound (or bound to all available processors)
[node048:2031144] MCW rank 6 is not bound (or bound to all available processors)
[node048:2031177] MCW rank 5 is not bound (or bound to all available processors)
[node047:1454287] MCW rank 3 is not bound (or bound to all available processors)
[node047:1454313] MCW rank 1 is not bound (or bound to all available processors)
[node047:1454339] MCW rank 0 is not bound (or bound to all available processors)
[node047:1454370] MCW rank 2 is not bound (or bound to all available processors)
:::MLLOG {"namespace": "", "time_ms": 1652470602374, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 117}}
:::MLLOG {"namespace": "", "time_ms": 1652470602373, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 117}}
:::MLLOG {"namespace": "", "time_ms": 1652470602373, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 117}}
:::MLLOG {"namespace": "", "time_ms": 1652470602373, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 117}}
:::MLLOG {"namespace": "", "time_ms": 1652470602376, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 117}}
:::MLLOG {"namespace": "", "time_ms": 1652470602377, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 117}}
:::MLLOG {"namespace": "", "time_ms": 1652470602377, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 117}}
:::MLLOG {"namespace": "", "time_ms": 1652470602377, "event_type": "INTERVAL_START", "key": "init_start", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 117}}
[14:36:51] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for GPU
[14:36:51] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for GPU
[14:36:51] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for GPU
[14:36:51] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for GPU
[14:36:58] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for GPU
[14:36:59] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for GPU
[14:36:59] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for GPU
:::MLLOG {"namespace": "", "time_ms": 1652470619781, "event_type": "POINT_IN_TIME", "key": "seed", "value": 12451, "metadata": {"file": "train_imagenet.py", "lineno": 173}}
[14:36:59] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for GPU
NCCL version 2.12.10+cuda11.6
:::MLLOG {"namespace": "", "time_ms": 1652470622555, "event_type": "POINT_IN_TIME", "key": "model_bn_span", "value": 408, "metadata": {"file": "/workspace/image_classification/common/dali.py", "lineno": 323}}
[14:37:06] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for CPU
[[14:37:06] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for CPU
14:37:06] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for CPU
[14:37:06] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for CPU
[14:37:07] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for CPU
[14:37:07] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for CPU
[14:37:07] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for CPU
[14:37:07] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for CPU
:::MLLOG {"namespace": "", "time_ms": 1652470627386, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "bn0_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627387, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "bn0_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627388, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "conv0_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627388, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 78, "tensor": "fc1_bias"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627389, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 69, "tensor": "fc1_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627389, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage1_unit1_bn1_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627390, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage1_unit1_bn1_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627390, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage1_unit1_bn2_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627391, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage1_unit1_bn2_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627391, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage1_unit1_bn3_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627392, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage1_unit1_bn3_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627392, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage1_unit1_bnsc_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627392, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage1_unit1_bnsc_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627393, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage1_unit1_conv1_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627393, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage1_unit1_conv1sc_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627393, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage1_unit1_conv2_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627394, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage1_unit1_conv3_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627394, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage1_unit2_bn1_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627394, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage1_unit2_bn1_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627395, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage1_unit2_bn2_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627395, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage1_unit2_bn2_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627396, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage1_unit2_bn3_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627396, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage1_unit2_bn3_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627396, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage1_unit2_conv1_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627397, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage1_unit2_conv2_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627397, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage1_unit2_conv3_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627397, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage1_unit3_bn1_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627398, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage1_unit3_bn1_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627398, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage1_unit3_bn2_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627398, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage1_unit3_bn2_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627399, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage1_unit3_bn3_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627399, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage1_unit3_bn3_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627399, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage1_unit3_conv1_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627400, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage1_unit3_conv2_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627400, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage1_unit3_conv3_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627400, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage2_unit1_bn1_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627401, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage2_unit1_bn1_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627401, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage2_unit1_bn2_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627401, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage2_unit1_bn2_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627402, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage2_unit1_bn3_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627402, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage2_unit1_bn3_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627402, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage2_unit1_bnsc_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627403, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage2_unit1_bnsc_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627403, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage2_unit1_conv1_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627403, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage2_unit1_conv1sc_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627404, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage2_unit1_conv2_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627404, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage2_unit1_conv3_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627404, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage2_unit2_bn1_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627405, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage2_unit2_bn1_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627405, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage2_unit2_bn2_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627405, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage2_unit2_bn2_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627406, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage2_unit2_bn3_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627406, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage2_unit2_bn3_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627407, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage2_unit2_conv1_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627407, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage2_unit2_conv2_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627407, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage2_unit2_conv3_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627407, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage2_unit3_bn1_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627408, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage2_unit3_bn1_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627408, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage2_unit3_bn2_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627409, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage2_unit3_bn2_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627409, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage2_unit3_bn3_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627409, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage2_unit3_bn3_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627410, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage2_unit3_conv1_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627410, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage2_unit3_conv2_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627410, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage2_unit3_conv3_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627411, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage2_unit4_bn1_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627411, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage2_unit4_bn1_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627411, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage2_unit4_bn2_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627412, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage2_unit4_bn2_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627412, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage2_unit4_bn3_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627412, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage2_unit4_bn3_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627413, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage2_unit4_conv1_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627413, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage2_unit4_conv2_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627413, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage2_unit4_conv3_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627414, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit1_bn1_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627414, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit1_bn1_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627414, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit1_bn2_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627415, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit1_bn2_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627415, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit1_bn3_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627415, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit1_bn3_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627416, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit1_bnsc_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627416, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit1_bnsc_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627416, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit1_conv1_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627417, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit1_conv1sc_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627417, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit1_conv2_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627417, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit1_conv3_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627418, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit2_bn1_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627418, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit2_bn1_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627418, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit2_bn2_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627419, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit2_bn2_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627419, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit2_bn3_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627420, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit2_bn3_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627420, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit2_conv1_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627420, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit2_conv2_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627420, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit2_conv3_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627421, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit3_bn1_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627421, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit3_bn1_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627422, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit3_bn2_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627422, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit3_bn2_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627422, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit3_bn3_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627423, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit3_bn3_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627423, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit3_conv1_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627423, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit3_conv2_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627424, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit3_conv3_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627424, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit4_bn1_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627424, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit4_bn1_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627425, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit4_bn2_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627425, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit4_bn2_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627425, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit4_bn3_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627426, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit4_bn3_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627426, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit4_conv1_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627426, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit4_conv2_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627427, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit4_conv3_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627427, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit5_bn1_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627427, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit5_bn1_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627428, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit5_bn2_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627428, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit5_bn2_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627428, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit5_bn3_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627429, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit5_bn3_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627429, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit5_conv1_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627429, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit5_conv2_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627430, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit5_conv3_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627430, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit6_bn1_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627430, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit6_bn1_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627431, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit6_bn2_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627431, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit6_bn2_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627431, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage3_unit6_bn3_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627432, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage3_unit6_bn3_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627432, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit6_conv1_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627432, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit6_conv2_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627433, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage3_unit6_conv3_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627433, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage4_unit1_bn1_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627433, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage4_unit1_bn1_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627434, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage4_unit1_bn2_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627434, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage4_unit1_bn2_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627434, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage4_unit1_bn3_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627435, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage4_unit1_bn3_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627435, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage4_unit1_bnsc_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627435, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage4_unit1_bnsc_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627436, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage4_unit1_conv1_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627436, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage4_unit1_conv1sc_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627436, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage4_unit1_conv2_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627437, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage4_unit1_conv3_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627437, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage4_unit2_bn1_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627437, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage4_unit2_bn1_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627438, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage4_unit2_bn2_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627438, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage4_unit2_bn2_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627438, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage4_unit2_bn3_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627439, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage4_unit2_bn3_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627439, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage4_unit2_conv1_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627439, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage4_unit2_conv2_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627440, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage4_unit2_conv3_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627440, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage4_unit3_bn1_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627440, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage4_unit3_bn1_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627441, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage4_unit3_bn2_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627441, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage4_unit3_bn2_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627441, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 88, "tensor": "stage4_unit3_bn3_beta"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627442, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 83, "tensor": "stage4_unit3_bn3_gamma"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627442, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage4_unit3_conv1_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627442, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage4_unit3_conv2_weight"}}
:::MLLOG {"namespace": "", "time_ms": 1652470627443, "event_type": "POINT_IN_TIME", "key": "weights_initialization", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 73, "tensor": "stage4_unit3_conv3_weight"}}
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `coin_flip` is now deprecated. Use `random.coin_flip` instead.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `mxnet_reader` is now deprecated. Use `readers.mxnet` instead.
In DALI 1.0 all readers were moved into a dedicated :mod:`~nvidia.dali.fn.readers`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `image_decoder_random_crop` is now deprecated. Use `decoders.image_random_crop` instead.
In DALI 1.0 all decoders were moved into a dedicated :mod:`~nvidia.dali.fn.decoders`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `mxnet_reader` is now deprecated. Use `readers.mxnet` instead.
In DALI 1.0 all readers were moved into a dedicated :mod:`~nvidia.dali.fn.readers`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `image_decoder` is now deprecated. Use `decoders.image` instead.
In DALI 1.0 all decoders were moved into a dedicated :mod:`~nvidia.dali.fn.decoders`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
2022-05-13 14:37:09,254 Node[4] start with arguments Namespace(accuracy_threshold=0.759, batch_size=408, batchnorm_eps=1e-05, batchnorm_layout='NHWC', batchnorm_mom=0.9, bn_gamma_init0=False, bn_group=1, conv_algo=1, conv_layout='NHWC', custom_bn_off=0, dali_bytes_per_sample_hint=10485760, dali_cache_size=0, dali_crop_buffer_hint=165581, dali_decoder_buffer_hint=1315942, dali_dont_use_mmap=0, dali_hw_decoder_load=0.0, dali_normalize_buffer_hint=441549, dali_nvjpeg_memory_padding=256, dali_preallocate_height=6430, dali_preallocate_width=5980, dali_prefetch_queue=5, dali_roi_decode=True, dali_threads=6, dali_tmp_buffer_hint=355568328, data_train='/data/train.rec', data_train_idx='/data/train.idx', data_val='/data/val.rec', data_val_idx='/data/val.idx', disp_batches=20, dtype='float16', e2e_cuda_graphs=None, epoch_size=0, eval_offset=2, eval_period=4, force_tensor_core=1, fuse_bn_add_relu=1, fuse_bn_relu=1, gpus='0', image_shape='4,224,224', initializer='default', input_batch_multiplier=1, input_layout='NHWC', kv_store='horovod', label_smoothing=0.1, lars_eps=0, lars_eta=0.001, lazy_init_sanity=False, local_rank=0, log='', logging_dir='logs', lr=10.5, lr_factor=0.1, lr_step_epochs='pow2', max_random_area=1.0, max_random_aspect_ratio=1.3333333333333333, min_random_area=0.05, min_random_aspect_ratio=0.75, model_prefix=None, mom=0.9, network='resnet-v1b-stats-fl', num_classes=1000, num_epochs=37, num_examples=1281167, num_layers=50, num_val_examples=-1, optimizer='sgdwfastlars', pooling_layout='NHWC', profile=0, profile_server_suffix='', profile_worker_suffix='', resize=256, save_period=1, seed=18314, separ_val=False, top_k=0, use_dali=True, verbose=0, warmup_epochs=2, warmup_strategy='linear', wd=5e-05)
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `coin_flip` is now deprecated. Use `random.coin_flip` instead.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `mxnet_reader` is now deprecated. Use `readers.mxnet` instead.
In DALI 1.0 all readers were moved into a dedicated :mod:`~nvidia.dali.fn.readers`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `image_decoder_random_crop` is now deprecated. Use `decoders.image_random_crop` instead.
In DALI 1.0 all decoders were moved into a dedicated :mod:`~nvidia.dali.fn.decoders`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `mxnet_reader` is now deprecated. Use `readers.mxnet` instead.
In DALI 1.0 all readers were moved into a dedicated :mod:`~nvidia.dali.fn.readers`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `image_decoder` is now deprecated. Use `decoders.image` instead.
In DALI 1.0 all decoders were moved into a dedicated :mod:`~nvidia.dali.fn.decoders`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
2022-05-13 14:37:09,255 Node[5] start with arguments Namespace(accuracy_threshold=0.759, batch_size=408, batchnorm_eps=1e-05, batchnorm_layout='NHWC', batchnorm_mom=0.9, bn_gamma_init0=False, bn_group=1, conv_algo=1, conv_layout='NHWC', custom_bn_off=0, dali_bytes_per_sample_hint=10485760, dali_cache_size=0, dali_crop_buffer_hint=165581, dali_decoder_buffer_hint=1315942, dali_dont_use_mmap=0, dali_hw_decoder_load=0.0, dali_normalize_buffer_hint=441549, dali_nvjpeg_memory_padding=256, dali_preallocate_height=6430, dali_preallocate_width=5980, dali_prefetch_queue=5, dali_roi_decode=True, dali_threads=6, dali_tmp_buffer_hint=355568328, data_train='/data/train.rec', data_train_idx='/data/train.idx', data_val='/data/val.rec', data_val_idx='/data/val.idx', disp_batches=20, dtype='float16', e2e_cuda_graphs=None, epoch_size=0, eval_offset=2, eval_period=4, force_tensor_core=1, fuse_bn_add_relu=1, fuse_bn_relu=1, gpus='1', image_shape='4,224,224', initializer='default', input_batch_multiplier=1, input_layout='NHWC', kv_store='horovod', label_smoothing=0.1, lars_eps=0, lars_eta=0.001, lazy_init_sanity=False, local_rank=1, log='', logging_dir='logs', lr=10.5, lr_factor=0.1, lr_step_epochs='pow2', max_random_area=1.0, max_random_aspect_ratio=1.3333333333333333, min_random_area=0.05, min_random_aspect_ratio=0.75, model_prefix=None, mom=0.9, network='resnet-v1b-stats-fl', num_classes=1000, num_epochs=37, num_examples=1281167, num_layers=50, num_val_examples=-1, optimizer='sgdwfastlars', pooling_layout='NHWC', profile=0, profile_server_suffix='', profile_worker_suffix='', resize=256, save_period=1, seed=10358, separ_val=False, top_k=0, use_dali=True, verbose=0, warmup_epochs=2, warmup_strategy='linear', wd=5e-05)
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `coin_flip` is now deprecated. Use `random.coin_flip` instead.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `mxnet_reader` is now deprecated. Use `readers.mxnet` instead.
In DALI 1.0 all readers were moved into a dedicated :mod:`~nvidia.dali.fn.readers`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `image_decoder_random_crop` is now deprecated. Use `decoders.image_random_crop` instead.
In DALI 1.0 all decoders were moved into a dedicated :mod:`~nvidia.dali.fn.decoders`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `mxnet_reader` is now deprecated. Use `readers.mxnet` instead.
In DALI 1.0 all readers were moved into a dedicated :mod:`~nvidia.dali.fn.readers`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `image_decoder` is now deprecated. Use `decoders.image` instead.
In DALI 1.0 all decoders were moved into a dedicated :mod:`~nvidia.dali.fn.decoders`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
2022-05-13 14:37:09,257 Node[6] start with arguments Namespace(accuracy_threshold=0.759, batch_size=408, batchnorm_eps=1e-05, batchnorm_layout='NHWC', batchnorm_mom=0.9, bn_gamma_init0=False, bn_group=1, conv_algo=1, conv_layout='NHWC', custom_bn_off=0, dali_bytes_per_sample_hint=10485760, dali_cache_size=0, dali_crop_buffer_hint=165581, dali_decoder_buffer_hint=1315942, dali_dont_use_mmap=0, dali_hw_decoder_load=0.0, dali_normalize_buffer_hint=441549, dali_nvjpeg_memory_padding=256, dali_preallocate_height=6430, dali_preallocate_width=5980, dali_prefetch_queue=5, dali_roi_decode=True, dali_threads=6, dali_tmp_buffer_hint=355568328, data_train='/data/train.rec', data_train_idx='/data/train.idx', data_val='/data/val.rec', data_val_idx='/data/val.idx', disp_batches=20, dtype='float16', e2e_cuda_graphs=None, epoch_size=0, eval_offset=2, eval_period=4, force_tensor_core=1, fuse_bn_add_relu=1, fuse_bn_relu=1, gpus='2', image_shape='4,224,224', initializer='default', input_batch_multiplier=1, input_layout='NHWC', kv_store='horovod', label_smoothing=0.1, lars_eps=0, lars_eta=0.001, lazy_init_sanity=False, local_rank=2, log='', logging_dir='logs', lr=10.5, lr_factor=0.1, lr_step_epochs='pow2', max_random_area=1.0, max_random_aspect_ratio=1.3333333333333333, min_random_area=0.05, min_random_aspect_ratio=0.75, model_prefix=None, mom=0.9, network='resnet-v1b-stats-fl', num_classes=1000, num_epochs=37, num_examples=1281167, num_layers=50, num_val_examples=-1, optimizer='sgdwfastlars', pooling_layout='NHWC', profile=0, profile_server_suffix='', profile_worker_suffix='', resize=256, save_period=1, seed=18766, separ_val=False, top_k=0, use_dali=True, verbose=0, warmup_epochs=2, warmup_strategy='linear', wd=5e-05)
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `coin_flip` is now deprecated. Use `random.coin_flip` instead.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `mxnet_reader` is now deprecated. Use `readers.mxnet` instead.
In DALI 1.0 all readers were moved into a dedicated :mod:`~nvidia.dali.fn.readers`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `image_decoder_random_crop` is now deprecated. Use `decoders.image_random_crop` instead.
In DALI 1.0 all decoders were moved into a dedicated :mod:`~nvidia.dali.fn.decoders`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `mxnet_reader` is now deprecated. Use `readers.mxnet` instead.
In DALI 1.0 all readers were moved into a dedicated :mod:`~nvidia.dali.fn.readers`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `image_decoder` is now deprecated. Use `decoders.image` instead.
In DALI 1.0 all decoders were moved into a dedicated :mod:`~nvidia.dali.fn.decoders`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
2022-05-13 14:37:09,259 Node[7] start with arguments Namespace(accuracy_threshold=0.759, batch_size=408, batchnorm_eps=1e-05, batchnorm_layout='NHWC', batchnorm_mom=0.9, bn_gamma_init0=False, bn_group=1, conv_algo=1, conv_layout='NHWC', custom_bn_off=0, dali_bytes_per_sample_hint=10485760, dali_cache_size=0, dali_crop_buffer_hint=165581, dali_decoder_buffer_hint=1315942, dali_dont_use_mmap=0, dali_hw_decoder_load=0.0, dali_normalize_buffer_hint=441549, dali_nvjpeg_memory_padding=256, dali_preallocate_height=6430, dali_preallocate_width=5980, dali_prefetch_queue=5, dali_roi_decode=True, dali_threads=6, dali_tmp_buffer_hint=355568328, data_train='/data/train.rec', data_train_idx='/data/train.idx', data_val='/data/val.rec', data_val_idx='/data/val.idx', disp_batches=20, dtype='float16', e2e_cuda_graphs=None, epoch_size=0, eval_offset=2, eval_period=4, force_tensor_core=1, fuse_bn_add_relu=1, fuse_bn_relu=1, gpus='3', image_shape='4,224,224', initializer='default', input_batch_multiplier=1, input_layout='NHWC', kv_store='horovod', label_smoothing=0.1, lars_eps=0, lars_eta=0.001, lazy_init_sanity=False, local_rank=3, log='', logging_dir='logs', lr=10.5, lr_factor=0.1, lr_step_epochs='pow2', max_random_area=1.0, max_random_aspect_ratio=1.3333333333333333, min_random_area=0.05, min_random_aspect_ratio=0.75, model_prefix=None, mom=0.9, network='resnet-v1b-stats-fl', num_classes=1000, num_epochs=37, num_examples=1281167, num_layers=50, num_val_examples=-1, optimizer='sgdwfastlars', pooling_layout='NHWC', profile=0, profile_server_suffix='', profile_worker_suffix='', resize=256, save_period=1, seed=29303, separ_val=False, top_k=0, use_dali=True, verbose=0, warmup_epochs=2, warmup_strategy='linear', wd=5e-05)
:::MLLOG {"namespace": "", "time_ms": 1652470629261, "event_type": "INTERVAL_END", "key": "init_stop", "value": null, "metadata": {"file": "train_imagenet.py", "lineno": 230}}
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `coin_flip` is now deprecated. Use `random.coin_flip` instead.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `mxnet_reader` is now deprecated. Use `readers.mxnet` instead.
In DALI 1.0 all readers were moved into a dedicated :mod:`~nvidia.dali.fn.readers`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `image_decoder_random_crop` is now deprecated. Use `decoders.image_random_crop` instead.
In DALI 1.0 all decoders were moved into a dedicated :mod:`~nvidia.dali.fn.decoders`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `mxnet_reader` is now deprecated. Use `readers.mxnet` instead.
In DALI 1.0 all readers were moved into a dedicated :mod:`~nvidia.dali.fn.readers`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `image_decoder` is now deprecated. Use `decoders.image` instead.
In DALI 1.0 all decoders were moved into a dedicated :mod:`~nvidia.dali.fn.decoders`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
2022-05-13 14:37:09,261 Node[0] start with arguments Namespace(accuracy_threshold=0.759, batch_size=408, batchnorm_eps=1e-05, batchnorm_layout='NHWC', batchnorm_mom=0.9, bn_gamma_init0=False, bn_group=1, conv_algo=1, conv_layout='NHWC', custom_bn_off=0, dali_bytes_per_sample_hint=10485760, dali_cache_size=0, dali_crop_buffer_hint=165581, dali_decoder_buffer_hint=1315942, dali_dont_use_mmap=0, dali_hw_decoder_load=0.0, dali_normalize_buffer_hint=441549, dali_nvjpeg_memory_padding=256, dali_preallocate_height=6430, dali_preallocate_width=5980, dali_prefetch_queue=5, dali_roi_decode=True, dali_threads=6, dali_tmp_buffer_hint=355568328, data_train='/data/train.rec', data_train_idx='/data/train.idx', data_val='/data/val.rec', data_val_idx='/data/val.idx', disp_batches=20, dtype='float16', e2e_cuda_graphs=None, epoch_size=0, eval_offset=2, eval_period=4, force_tensor_core=1, fuse_bn_add_relu=1, fuse_bn_relu=1, gpus='0', image_shape='4,224,224', initializer='default', input_batch_multiplier=1, input_layout='NHWC', kv_store='horovod', label_smoothing=0.1, lars_eps=0, lars_eta=0.001, lazy_init_sanity=False, local_rank=0, log='', logging_dir='logs', lr=10.5, lr_factor=0.1, lr_step_epochs='pow2', max_random_area=1.0, max_random_aspect_ratio=1.3333333333333333, min_random_area=0.05, min_random_aspect_ratio=0.75, model_prefix=None, mom=0.9, network='resnet-v1b-stats-fl', num_classes=1000, num_epochs=37, num_examples=1281167, num_layers=50, num_val_examples=-1, optimizer='sgdwfastlars', pooling_layout='NHWC', profile=0, profile_server_suffix='', profile_worker_suffix='', resize=256, save_period=1, seed=7117, separ_val=False, top_k=0, use_dali=True, verbose=0, warmup_epochs=2, warmup_strategy='linear', wd=5e-05)
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `coin_flip` is now deprecated. Use `random.coin_flip` instead.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `mxnet_reader` is now deprecated. Use `readers.mxnet` instead.
In DALI 1.0 all readers were moved into a dedicated :mod:`~nvidia.dali.fn.readers`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `image_decoder_random_crop` is now deprecated. Use `decoders.image_random_crop` instead.
In DALI 1.0 all decoders were moved into a dedicated :mod:`~nvidia.dali.fn.decoders`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `mxnet_reader` is now deprecated. Use `readers.mxnet` instead.
In DALI 1.0 all readers were moved into a dedicated :mod:`~nvidia.dali.fn.readers`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `image_decoder` is now deprecated. Use `decoders.image` instead.
In DALI 1.0 all decoders were moved into a dedicated :mod:`~nvidia.dali.fn.decoders`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
2022-05-13 14:37:09,264 Node[3] start with arguments Namespace(accuracy_threshold=0.759, batch_size=408, batchnorm_eps=1e-05, batchnorm_layout='NHWC', batchnorm_mom=0.9, bn_gamma_init0=False, bn_group=1, conv_algo=1, conv_layout='NHWC', custom_bn_off=0, dali_bytes_per_sample_hint=10485760, dali_cache_size=0, dali_crop_buffer_hint=165581, dali_decoder_buffer_hint=1315942, dali_dont_use_mmap=0, dali_hw_decoder_load=0.0, dali_normalize_buffer_hint=441549, dali_nvjpeg_memory_padding=256, dali_preallocate_height=6430, dali_preallocate_width=5980, dali_prefetch_queue=5, dali_roi_decode=True, dali_threads=6, dali_tmp_buffer_hint=355568328, data_train='/data/train.rec', data_train_idx='/data/train.idx', data_val='/data/val.rec', data_val_idx='/data/val.idx', disp_batches=20, dtype='float16', e2e_cuda_graphs=None, epoch_size=0, eval_offset=2, eval_period=4, force_tensor_core=1, fuse_bn_add_relu=1, fuse_bn_relu=1, gpus='3', image_shape='4,224,224', initializer='default', input_batch_multiplier=1, input_layout='NHWC', kv_store='horovod', label_smoothing=0.1, lars_eps=0, lars_eta=0.001, lazy_init_sanity=False, local_rank=3, log='', logging_dir='logs', lr=10.5, lr_factor=0.1, lr_step_epochs='pow2', max_random_area=1.0, max_random_aspect_ratio=1.3333333333333333, min_random_area=0.05, min_random_aspect_ratio=0.75, model_prefix=None, mom=0.9, network='resnet-v1b-stats-fl', num_classes=1000, num_epochs=37, num_examples=1281167, num_layers=50, num_val_examples=-1, optimizer='sgdwfastlars', pooling_layout='NHWC', profile=0, profile_server_suffix='', profile_worker_suffix='', resize=256, save_period=1, seed=34486, separ_val=False, top_k=0, use_dali=True, verbose=0, warmup_epochs=2, warmup_strategy='linear', wd=5e-05)
:::MLLOG {"namespace": "", "time_ms": 1652470629262, "event_type": "POINT_IN_TIME", "key": "sgd_opt_learning_rate_decay_poly_power", "value": 2, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 710}}
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `coin_flip` is now deprecated. Use `random.coin_flip` instead.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `mxnet_reader` is now deprecated. Use `readers.mxnet` instead.
In DALI 1.0 all readers were moved into a dedicated :mod:`~nvidia.dali.fn.readers`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `image_decoder_random_crop` is now deprecated. Use `decoders.image_random_crop` instead.
In DALI 1.0 all decoders were moved into a dedicated :mod:`~nvidia.dali.fn.decoders`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `mxnet_reader` is now deprecated. Use `readers.mxnet` instead.
In DALI 1.0 all readers were moved into a dedicated :mod:`~nvidia.dali.fn.readers`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `image_decoder` is now deprecated. Use `decoders.image` instead.
In DALI 1.0 all decoders were moved into a dedicated :mod:`~nvidia.dali.fn.decoders`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
2022-05-13 14:37:09,264 Node[1] start with arguments Namespace(accuracy_threshold=0.759, batch_size=408, batchnorm_eps=1e-05, batchnorm_layout='NHWC', batchnorm_mom=0.9, bn_gamma_init0=False, bn_group=1, conv_algo=1, conv_layout='NHWC', custom_bn_off=0, dali_bytes_per_sample_hint=10485760, dali_cache_size=0, dali_crop_buffer_hint=165581, dali_decoder_buffer_hint=1315942, dali_dont_use_mmap=0, dali_hw_decoder_load=0.0, dali_normalize_buffer_hint=441549, dali_nvjpeg_memory_padding=256, dali_preallocate_height=6430, dali_preallocate_width=5980, dali_prefetch_queue=5, dali_roi_decode=True, dali_threads=6, dali_tmp_buffer_hint=355568328, data_train='/data/train.rec', data_train_idx='/data/train.idx', data_val='/data/val.rec', data_val_idx='/data/val.idx', disp_batches=20, dtype='float16', e2e_cuda_graphs=None, epoch_size=0, eval_offset=2, eval_period=4, force_tensor_core=1, fuse_bn_add_relu=1, fuse_bn_relu=1, gpus='1', image_shape='4,224,224', initializer='default', input_batch_multiplier=1, input_layout='NHWC', kv_store='horovod', label_smoothing=0.1, lars_eps=0, lars_eta=0.001, lazy_init_sanity=False, local_rank=1, log='', logging_dir='logs', lr=10.5, lr_factor=0.1, lr_step_epochs='pow2', max_random_area=1.0, max_random_aspect_ratio=1.3333333333333333, min_random_area=0.05, min_random_aspect_ratio=0.75, model_prefix=None, mom=0.9, network='resnet-v1b-stats-fl', num_classes=1000, num_epochs=37, num_examples=1281167, num_layers=50, num_val_examples=-1, optimizer='sgdwfastlars', pooling_layout='NHWC', profile=0, profile_server_suffix='', profile_worker_suffix='', resize=256, save_period=1, seed=26210, separ_val=False, top_k=0, use_dali=True, verbose=0, warmup_epochs=2, warmup_strategy='linear', wd=5e-05)
:::MLLOG {"namespace": "", "time_ms": 1652470629264, "event_type": "POINT_IN_TIME", "key": "sgd_opt_end_learning_rate", "value": 0.0001, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 711}}
:::MLLOG {"namespace": "", "time_ms": 1652470629265, "event_type": "POINT_IN_TIME", "key": "lars_opt_learning_rate_decay_poly_power", "value": 2, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 712}}
:::MLLOG {"namespace": "", "time_ms": 1652470629265, "event_type": "POINT_IN_TIME", "key": "lars_opt_end_learning_rate", "value": 0.0001, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 713}}
:::MLLOG {"namespace": "", "time_ms": 1652470629265, "event_type": "POINT_IN_TIME", "key": "d_batch_size", "value": 408, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1176}}
:::MLLOG {"namespace": "", "time_ms": 1652470629265, "event_type": "POINT_IN_TIME", "key": "s_optimizer", "value": "sgdwfastlars", "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1177}}
:::MLLOG {"namespace": "", "time_ms": 1652470629265, "event_type": "POINT_IN_TIME", "key": "s_network", "value": "resnet-v1b-stats-fl", "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1178}}
:::MLLOG {"namespace": "", "time_ms": 1652470629265, "event_type": "POINT_IN_TIME", "key": "s_process", "value": "horovod", "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1179}}
:::MLLOG {"namespace": "", "time_ms": 1652470629266, "event_type": "POINT_IN_TIME", "key": "global_batch_size", "value": 3264, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1180}}
:::MLLOG {"namespace": "", "time_ms": 1652470629266, "event_type": "POINT_IN_TIME", "key": "s_optimizer", "value": "sgdwfastlars", "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1181}}
:::MLLOG {"namespace": "", "time_ms": 1652470629266, "event_type": "POINT_IN_TIME", "key": "s_network", "value": "resnet-v1b-stats-fl", "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1182}}
:::MLLOG {"namespace": "", "time_ms": 1652470629266, "event_type": "POINT_IN_TIME", "key": "s_process", "value": "horovod", "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1183}}
:::MLLOG {"namespace": "", "time_ms": 1652470629266, "event_type": "POINT_IN_TIME", "key": "gradient_accumulation_steps", "value": 1, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1184}}
:::MLLOG {"namespace": "", "time_ms": 1652470629266, "event_type": "POINT_IN_TIME", "key": "opt_name", "value": "lars", "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1190}}
:::MLLOG {"namespace": "", "time_ms": 1652470629266, "event_type": "POINT_IN_TIME", "key": "lars_epsilon", "value": 0, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1192}}
:::MLLOG {"namespace": "", "time_ms": 1652470629266, "event_type": "POINT_IN_TIME", "key": "lars_opt_weight_decay", "value": 5e-05, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1194}}
:::MLLOG {"namespace": "", "time_ms": 1652470629266, "event_type": "POINT_IN_TIME", "key": "lars_opt_momentum", "value": 0.9, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1196}}
:::MLLOG {"namespace": "", "time_ms": 1652470629267, "event_type": "POINT_IN_TIME", "key": "lars_opt_base_learning_rate", "value": 10.5, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1197}}
:::MLLOG {"namespace": "", "time_ms": 1652470629267, "event_type": "POINT_IN_TIME", "key": "lars_opt_learning_rate_warmup_epochs", "value": 2, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1198}}
:::MLLOG {"namespace": "", "time_ms": 1652470629267, "event_type": "POINT_IN_TIME", "key": "lars_opt_learning_rate_decay_steps", "value": 37, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1199}}
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `coin_flip` is now deprecated. Use `random.coin_flip` instead.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `mxnet_reader` is now deprecated. Use `readers.mxnet` instead.
In DALI 1.0 all readers were moved into a dedicated :mod:`~nvidia.dali.fn.readers`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `image_decoder_random_crop` is now deprecated. Use `decoders.image_random_crop` instead.
In DALI 1.0 all decoders were moved into a dedicated :mod:`~nvidia.dali.fn.decoders`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `mxnet_reader` is now deprecated. Use `readers.mxnet` instead.
In DALI 1.0 all readers were moved into a dedicated :mod:`~nvidia.dali.fn.readers`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
/usr/local/lib/python3.8/dist-packages/nvidia/dali/ops.py:627: DeprecationWarning: WARNING: `image_decoder` is now deprecated. Use `decoders.image` instead.
In DALI 1.0 all decoders were moved into a dedicated :mod:`~nvidia.dali.fn.decoders`
submodule and renamed to follow a common pattern. This is a placeholder operator with identical
functionality to allow for backward compatibility.
  op_instances.append(_OperatorInstance(input_set, self, **kwargs))
2022-05-13 14:37:09,267 Node[2] start with arguments Namespace(accuracy_threshold=0.759, batch_size=408, batchnorm_eps=1e-05, batchnorm_layout='NHWC', batchnorm_mom=0.9, bn_gamma_init0=False, bn_group=1, conv_algo=1, conv_layout='NHWC', custom_bn_off=0, dali_bytes_per_sample_hint=10485760, dali_cache_size=0, dali_crop_buffer_hint=165581, dali_decoder_buffer_hint=1315942, dali_dont_use_mmap=0, dali_hw_decoder_load=0.0, dali_normalize_buffer_hint=441549, dali_nvjpeg_memory_padding=256, dali_preallocate_height=6430, dali_preallocate_width=5980, dali_prefetch_queue=5, dali_roi_decode=True, dali_threads=6, dali_tmp_buffer_hint=355568328, data_train='/data/train.rec', data_train_idx='/data/train.idx', data_val='/data/val.rec', data_val_idx='/data/val.idx', disp_batches=20, dtype='float16', e2e_cuda_graphs=None, epoch_size=0, eval_offset=2, eval_period=4, force_tensor_core=1, fuse_bn_add_relu=1, fuse_bn_relu=1, gpus='2', image_shape='4,224,224', initializer='default', input_batch_multiplier=1, input_layout='NHWC', kv_store='horovod', label_smoothing=0.1, lars_eps=0, lars_eta=0.001, lazy_init_sanity=False, local_rank=2, log='', logging_dir='logs', lr=10.5, lr_factor=0.1, lr_step_epochs='pow2', max_random_area=1.0, max_random_aspect_ratio=1.3333333333333333, min_random_area=0.05, min_random_aspect_ratio=0.75, model_prefix=None, mom=0.9, network='resnet-v1b-stats-fl', num_classes=1000, num_epochs=37, num_examples=1281167, num_layers=50, num_val_examples=-1, optimizer='sgdwfastlars', pooling_layout='NHWC', profile=0, profile_server_suffix='', profile_worker_suffix='', resize=256, save_period=1, seed=2121, separ_val=False, top_k=0, use_dali=True, verbose=0, warmup_epochs=2, warmup_strategy='linear', wd=5e-05)
[14:37:23] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for GPU
[14:37:23] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for GPU
[14:37:23] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for GPU
[14:37:32] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for GPU
[14:37:32] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for GPU
[14:37:32] ../src/storage/storage.cc:199: Using Pooled (Naive) StorageManager for GPU
:::MLLOG {"namespace": "", "time_ms": 1652470656043, "event_type": "INTERVAL_START", "key": "run_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1348}}
:::MLLOG {"namespace": "", "time_ms": 1652470656045, "event_type": "POINT_IN_TIME", "key": "train_samples", "value": 1281167, "metadata": {"file": "/workspace/image_classification/common/dali.py", "lineno": 500}}
:::MLLOG {"namespace": "", "time_ms": 1652470656334, "event_type": "POINT_IN_TIME", "key": "eval_samples", "value": 50000, "metadata": {"file": "/workspace/image_classification/common/dali.py", "lineno": 522}}
:::MLLOG {"namespace": "", "time_ms": 1652470656335, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 902, "first_epoch_num": 1, "epoch_count": 3}}
:::MLLOG {"namespace": "", "time_ms": 1652470656335, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 1}}
/usr/local/lib/python3.8/dist-packages/nvidia/dali/plugin/mxnet.py:89: Warning: Please do not use `fill_last_batch` and use `last_batch_policy` instead.
  _DaliBaseIterator.__init__(self,
2022-05-13 14:37:39,447 Node[0] Epoch[0] Batch [0-20]	Speed: 26690.54 samples/sec	accuracy=nan
2022-05-13 14:37:41,893 Node[0] Epoch[0] Batch [20-40]	Speed: 26695.68 samples/sec	accuracy=nan
2022-05-13 14:37:44,335 Node[0] Epoch[0] Batch [40-60]	Speed: 26726.31 samples/sec	accuracy=nan
2022-05-13 14:37:46,778 Node[0] Epoch[0] Batch [60-80]	Speed: 26723.58 samples/sec	accuracy=nan
2022-05-13 14:37:49,219 Node[0] Epoch[0] Batch [80-100]	Speed: 26743.10 samples/sec	accuracy=nan
2022-05-13 14:37:51,663 Node[0] Epoch[0] Batch [100-120]	Speed: 26709.14 samples/sec	accuracy=nan
2022-05-13 14:37:54,104 Node[0] Epoch[0] Batch [120-140]	Speed: 26739.78 samples/sec	accuracy=nan
2022-05-13 14:37:56,546 Node[0] Epoch[0] Batch [140-160]	Speed: 26737.10 samples/sec	accuracy=nan
2022-05-13 14:37:58,988 Node[0] Epoch[0] Batch [160-180]	Speed: 26729.28 samples/sec	accuracy=nan
2022-05-13 14:38:01,434 Node[0] Epoch[0] Batch [180-200]	Speed: 26693.57 samples/sec	accuracy=nan
2022-05-13 14:38:03,878 Node[0] Epoch[0] Batch [200-220]	Speed: 26702.86 samples/sec	accuracy=nan
2022-05-13 14:38:06,329 Node[0] Epoch[0] Batch [220-240]	Speed: 26636.37 samples/sec	accuracy=nan
2022-05-13 14:38:08,777 Node[0] Epoch[0] Batch [240-260]	Speed: 26670.72 samples/sec	accuracy=nan
2022-05-13 14:38:11,222 Node[0] Epoch[0] Batch [260-280]	Speed: 26691.80 samples/sec	accuracy=nan
2022-05-13 14:38:13,667 Node[0] Epoch[0] Batch [280-300]	Speed: 26703.23 samples/sec	accuracy=nan
2022-05-13 14:38:16,115 Node[0] Epoch[0] Batch [300-320]	Speed: 26670.06 samples/sec	accuracy=nan
2022-05-13 14:38:20,111 Node[0] Epoch[0] Batch [320-340]	Speed: 16336.35 samples/sec	accuracy=nan
2022-05-13 14:38:27,006 Node[0] Epoch[0] Batch [340-360]	Speed: 9467.62 samples/sec	accuracy=nan
2022-05-13 14:38:29,451 Node[0] Epoch[0] Batch [360-380]	Speed: 26697.14 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652470712455, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 1}}
2022-05-13 14:38:32,456 Node[0] Epoch[0] Time cost=56.121
:::MLLOG {"namespace": "", "time_ms": 1652470712456, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 22828.52547767984}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 1}}
:::MLLOG {"namespace": "", "time_ms": 1652470712457, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 22828.52547767984, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652470712458, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 2}}
2022-05-13 14:38:37,244 Node[0] Epoch[1] Batch [0-20]	Speed: 14006.07 samples/sec	accuracy=nan
2022-05-13 14:38:39,686 Node[0] Epoch[1] Batch [20-40]	Speed: 26726.10 samples/sec	accuracy=nan
2022-05-13 14:38:42,133 Node[0] Epoch[1] Batch [40-60]	Speed: 26683.66 samples/sec	accuracy=nan
2022-05-13 14:38:46,815 Node[0] Epoch[1] Batch [60-80]	Speed: 13943.72 samples/sec	accuracy=nan
2022-05-13 14:38:49,258 Node[0] Epoch[1] Batch [80-100]	Speed: 26713.21 samples/sec	accuracy=nan
2022-05-13 14:38:53,186 Node[0] Epoch[1] Batch [100-120]	Speed: 16620.88 samples/sec	accuracy=nan
2022-05-13 14:38:55,629 Node[0] Epoch[1] Batch [120-140]	Speed: 26721.22 samples/sec	accuracy=nan
2022-05-13 14:38:58,070 Node[0] Epoch[1] Batch [140-160]	Speed: 26738.57 samples/sec	accuracy=nan
2022-05-13 14:39:00,513 Node[0] Epoch[1] Batch [160-180]	Speed: 26723.98 samples/sec	accuracy=nan
2022-05-13 14:39:02,959 Node[0] Epoch[1] Batch [180-200]	Speed: 26686.34 samples/sec	accuracy=nan
2022-05-13 14:39:05,401 Node[0] Epoch[1] Batch [200-220]	Speed: 26737.78 samples/sec	accuracy=nan
2022-05-13 14:39:07,844 Node[0] Epoch[1] Batch [220-240]	Speed: 26719.34 samples/sec	accuracy=nan
2022-05-13 14:39:10,290 Node[0] Epoch[1] Batch [240-260]	Speed: 26690.17 samples/sec	accuracy=nan
2022-05-13 14:39:12,730 Node[0] Epoch[1] Batch [260-280]	Speed: 26748.24 samples/sec	accuracy=nan
2022-05-13 14:39:15,175 Node[0] Epoch[1] Batch [280-300]	Speed: 26706.27 samples/sec	accuracy=nan
2022-05-13 14:39:17,618 Node[0] Epoch[1] Batch [300-320]	Speed: 26713.41 samples/sec	accuracy=nan
2022-05-13 14:39:20,062 Node[0] Epoch[1] Batch [320-340]	Speed: 26709.39 samples/sec	accuracy=nan
2022-05-13 14:39:22,505 Node[0] Epoch[1] Batch [340-360]	Speed: 26722.44 samples/sec	accuracy=nan
2022-05-13 14:39:24,948 Node[0] Epoch[1] Batch [360-380]	Speed: 26724.51 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652470766413, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 2}}
2022-05-13 14:39:26,414 Node[0] Epoch[1] Time cost=53.956
:::MLLOG {"namespace": "", "time_ms": 1652470766414, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 23744.69218078606}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 2}}
:::MLLOG {"namespace": "", "time_ms": 1652470766414, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 23744.69218078606, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652470766414, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 3}}
2022-05-13 14:39:28,980 Node[0] Epoch[2] Batch [0-20]	Speed: 26704.86 samples/sec	accuracy=nan
2022-05-13 14:39:31,424 Node[0] Epoch[2] Batch [20-40]	Speed: 26710.58 samples/sec	accuracy=nan
2022-05-13 14:39:33,868 Node[0] Epoch[2] Batch [40-60]	Speed: 26707.58 samples/sec	accuracy=nan
2022-05-13 14:39:36,311 Node[0] Epoch[2] Batch [60-80]	Speed: 26719.79 samples/sec	accuracy=nan
2022-05-13 14:39:38,754 Node[0] Epoch[2] Batch [80-100]	Speed: 26719.15 samples/sec	accuracy=nan
2022-05-13 14:39:41,195 Node[0] Epoch[2] Batch [100-120]	Speed: 26749.85 samples/sec	accuracy=nan
2022-05-13 14:39:43,637 Node[0] Epoch[2] Batch [120-140]	Speed: 26732.46 samples/sec	accuracy=nan
2022-05-13 14:39:46,077 Node[0] Epoch[2] Batch [140-160]	Speed: 26745.59 samples/sec	accuracy=nan
2022-05-13 14:39:48,519 Node[0] Epoch[2] Batch [160-180]	Speed: 26737.78 samples/sec	accuracy=nan
2022-05-13 14:39:50,963 Node[0] Epoch[2] Batch [180-200]	Speed: 26712.76 samples/sec	accuracy=nan
2022-05-13 14:39:53,405 Node[0] Epoch[2] Batch [200-220]	Speed: 26728.30 samples/sec	accuracy=nan
2022-05-13 14:39:55,846 Node[0] Epoch[2] Batch [220-240]	Speed: 26740.44 samples/sec	accuracy=nan
2022-05-13 14:39:58,287 Node[0] Epoch[2] Batch [240-260]	Speed: 26749.83 samples/sec	accuracy=nan
2022-05-13 14:40:00,729 Node[0] Epoch[2] Batch [260-280]	Speed: 26731.79 samples/sec	accuracy=nan
2022-05-13 14:40:03,168 Node[0] Epoch[2] Batch [280-300]	Speed: 26758.82 samples/sec	accuracy=nan
2022-05-13 14:40:05,614 Node[0] Epoch[2] Batch [300-320]	Speed: 26688.00 samples/sec	accuracy=nan
2022-05-13 14:40:08,057 Node[0] Epoch[2] Batch [320-340]	Speed: 26721.23 samples/sec	accuracy=nan
2022-05-13 14:40:10,501 Node[0] Epoch[2] Batch [340-360]	Speed: 26716.54 samples/sec	accuracy=nan
2022-05-13 14:40:12,941 Node[0] Epoch[2] Batch [360-380]	Speed: 26749.55 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652470814407, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 3}}
2022-05-13 14:40:14,408 Node[0] Epoch[2] Time cost=47.993
:::MLLOG {"namespace": "", "time_ms": 1652470814408, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26694.75173872943}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 3}}
:::MLLOG {"namespace": "", "time_ms": 1652470814408, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26694.75173872943, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
/usr/local/lib/python3.8/dist-packages/nvidia/dali/plugin/mxnet.py:89: Warning: Please do not use `fill_last_batch` and use `last_batch_policy` instead.
  _DaliBaseIterator.__init__(self,
2022-05-13 14:40:14,524 Node[2] DALI iterator does not support resetting while epoch is not finished. Ignoring...
/usr/local/lib/python3.8/dist-packages/nvidia/dali/plugin/mxnet.py:89: Warning: Please do not use `fill_last_batch` and use `last_batch_policy` instead.
  _DaliBaseIterator.__init__(self,
2022-05-13 14:40:14,524 Node[4] DALI iterator does not support resetting while epoch is not finished. Ignoring...
/usr/local/lib/python3.8/dist-packages/nvidia/dali/plugin/mxnet.py:89: Warning: Please do not use `fill_last_batch` and use `last_batch_policy` instead.
  _DaliBaseIterator.__init__(self,
2022-05-13 14:40:14,524 Node[7] DALI iterator does not support resetting while epoch is not finished. Ignoring...
/usr/local/lib/python3.8/dist-packages/nvidia/dali/plugin/mxnet.py:89: Warning: Please do not use `fill_last_batch` and use `last_batch_policy` instead.
  _DaliBaseIterator.__init__(self,
2022-05-13 14:40:14,524 Node[5] DALI iterator does not support resetting while epoch is not finished. Ignoring...
/usr/local/lib/python3.8/dist-packages/nvidia/dali/plugin/mxnet.py:89: Warning: Please do not use `fill_last_batch` and use `last_batch_policy` instead.
  _DaliBaseIterator.__init__(self,
2022-05-13 14:40:14,524 Node[6] DALI iterator does not support resetting while epoch is not finished. Ignoring...
:::MLLOG {"namespace": "", "time_ms": 1652470814524, "event_type": "INTERVAL_START", "key": "eval_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1027, "epoch_num": 3}}
2022-05-13 14:40:14,525 Node[0] DALI iterator does not support resetting while epoch is not finished. Ignoring...
/usr/local/lib/python3.8/dist-packages/nvidia/dali/plugin/mxnet.py:89: Warning: Please do not use `fill_last_batch` and use `last_batch_policy` instead.
  _DaliBaseIterator.__init__(self,
2022-05-13 14:40:14,524 Node[3] DALI iterator does not support resetting while epoch is not finished. Ignoring...
/usr/local/lib/python3.8/dist-packages/nvidia/dali/plugin/mxnet.py:89: Warning: Please do not use `fill_last_batch` and use `last_batch_policy` instead.
  _DaliBaseIterator.__init__(self,
2022-05-13 14:40:14,525 Node[1] DALI iterator does not support resetting while epoch is not finished. Ignoring...
2022-05-13 14:40:16,978 Node[0] Epoch[2] Validation-accuracy=0.311040
2022-05-13 14:40:16,979 Node[0] Epoch[2] Validation-correct-count=1944.000000
2022-05-13 14:40:16,979 Node[0] Epoch[2] Validation-total-count=6250.000000
:::MLLOG {"namespace": "", "time_ms": 1652470817006, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1050, "epoch_num": 3}}
:::MLLOG {"namespace": "", "time_ms": 1652470817006, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.31518, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1056, "epoch_num": 3}}
:::MLLOG {"namespace": "", "time_ms": 1652470817006, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1059, "first_epoch_num": 1}}
:::MLLOG {"namespace": "", "time_ms": 1652470817006, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1075, "first_epoch_num": 4, "epoch_count": 4}}
:::MLLOG {"namespace": "", "time_ms": 1652470817007, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 4}}
2022-05-13 14:40:19,477 Node[0] Epoch[3] Batch [0-20]	Speed: 26517.86 samples/sec	accuracy=nan
2022-05-13 14:40:21,916 Node[0] Epoch[3] Batch [20-40]	Speed: 26756.82 samples/sec	accuracy=nan
2022-05-13 14:40:24,364 Node[0] Epoch[3] Batch [40-60]	Speed: 26675.58 samples/sec	accuracy=nan
2022-05-13 14:40:26,806 Node[0] Epoch[3] Batch [60-80]	Speed: 26730.74 samples/sec	accuracy=nan
2022-05-13 14:40:29,250 Node[0] Epoch[3] Batch [80-100]	Speed: 26705.74 samples/sec	accuracy=nan
2022-05-13 14:40:31,691 Node[0] Epoch[3] Batch [100-120]	Speed: 26751.09 samples/sec	accuracy=nan
2022-05-13 14:40:34,133 Node[0] Epoch[3] Batch [120-140]	Speed: 26724.60 samples/sec	accuracy=nan
2022-05-13 14:40:36,577 Node[0] Epoch[3] Batch [140-160]	Speed: 26710.00 samples/sec	accuracy=nan
2022-05-13 14:40:39,021 Node[0] Epoch[3] Batch [160-180]	Speed: 26712.61 samples/sec	accuracy=nan
2022-05-13 14:40:41,466 Node[0] Epoch[3] Batch [180-200]	Speed: 26699.10 samples/sec	accuracy=nan
2022-05-13 14:40:43,909 Node[0] Epoch[3] Batch [200-220]	Speed: 26716.88 samples/sec	accuracy=nan
2022-05-13 14:40:46,350 Node[0] Epoch[3] Batch [220-240]	Speed: 26742.79 samples/sec	accuracy=nan
2022-05-13 14:40:48,791 Node[0] Epoch[3] Batch [240-260]	Speed: 26748.48 samples/sec	accuracy=nan
2022-05-13 14:40:51,232 Node[0] Epoch[3] Batch [260-280]	Speed: 26741.99 samples/sec	accuracy=nan
2022-05-13 14:40:53,672 Node[0] Epoch[3] Batch [280-300]	Speed: 26752.23 samples/sec	accuracy=nan
2022-05-13 14:40:56,118 Node[0] Epoch[3] Batch [300-320]	Speed: 26687.69 samples/sec	accuracy=nan
2022-05-13 14:40:58,559 Node[0] Epoch[3] Batch [320-340]	Speed: 26746.33 samples/sec	accuracy=nan
2022-05-13 14:41:01,002 Node[0] Epoch[3] Batch [340-360]	Speed: 26721.96 samples/sec	accuracy=nan
2022-05-13 14:41:03,442 Node[0] Epoch[3] Batch [360-380]	Speed: 26758.80 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652470864906, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 4}}
2022-05-13 14:41:04,907 Node[0] Epoch[3] Time cost=47.900
:::MLLOG {"namespace": "", "time_ms": 1652470864907, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26746.71325667066}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 4}}
:::MLLOG {"namespace": "", "time_ms": 1652470864907, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26746.71325667066, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652470864907, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 5}}
2022-05-13 14:41:07,472 Node[0] Epoch[4] Batch [0-20]	Speed: 26716.22 samples/sec	accuracy=nan
2022-05-13 14:41:09,911 Node[0] Epoch[4] Batch [20-40]	Speed: 26763.40 samples/sec	accuracy=nan
2022-05-13 14:41:12,351 Node[0] Epoch[4] Batch [40-60]	Speed: 26757.06 samples/sec	accuracy=nan
2022-05-13 14:41:14,792 Node[0] Epoch[4] Batch [60-80]	Speed: 26742.32 samples/sec	accuracy=nan
2022-05-13 14:41:17,234 Node[0] Epoch[4] Batch [80-100]	Speed: 26733.41 samples/sec	accuracy=nan
2022-05-13 14:41:19,678 Node[0] Epoch[4] Batch [100-120]	Speed: 26716.84 samples/sec	accuracy=nan
2022-05-13 14:41:22,119 Node[0] Epoch[4] Batch [120-140]	Speed: 26739.95 samples/sec	accuracy=nan
2022-05-13 14:41:24,560 Node[0] Epoch[4] Batch [140-160]	Speed: 26737.37 samples/sec	accuracy=nan
2022-05-13 14:41:27,010 Node[0] Epoch[4] Batch [160-180]	Speed: 26644.46 samples/sec	accuracy=nan
2022-05-13 14:41:29,451 Node[0] Epoch[4] Batch [180-200]	Speed: 26752.90 samples/sec	accuracy=nan
2022-05-13 14:41:31,895 Node[0] Epoch[4] Batch [200-220]	Speed: 26707.05 samples/sec	accuracy=nan
2022-05-13 14:41:34,335 Node[0] Epoch[4] Batch [220-240]	Speed: 26748.57 samples/sec	accuracy=nan
2022-05-13 14:41:36,777 Node[0] Epoch[4] Batch [240-260]	Speed: 26736.24 samples/sec	accuracy=nan
2022-05-13 14:41:39,220 Node[0] Epoch[4] Batch [260-280]	Speed: 26724.23 samples/sec	accuracy=nan
2022-05-13 14:41:41,662 Node[0] Epoch[4] Batch [280-300]	Speed: 26730.91 samples/sec	accuracy=nan
2022-05-13 14:41:44,105 Node[0] Epoch[4] Batch [300-320]	Speed: 26718.86 samples/sec	accuracy=nan
2022-05-13 14:41:46,545 Node[0] Epoch[4] Batch [320-340]	Speed: 26756.57 samples/sec	accuracy=nan
2022-05-13 14:41:48,985 Node[0] Epoch[4] Batch [340-360]	Speed: 26754.36 samples/sec	accuracy=nan
2022-05-13 14:41:51,428 Node[0] Epoch[4] Batch [360-380]	Speed: 26716.63 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652470912898, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 5}}
2022-05-13 14:41:52,899 Node[0] Epoch[4] Time cost=47.991
:::MLLOG {"namespace": "", "time_ms": 1652470912899, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26695.78669076294}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 5}}
:::MLLOG {"namespace": "", "time_ms": 1652470912899, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26695.78669076294, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652470912899, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 6}}
2022-05-13 14:41:55,462 Node[0] Epoch[5] Batch [0-20]	Speed: 26741.70 samples/sec	accuracy=nan
2022-05-13 14:41:57,903 Node[0] Epoch[5] Batch [20-40]	Speed: 26740.80 samples/sec	accuracy=nan
2022-05-13 14:42:00,347 Node[0] Epoch[5] Batch [40-60]	Speed: 26713.11 samples/sec	accuracy=nan
2022-05-13 14:42:02,790 Node[0] Epoch[5] Batch [60-80]	Speed: 26717.71 samples/sec	accuracy=nan
2022-05-13 14:42:05,230 Node[0] Epoch[5] Batch [80-100]	Speed: 26756.23 samples/sec	accuracy=nan
2022-05-13 14:42:07,672 Node[0] Epoch[5] Batch [100-120]	Speed: 26737.91 samples/sec	accuracy=nan
2022-05-13 14:42:10,112 Node[0] Epoch[5] Batch [120-140]	Speed: 26747.50 samples/sec	accuracy=nan
2022-05-13 14:42:12,553 Node[0] Epoch[5] Batch [140-160]	Speed: 26745.88 samples/sec	accuracy=nan
2022-05-13 14:42:14,998 Node[0] Epoch[5] Batch [160-180]	Speed: 26699.54 samples/sec	accuracy=nan
2022-05-13 14:42:17,437 Node[0] Epoch[5] Batch [180-200]	Speed: 26763.72 samples/sec	accuracy=nan
2022-05-13 14:42:19,879 Node[0] Epoch[5] Batch [200-220]	Speed: 26733.84 samples/sec	accuracy=nan
2022-05-13 14:42:22,320 Node[0] Epoch[5] Batch [220-240]	Speed: 26740.44 samples/sec	accuracy=nan
2022-05-13 14:42:24,763 Node[0] Epoch[5] Batch [240-260]	Speed: 26724.54 samples/sec	accuracy=nan
2022-05-13 14:42:27,202 Node[0] Epoch[5] Batch [260-280]	Speed: 26767.23 samples/sec	accuracy=nan
2022-05-13 14:42:29,641 Node[0] Epoch[5] Batch [280-300]	Speed: 26764.14 samples/sec	accuracy=nan
2022-05-13 14:42:32,086 Node[0] Epoch[5] Batch [300-320]	Speed: 26701.49 samples/sec	accuracy=nan
2022-05-13 14:42:34,532 Node[0] Epoch[5] Batch [320-340]	Speed: 26685.23 samples/sec	accuracy=nan
2022-05-13 14:42:36,974 Node[0] Epoch[5] Batch [340-360]	Speed: 26729.47 samples/sec	accuracy=nan
2022-05-13 14:42:39,416 Node[0] Epoch[5] Batch [360-380]	Speed: 26735.02 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652470960880, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 6}}
2022-05-13 14:42:40,882 Node[0] Epoch[5] Time cost=47.982
:::MLLOG {"namespace": "", "time_ms": 1652470960882, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26700.82785807421}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 6}}
:::MLLOG {"namespace": "", "time_ms": 1652470960882, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26700.82785807421, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652470960882, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 7}}
2022-05-13 14:42:43,449 Node[0] Epoch[6] Batch [0-20]	Speed: 26707.79 samples/sec	accuracy=nan
2022-05-13 14:42:45,893 Node[0] Epoch[6] Batch [20-40]	Speed: 26708.58 samples/sec	accuracy=nan
2022-05-13 14:42:48,336 Node[0] Epoch[6] Batch [40-60]	Speed: 26720.90 samples/sec	accuracy=nan
2022-05-13 14:42:50,780 Node[0] Epoch[6] Batch [60-80]	Speed: 26720.20 samples/sec	accuracy=nan
2022-05-13 14:42:53,221 Node[0] Epoch[6] Batch [80-100]	Speed: 26737.37 samples/sec	accuracy=nan
2022-05-13 14:42:55,663 Node[0] Epoch[6] Batch [100-120]	Speed: 26737.64 samples/sec	accuracy=nan
2022-05-13 14:42:58,104 Node[0] Epoch[6] Batch [120-140]	Speed: 26739.12 samples/sec	accuracy=nan
2022-05-13 14:43:00,547 Node[0] Epoch[6] Batch [140-160]	Speed: 26724.44 samples/sec	accuracy=nan
2022-05-13 14:43:02,995 Node[0] Epoch[6] Batch [160-180]	Speed: 26661.80 samples/sec	accuracy=nan
2022-05-13 14:43:05,435 Node[0] Epoch[6] Batch [180-200]	Speed: 26755.29 samples/sec	accuracy=nan
2022-05-13 14:43:07,878 Node[0] Epoch[6] Batch [200-220]	Speed: 26725.69 samples/sec	accuracy=nan
2022-05-13 14:43:10,319 Node[0] Epoch[6] Batch [220-240]	Speed: 26736.14 samples/sec	accuracy=nan
2022-05-13 14:43:12,758 Node[0] Epoch[6] Batch [240-260]	Speed: 26769.26 samples/sec	accuracy=nan
2022-05-13 14:43:15,202 Node[0] Epoch[6] Batch [260-280]	Speed: 26711.28 samples/sec	accuracy=nan
2022-05-13 14:43:17,644 Node[0] Epoch[6] Batch [280-300]	Speed: 26731.66 samples/sec	accuracy=nan
2022-05-13 14:43:20,084 Node[0] Epoch[6] Batch [300-320]	Speed: 26756.87 samples/sec	accuracy=nan
2022-05-13 14:43:22,523 Node[0] Epoch[6] Batch [320-340]	Speed: 26755.81 samples/sec	accuracy=nan
2022-05-13 14:43:24,964 Node[0] Epoch[6] Batch [340-360]	Speed: 26750.27 samples/sec	accuracy=nan
2022-05-13 14:43:27,406 Node[0] Epoch[6] Batch [360-380]	Speed: 26729.37 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471008869, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 7}}
2022-05-13 14:43:28,870 Node[0] Epoch[6] Time cost=47.988
:::MLLOG {"namespace": "", "time_ms": 1652471008870, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26697.848479037795}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 7}}
:::MLLOG {"namespace": "", "time_ms": 1652471008870, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26697.848479037795, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471008985, "event_type": "INTERVAL_START", "key": "eval_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1027, "epoch_num": 7}}
2022-05-13 14:43:30,704 Node[0] Epoch[6] Validation-accuracy=0.442880
2022-05-13 14:43:30,705 Node[0] Epoch[6] Validation-correct-count=2768.000000
2022-05-13 14:43:30,705 Node[0] Epoch[6] Validation-total-count=6250.000000
:::MLLOG {"namespace": "", "time_ms": 1652471010705, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1050, "epoch_num": 7}}
:::MLLOG {"namespace": "", "time_ms": 1652471010705, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.44578, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1056, "epoch_num": 7}}
:::MLLOG {"namespace": "", "time_ms": 1652471010705, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1059, "first_epoch_num": 4}}
:::MLLOG {"namespace": "", "time_ms": 1652471010705, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1075, "first_epoch_num": 8, "epoch_count": 4}}
:::MLLOG {"namespace": "", "time_ms": 1652471010706, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 8}}
2022-05-13 14:43:33,175 Node[0] Epoch[7] Batch [0-20]	Speed: 26524.55 samples/sec	accuracy=nan
2022-05-13 14:43:35,614 Node[0] Epoch[7] Batch [20-40]	Speed: 26769.58 samples/sec	accuracy=nan
2022-05-13 14:43:38,052 Node[0] Epoch[7] Batch [40-60]	Speed: 26772.96 samples/sec	accuracy=nan
2022-05-13 14:43:40,493 Node[0] Epoch[7] Batch [60-80]	Speed: 26750.13 samples/sec	accuracy=nan
2022-05-13 14:43:42,931 Node[0] Epoch[7] Batch [80-100]	Speed: 26773.90 samples/sec	accuracy=nan
2022-05-13 14:43:45,371 Node[0] Epoch[7] Batch [100-120]	Speed: 26753.05 samples/sec	accuracy=nan
2022-05-13 14:43:47,813 Node[0] Epoch[7] Batch [120-140]	Speed: 26732.29 samples/sec	accuracy=nan
2022-05-13 14:43:50,256 Node[0] Epoch[7] Batch [140-160]	Speed: 26721.15 samples/sec	accuracy=nan
2022-05-13 14:43:52,699 Node[0] Epoch[7] Batch [160-180]	Speed: 26717.50 samples/sec	accuracy=nan
2022-05-13 14:43:55,139 Node[0] Epoch[7] Batch [180-200]	Speed: 26751.96 samples/sec	accuracy=nan
2022-05-13 14:43:57,582 Node[0] Epoch[7] Batch [200-220]	Speed: 26730.88 samples/sec	accuracy=nan
2022-05-13 14:44:00,021 Node[0] Epoch[7] Batch [220-240]	Speed: 26764.46 samples/sec	accuracy=nan
2022-05-13 14:44:02,458 Node[0] Epoch[7] Batch [240-260]	Speed: 26779.65 samples/sec	accuracy=nan
2022-05-13 14:44:04,901 Node[0] Epoch[7] Batch [260-280]	Speed: 26724.11 samples/sec	accuracy=nan
2022-05-13 14:44:07,342 Node[0] Epoch[7] Batch [280-300]	Speed: 26746.58 samples/sec	accuracy=nan
2022-05-13 14:44:09,784 Node[0] Epoch[7] Batch [300-320]	Speed: 26727.27 samples/sec	accuracy=nan
2022-05-13 14:44:12,225 Node[0] Epoch[7] Batch [320-340]	Speed: 26741.28 samples/sec	accuracy=nan
2022-05-13 14:44:14,668 Node[0] Epoch[7] Batch [340-360]	Speed: 26720.82 samples/sec	accuracy=nan
2022-05-13 14:44:17,110 Node[0] Epoch[7] Batch [360-380]	Speed: 26741.37 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471058572, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 8}}
2022-05-13 14:44:18,573 Node[0] Epoch[7] Time cost=47.868
:::MLLOG {"namespace": "", "time_ms": 1652471058573, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26764.798376246163}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 8}}
:::MLLOG {"namespace": "", "time_ms": 1652471058574, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26764.798376246163, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471058574, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 9}}
2022-05-13 14:44:21,135 Node[0] Epoch[8] Batch [0-20]	Speed: 26758.19 samples/sec	accuracy=nan
2022-05-13 14:44:23,579 Node[0] Epoch[8] Batch [20-40]	Speed: 26711.31 samples/sec	accuracy=nan
2022-05-13 14:44:26,022 Node[0] Epoch[8] Batch [40-60]	Speed: 26721.65 samples/sec	accuracy=nan
2022-05-13 14:44:28,466 Node[0] Epoch[8] Batch [60-80]	Speed: 26707.86 samples/sec	accuracy=nan
2022-05-13 14:44:30,907 Node[0] Epoch[8] Batch [80-100]	Speed: 26749.74 samples/sec	accuracy=nan
2022-05-13 14:44:33,345 Node[0] Epoch[8] Batch [100-120]	Speed: 26768.62 samples/sec	accuracy=nan
2022-05-13 14:44:35,785 Node[0] Epoch[8] Batch [120-140]	Speed: 26754.32 samples/sec	accuracy=nan
2022-05-13 14:44:38,225 Node[0] Epoch[8] Batch [140-160]	Speed: 26755.66 samples/sec	accuracy=nan
2022-05-13 14:44:40,668 Node[0] Epoch[8] Batch [160-180]	Speed: 26720.99 samples/sec	accuracy=nan
2022-05-13 14:44:43,108 Node[0] Epoch[8] Batch [180-200]	Speed: 26755.66 samples/sec	accuracy=nan
2022-05-13 14:44:45,553 Node[0] Epoch[8] Batch [200-220]	Speed: 26696.13 samples/sec	accuracy=nan
2022-05-13 14:44:47,994 Node[0] Epoch[8] Batch [220-240]	Speed: 26748.30 samples/sec	accuracy=nan
2022-05-13 14:44:50,432 Node[0] Epoch[8] Batch [240-260]	Speed: 26777.46 samples/sec	accuracy=nan
2022-05-13 14:44:52,873 Node[0] Epoch[8] Batch [260-280]	Speed: 26734.36 samples/sec	accuracy=nan
2022-05-13 14:44:55,314 Node[0] Epoch[8] Batch [280-300]	Speed: 26752.81 samples/sec	accuracy=nan
2022-05-13 14:44:57,761 Node[0] Epoch[8] Batch [300-320]	Speed: 26674.92 samples/sec	accuracy=nan
2022-05-13 14:45:00,203 Node[0] Epoch[8] Batch [320-340]	Speed: 26728.47 samples/sec	accuracy=nan
2022-05-13 14:45:02,644 Node[0] Epoch[8] Batch [340-360]	Speed: 26745.35 samples/sec	accuracy=nan
2022-05-13 14:45:05,082 Node[0] Epoch[8] Batch [360-380]	Speed: 26769.71 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471106550, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 9}}
2022-05-13 14:45:06,551 Node[0] Epoch[8] Time cost=47.977
:::MLLOG {"namespace": "", "time_ms": 1652471106551, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26703.55457453535}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 9}}
:::MLLOG {"namespace": "", "time_ms": 1652471106552, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26703.55457453535, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471106552, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 10}}
2022-05-13 14:45:09,115 Node[0] Epoch[9] Batch [0-20]	Speed: 26742.04 samples/sec	accuracy=nan
2022-05-13 14:45:11,558 Node[0] Epoch[9] Batch [20-40]	Speed: 26723.27 samples/sec	accuracy=nan
2022-05-13 14:45:13,999 Node[0] Epoch[9] Batch [40-60]	Speed: 26745.53 samples/sec	accuracy=nan
2022-05-13 14:45:16,442 Node[0] Epoch[9] Batch [60-80]	Speed: 26721.23 samples/sec	accuracy=nan
2022-05-13 14:45:18,885 Node[0] Epoch[9] Batch [80-100]	Speed: 26723.79 samples/sec	accuracy=nan
2022-05-13 14:45:21,325 Node[0] Epoch[9] Batch [100-120]	Speed: 26746.62 samples/sec	accuracy=nan
2022-05-13 14:45:23,766 Node[0] Epoch[9] Batch [120-140]	Speed: 26741.65 samples/sec	accuracy=nan
2022-05-13 14:45:26,210 Node[0] Epoch[9] Batch [140-160]	Speed: 26713.28 samples/sec	accuracy=nan
2022-05-13 14:45:28,655 Node[0] Epoch[9] Batch [160-180]	Speed: 26704.45 samples/sec	accuracy=nan
2022-05-13 14:45:31,096 Node[0] Epoch[9] Batch [180-200]	Speed: 26738.82 samples/sec	accuracy=nan
2022-05-13 14:45:33,537 Node[0] Epoch[9] Batch [200-220]	Speed: 26740.87 samples/sec	accuracy=nan
2022-05-13 14:45:35,981 Node[0] Epoch[9] Batch [220-240]	Speed: 26713.97 samples/sec	accuracy=nan
2022-05-13 14:45:38,423 Node[0] Epoch[9] Batch [240-260]	Speed: 26729.20 samples/sec	accuracy=nan
2022-05-13 14:45:40,868 Node[0] Epoch[9] Batch [260-280]	Speed: 26705.91 samples/sec	accuracy=nan
2022-05-13 14:45:43,309 Node[0] Epoch[9] Batch [280-300]	Speed: 26739.08 samples/sec	accuracy=nan
2022-05-13 14:45:45,752 Node[0] Epoch[9] Batch [300-320]	Speed: 26723.92 samples/sec	accuracy=nan
2022-05-13 14:45:48,192 Node[0] Epoch[9] Batch [320-340]	Speed: 26757.80 samples/sec	accuracy=nan
2022-05-13 14:45:50,638 Node[0] Epoch[9] Batch [340-360]	Speed: 26682.11 samples/sec	accuracy=nan
2022-05-13 14:45:53,078 Node[0] Epoch[9] Batch [360-380]	Speed: 26750.09 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471154542, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 10}}
2022-05-13 14:45:54,543 Node[0] Epoch[9] Time cost=47.991
:::MLLOG {"namespace": "", "time_ms": 1652471154543, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26696.14385006237}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 10}}
:::MLLOG {"namespace": "", "time_ms": 1652471154543, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26696.14385006237, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471154543, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 11}}
2022-05-13 14:45:57,109 Node[0] Epoch[10] Batch [0-20]	Speed: 26701.51 samples/sec	accuracy=nan
2022-05-13 14:45:59,553 Node[0] Epoch[10] Batch [20-40]	Speed: 26713.84 samples/sec	accuracy=nan
2022-05-13 14:46:01,997 Node[0] Epoch[10] Batch [40-60]	Speed: 26709.17 samples/sec	accuracy=nan
2022-05-13 14:46:04,439 Node[0] Epoch[10] Batch [60-80]	Speed: 26737.69 samples/sec	accuracy=nan
2022-05-13 14:46:06,881 Node[0] Epoch[10] Batch [80-100]	Speed: 26727.37 samples/sec	accuracy=nan
2022-05-13 14:46:09,323 Node[0] Epoch[10] Batch [100-120]	Speed: 26730.57 samples/sec	accuracy=nan
2022-05-13 14:46:11,766 Node[0] Epoch[10] Batch [120-140]	Speed: 26723.19 samples/sec	accuracy=nan
2022-05-13 14:46:14,208 Node[0] Epoch[10] Batch [140-160]	Speed: 26735.26 samples/sec	accuracy=nan
2022-05-13 14:46:16,653 Node[0] Epoch[10] Batch [160-180]	Speed: 26700.15 samples/sec	accuracy=nan
2022-05-13 14:46:19,096 Node[0] Epoch[10] Batch [180-200]	Speed: 26724.21 samples/sec	accuracy=nan
2022-05-13 14:46:21,538 Node[0] Epoch[10] Batch [200-220]	Speed: 26723.29 samples/sec	accuracy=nan
2022-05-13 14:46:23,979 Node[0] Epoch[10] Batch [220-240]	Speed: 26745.43 samples/sec	accuracy=nan
2022-05-13 14:46:26,421 Node[0] Epoch[10] Batch [240-260]	Speed: 26729.94 samples/sec	accuracy=nan
2022-05-13 14:46:28,863 Node[0] Epoch[10] Batch [260-280]	Speed: 26732.27 samples/sec	accuracy=nan
2022-05-13 14:46:31,304 Node[0] Epoch[10] Batch [280-300]	Speed: 26745.18 samples/sec	accuracy=nan
2022-05-13 14:46:33,750 Node[0] Epoch[10] Batch [300-320]	Speed: 26695.42 samples/sec	accuracy=nan
2022-05-13 14:46:36,191 Node[0] Epoch[10] Batch [320-340]	Speed: 26736.71 samples/sec	accuracy=nan
2022-05-13 14:46:38,632 Node[0] Epoch[10] Batch [340-360]	Speed: 26738.91 samples/sec	accuracy=nan
2022-05-13 14:46:41,075 Node[0] Epoch[10] Batch [360-380]	Speed: 26726.24 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471202541, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 11}}
2022-05-13 14:46:42,542 Node[0] Epoch[10] Time cost=47.999
:::MLLOG {"namespace": "", "time_ms": 1652471202542, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26691.5971155075}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 11}}
:::MLLOG {"namespace": "", "time_ms": 1652471202542, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26691.5971155075, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471202658, "event_type": "INTERVAL_START", "key": "eval_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1027, "epoch_num": 11}}
2022-05-13 14:46:44,349 Node[0] Epoch[10] Validation-accuracy=0.539840
2022-05-13 14:46:44,350 Node[0] Epoch[10] Validation-correct-count=3374.000000
2022-05-13 14:46:44,350 Node[0] Epoch[10] Validation-total-count=6250.000000
:::MLLOG {"namespace": "", "time_ms": 1652471204354, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1050, "epoch_num": 11}}
:::MLLOG {"namespace": "", "time_ms": 1652471204355, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.54356, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1056, "epoch_num": 11}}
:::MLLOG {"namespace": "", "time_ms": 1652471204355, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1059, "first_epoch_num": 8}}
:::MLLOG {"namespace": "", "time_ms": 1652471204355, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1075, "first_epoch_num": 12, "epoch_count": 4}}
:::MLLOG {"namespace": "", "time_ms": 1652471204355, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 12}}
2022-05-13 14:46:46,827 Node[0] Epoch[11] Batch [0-20]	Speed: 26517.59 samples/sec	accuracy=nan
2022-05-13 14:46:49,270 Node[0] Epoch[11] Batch [20-40]	Speed: 26722.20 samples/sec	accuracy=nan
2022-05-13 14:46:51,711 Node[0] Epoch[11] Batch [40-60]	Speed: 26740.64 samples/sec	accuracy=nan
2022-05-13 14:46:54,154 Node[0] Epoch[11] Batch [60-80]	Speed: 26718.88 samples/sec	accuracy=nan
2022-05-13 14:46:56,592 Node[0] Epoch[11] Batch [80-100]	Speed: 26772.98 samples/sec	accuracy=nan
2022-05-13 14:46:59,036 Node[0] Epoch[11] Batch [100-120]	Speed: 26715.69 samples/sec	accuracy=nan
2022-05-13 14:47:01,477 Node[0] Epoch[11] Batch [120-140]	Speed: 26742.22 samples/sec	accuracy=nan
2022-05-13 14:47:03,916 Node[0] Epoch[11] Batch [140-160]	Speed: 26769.88 samples/sec	accuracy=nan
2022-05-13 14:47:06,358 Node[0] Epoch[11] Batch [160-180]	Speed: 26726.19 samples/sec	accuracy=nan
2022-05-13 14:47:08,799 Node[0] Epoch[11] Batch [180-200]	Speed: 26746.16 samples/sec	accuracy=nan
2022-05-13 14:47:11,241 Node[0] Epoch[11] Batch [200-220]	Speed: 26734.41 samples/sec	accuracy=nan
2022-05-13 14:47:13,681 Node[0] Epoch[11] Batch [220-240]	Speed: 26745.87 samples/sec	accuracy=nan
2022-05-13 14:47:16,123 Node[0] Epoch[11] Batch [240-260]	Speed: 26736.05 samples/sec	accuracy=nan
2022-05-13 14:47:18,565 Node[0] Epoch[11] Batch [260-280]	Speed: 26729.83 samples/sec	accuracy=nan
2022-05-13 14:47:21,007 Node[0] Epoch[11] Batch [280-300]	Speed: 26732.85 samples/sec	accuracy=nan
2022-05-13 14:47:23,450 Node[0] Epoch[11] Batch [300-320]	Speed: 26726.13 samples/sec	accuracy=nan
2022-05-13 14:47:25,893 Node[0] Epoch[11] Batch [320-340]	Speed: 26717.35 samples/sec	accuracy=nan
2022-05-13 14:47:28,333 Node[0] Epoch[11] Batch [340-360]	Speed: 26750.57 samples/sec	accuracy=nan
2022-05-13 14:47:30,775 Node[0] Epoch[11] Batch [360-380]	Speed: 26741.35 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471252239, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 12}}
2022-05-13 14:47:32,240 Node[0] Epoch[11] Time cost=47.885
:::MLLOG {"namespace": "", "time_ms": 1652471252240, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26755.26451880209}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 12}}
:::MLLOG {"namespace": "", "time_ms": 1652471252240, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26755.26451880209, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471252240, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 13}}
2022-05-13 14:47:34,804 Node[0] Epoch[12] Batch [0-20]	Speed: 26731.28 samples/sec	accuracy=nan
2022-05-13 14:47:37,246 Node[0] Epoch[12] Batch [20-40]	Speed: 26731.22 samples/sec	accuracy=nan
2022-05-13 14:47:39,686 Node[0] Epoch[12] Batch [40-60]	Speed: 26758.69 samples/sec	accuracy=nan
2022-05-13 14:47:42,129 Node[0] Epoch[12] Batch [60-80]	Speed: 26724.29 samples/sec	accuracy=nan
2022-05-13 14:47:44,568 Node[0] Epoch[12] Batch [80-100]	Speed: 26759.23 samples/sec	accuracy=nan
2022-05-13 14:47:47,009 Node[0] Epoch[12] Batch [100-120]	Speed: 26741.02 samples/sec	accuracy=nan
2022-05-13 14:47:49,448 Node[0] Epoch[12] Batch [120-140]	Speed: 26764.94 samples/sec	accuracy=nan
2022-05-13 14:47:51,891 Node[0] Epoch[12] Batch [140-160]	Speed: 26720.53 samples/sec	accuracy=nan
2022-05-13 14:47:54,335 Node[0] Epoch[12] Batch [160-180]	Speed: 26720.11 samples/sec	accuracy=nan
2022-05-13 14:47:56,776 Node[0] Epoch[12] Batch [180-200]	Speed: 26742.69 samples/sec	accuracy=nan
2022-05-13 14:47:59,217 Node[0] Epoch[12] Batch [200-220]	Speed: 26739.51 samples/sec	accuracy=nan
2022-05-13 14:48:01,656 Node[0] Epoch[12] Batch [220-240]	Speed: 26762.70 samples/sec	accuracy=nan
2022-05-13 14:48:04,097 Node[0] Epoch[12] Batch [240-260]	Speed: 26743.23 samples/sec	accuracy=nan
2022-05-13 14:48:06,537 Node[0] Epoch[12] Batch [260-280]	Speed: 26757.90 samples/sec	accuracy=nan
2022-05-13 14:48:08,977 Node[0] Epoch[12] Batch [280-300]	Speed: 26745.98 samples/sec	accuracy=nan
2022-05-13 14:48:11,418 Node[0] Epoch[12] Batch [300-320]	Speed: 26744.79 samples/sec	accuracy=nan
2022-05-13 14:48:13,858 Node[0] Epoch[12] Batch [320-340]	Speed: 26760.30 samples/sec	accuracy=nan
2022-05-13 14:48:16,300 Node[0] Epoch[12] Batch [340-360]	Speed: 26732.11 samples/sec	accuracy=nan
2022-05-13 14:48:18,741 Node[0] Epoch[12] Batch [360-380]	Speed: 26739.14 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471300209, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 13}}
2022-05-13 14:48:20,210 Node[0] Epoch[12] Time cost=47.970
:::MLLOG {"namespace": "", "time_ms": 1652471300210, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26707.923125471676}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 13}}
:::MLLOG {"namespace": "", "time_ms": 1652471300210, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26707.923125471676, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471300210, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 14}}
2022-05-13 14:48:22,778 Node[0] Epoch[13] Batch [0-20]	Speed: 26704.34 samples/sec	accuracy=nan
2022-05-13 14:48:25,218 Node[0] Epoch[13] Batch [20-40]	Speed: 26748.90 samples/sec	accuracy=nan
2022-05-13 14:48:27,662 Node[0] Epoch[13] Batch [40-60]	Speed: 26715.17 samples/sec	accuracy=nan
2022-05-13 14:48:30,106 Node[0] Epoch[13] Batch [60-80]	Speed: 26705.86 samples/sec	accuracy=nan
2022-05-13 14:48:32,548 Node[0] Epoch[13] Batch [80-100]	Speed: 26734.37 samples/sec	accuracy=nan
2022-05-13 14:48:34,991 Node[0] Epoch[13] Batch [100-120]	Speed: 26718.38 samples/sec	accuracy=nan
2022-05-13 14:48:37,433 Node[0] Epoch[13] Batch [120-140]	Speed: 26727.01 samples/sec	accuracy=nan
2022-05-13 14:48:39,873 Node[0] Epoch[13] Batch [140-160]	Speed: 26755.29 samples/sec	accuracy=nan
2022-05-13 14:48:42,316 Node[0] Epoch[13] Batch [160-180]	Speed: 26725.11 samples/sec	accuracy=nan
2022-05-13 14:48:44,758 Node[0] Epoch[13] Batch [180-200]	Speed: 26736.01 samples/sec	accuracy=nan
2022-05-13 14:48:47,201 Node[0] Epoch[13] Batch [200-220]	Speed: 26717.91 samples/sec	accuracy=nan
2022-05-13 14:48:49,643 Node[0] Epoch[13] Batch [220-240]	Speed: 26728.86 samples/sec	accuracy=nan
2022-05-13 14:48:52,086 Node[0] Epoch[13] Batch [240-260]	Speed: 26720.02 samples/sec	accuracy=nan
2022-05-13 14:48:54,530 Node[0] Epoch[13] Batch [260-280]	Speed: 26716.43 samples/sec	accuracy=nan
2022-05-13 14:48:56,972 Node[0] Epoch[13] Batch [280-300]	Speed: 26726.80 samples/sec	accuracy=nan
2022-05-13 14:48:59,414 Node[0] Epoch[13] Batch [300-320]	Speed: 26739.30 samples/sec	accuracy=nan
2022-05-13 14:49:01,858 Node[0] Epoch[13] Batch [320-340]	Speed: 26712.94 samples/sec	accuracy=nan
2022-05-13 14:49:04,302 Node[0] Epoch[13] Batch [340-360]	Speed: 26700.85 samples/sec	accuracy=nan
2022-05-13 14:49:06,746 Node[0] Epoch[13] Batch [360-380]	Speed: 26714.39 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471348215, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 14}}
2022-05-13 14:49:08,216 Node[0] Epoch[13] Time cost=48.005
:::MLLOG {"namespace": "", "time_ms": 1652471348216, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26688.01643252737}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 14}}
:::MLLOG {"namespace": "", "time_ms": 1652471348216, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26688.01643252737, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471348216, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 15}}
2022-05-13 14:49:10,780 Node[0] Epoch[14] Batch [0-20]	Speed: 26731.44 samples/sec	accuracy=nan
2022-05-13 14:49:13,225 Node[0] Epoch[14] Batch [20-40]	Speed: 26697.18 samples/sec	accuracy=nan
2022-05-13 14:49:15,669 Node[0] Epoch[14] Batch [40-60]	Speed: 26706.57 samples/sec	accuracy=nan
2022-05-13 14:49:18,111 Node[0] Epoch[14] Batch [60-80]	Speed: 26736.18 samples/sec	accuracy=nan
2022-05-13 14:49:20,555 Node[0] Epoch[14] Batch [80-100]	Speed: 26711.34 samples/sec	accuracy=nan
2022-05-13 14:49:22,998 Node[0] Epoch[14] Batch [100-120]	Speed: 26720.22 samples/sec	accuracy=nan
2022-05-13 14:49:25,440 Node[0] Epoch[14] Batch [120-140]	Speed: 26727.82 samples/sec	accuracy=nan
2022-05-13 14:49:27,885 Node[0] Epoch[14] Batch [140-160]	Speed: 26699.12 samples/sec	accuracy=nan
2022-05-13 14:49:30,332 Node[0] Epoch[14] Batch [160-180]	Speed: 26686.63 samples/sec	accuracy=nan
2022-05-13 14:49:32,775 Node[0] Epoch[14] Batch [180-200]	Speed: 26711.72 samples/sec	accuracy=nan
2022-05-13 14:49:35,221 Node[0] Epoch[14] Batch [200-220]	Speed: 26697.86 samples/sec	accuracy=nan
2022-05-13 14:49:37,662 Node[0] Epoch[14] Batch [220-240]	Speed: 26736.89 samples/sec	accuracy=nan
2022-05-13 14:49:40,106 Node[0] Epoch[14] Batch [240-260]	Speed: 26713.15 samples/sec	accuracy=nan
2022-05-13 14:49:42,550 Node[0] Epoch[14] Batch [260-280]	Speed: 26714.10 samples/sec	accuracy=nan
2022-05-13 14:49:44,993 Node[0] Epoch[14] Batch [280-300]	Speed: 26713.69 samples/sec	accuracy=nan
2022-05-13 14:49:47,433 Node[0] Epoch[14] Batch [300-320]	Speed: 26755.65 samples/sec	accuracy=nan
2022-05-13 14:49:49,875 Node[0] Epoch[14] Batch [320-340]	Speed: 26730.98 samples/sec	accuracy=nan
2022-05-13 14:49:52,319 Node[0] Epoch[14] Batch [340-360]	Speed: 26710.71 samples/sec	accuracy=nan
2022-05-13 14:49:54,761 Node[0] Epoch[14] Batch [360-380]	Speed: 26730.52 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471396226, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 15}}
2022-05-13 14:49:56,227 Node[0] Epoch[14] Time cost=48.010
:::MLLOG {"namespace": "", "time_ms": 1652471396227, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26685.227158915062}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 15}}
:::MLLOG {"namespace": "", "time_ms": 1652471396227, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26685.227158915062, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471396342, "event_type": "INTERVAL_START", "key": "eval_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1027, "epoch_num": 15}}
2022-05-13 14:49:58,013 Node[0] Epoch[14] Validation-accuracy=0.611360
2022-05-13 14:49:58,013 Node[0] Epoch[14] Validation-correct-count=3821.000000
2022-05-13 14:49:58,013 Node[0] Epoch[14] Validation-total-count=6250.000000
:::MLLOG {"namespace": "", "time_ms": 1652471398054, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1050, "epoch_num": 15}}
:::MLLOG {"namespace": "", "time_ms": 1652471398054, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.60662, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1056, "epoch_num": 15}}
:::MLLOG {"namespace": "", "time_ms": 1652471398054, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1059, "first_epoch_num": 12}}
:::MLLOG {"namespace": "", "time_ms": 1652471398054, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1075, "first_epoch_num": 16, "epoch_count": 4}}
:::MLLOG {"namespace": "", "time_ms": 1652471398054, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 16}}
2022-05-13 14:50:00,522 Node[0] Epoch[15] Batch [0-20]	Speed: 26558.63 samples/sec	accuracy=nan
2022-05-13 14:50:02,962 Node[0] Epoch[15] Batch [20-40]	Speed: 26754.15 samples/sec	accuracy=nan
2022-05-13 14:50:05,401 Node[0] Epoch[15] Batch [40-60]	Speed: 26767.36 samples/sec	accuracy=nan
2022-05-13 14:50:07,846 Node[0] Epoch[15] Batch [60-80]	Speed: 26703.66 samples/sec	accuracy=nan
2022-05-13 14:50:10,287 Node[0] Epoch[15] Batch [80-100]	Speed: 26737.52 samples/sec	accuracy=nan
2022-05-13 14:50:12,732 Node[0] Epoch[15] Batch [100-120]	Speed: 26702.12 samples/sec	accuracy=nan
2022-05-13 14:50:15,177 Node[0] Epoch[15] Batch [120-140]	Speed: 26697.87 samples/sec	accuracy=nan
2022-05-13 14:50:17,618 Node[0] Epoch[15] Batch [140-160]	Speed: 26743.03 samples/sec	accuracy=nan
2022-05-13 14:50:20,060 Node[0] Epoch[15] Batch [160-180]	Speed: 26734.95 samples/sec	accuracy=nan
2022-05-13 14:50:22,504 Node[0] Epoch[15] Batch [180-200]	Speed: 26710.53 samples/sec	accuracy=nan
2022-05-13 14:50:24,946 Node[0] Epoch[15] Batch [200-220]	Speed: 26727.07 samples/sec	accuracy=nan
2022-05-13 14:50:27,390 Node[0] Epoch[15] Batch [220-240]	Speed: 26716.18 samples/sec	accuracy=nan
2022-05-13 14:50:29,831 Node[0] Epoch[15] Batch [240-260]	Speed: 26733.69 samples/sec	accuracy=nan
2022-05-13 14:50:32,276 Node[0] Epoch[15] Batch [260-280]	Speed: 26702.43 samples/sec	accuracy=nan
2022-05-13 14:50:34,713 Node[0] Epoch[15] Batch [280-300]	Speed: 26788.31 samples/sec	accuracy=nan
2022-05-13 14:50:37,158 Node[0] Epoch[15] Batch [300-320]	Speed: 26698.36 samples/sec	accuracy=nan
2022-05-13 14:50:39,599 Node[0] Epoch[15] Batch [320-340]	Speed: 26741.29 samples/sec	accuracy=nan
2022-05-13 14:50:42,044 Node[0] Epoch[15] Batch [340-360]	Speed: 26702.46 samples/sec	accuracy=nan
2022-05-13 14:50:44,484 Node[0] Epoch[15] Batch [360-380]	Speed: 26750.37 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471445948, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 16}}
2022-05-13 14:50:45,949 Node[0] Epoch[15] Time cost=47.895
:::MLLOG {"namespace": "", "time_ms": 1652471445950, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26749.47332167822}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 16}}
:::MLLOG {"namespace": "", "time_ms": 1652471445950, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26749.47332167822, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471445950, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 17}}
2022-05-13 14:50:48,511 Node[0] Epoch[16] Batch [0-20]	Speed: 26751.06 samples/sec	accuracy=nan
2022-05-13 14:50:50,954 Node[0] Epoch[16] Batch [20-40]	Speed: 26728.22 samples/sec	accuracy=nan
2022-05-13 14:50:53,395 Node[0] Epoch[16] Batch [40-60]	Speed: 26737.01 samples/sec	accuracy=nan
2022-05-13 14:50:55,839 Node[0] Epoch[16] Batch [60-80]	Speed: 26716.46 samples/sec	accuracy=nan
2022-05-13 14:50:58,281 Node[0] Epoch[16] Batch [80-100]	Speed: 26728.95 samples/sec	accuracy=nan
2022-05-13 14:51:00,725 Node[0] Epoch[16] Batch [100-120]	Speed: 26711.14 samples/sec	accuracy=nan
2022-05-13 14:51:03,168 Node[0] Epoch[16] Batch [120-140]	Speed: 26723.23 samples/sec	accuracy=nan
2022-05-13 14:51:05,612 Node[0] Epoch[16] Batch [140-160]	Speed: 26705.14 samples/sec	accuracy=nan
2022-05-13 14:51:08,058 Node[0] Epoch[16] Batch [160-180]	Speed: 26687.61 samples/sec	accuracy=nan
2022-05-13 14:51:10,500 Node[0] Epoch[16] Batch [180-200]	Speed: 26741.77 samples/sec	accuracy=nan
2022-05-13 14:51:12,938 Node[0] Epoch[16] Batch [200-220]	Speed: 26768.39 samples/sec	accuracy=nan
2022-05-13 14:51:15,381 Node[0] Epoch[16] Batch [220-240]	Speed: 26724.61 samples/sec	accuracy=nan
2022-05-13 14:51:17,818 Node[0] Epoch[16] Batch [240-260]	Speed: 26779.91 samples/sec	accuracy=nan
2022-05-13 14:51:20,258 Node[0] Epoch[16] Batch [260-280]	Speed: 26761.14 samples/sec	accuracy=nan
2022-05-13 14:51:22,704 Node[0] Epoch[16] Batch [280-300]	Speed: 26691.20 samples/sec	accuracy=nan
2022-05-13 14:51:25,148 Node[0] Epoch[16] Batch [300-320]	Speed: 26709.16 samples/sec	accuracy=nan
2022-05-13 14:51:27,587 Node[0] Epoch[16] Batch [320-340]	Speed: 26759.31 samples/sec	accuracy=nan
2022-05-13 14:51:30,030 Node[0] Epoch[16] Batch [340-360]	Speed: 26721.97 samples/sec	accuracy=nan
2022-05-13 14:51:32,474 Node[0] Epoch[16] Batch [360-380]	Speed: 26714.08 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471493942, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 17}}
2022-05-13 14:51:33,943 Node[0] Epoch[16] Time cost=47.993
:::MLLOG {"namespace": "", "time_ms": 1652471493943, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26695.05012133134}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 17}}
:::MLLOG {"namespace": "", "time_ms": 1652471493943, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26695.05012133134, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471493943, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 18}}
2022-05-13 14:51:36,511 Node[0] Epoch[17] Batch [0-20]	Speed: 26702.57 samples/sec	accuracy=nan
2022-05-13 14:51:38,954 Node[0] Epoch[17] Batch [20-40]	Speed: 26714.79 samples/sec	accuracy=nan
2022-05-13 14:51:41,395 Node[0] Epoch[17] Batch [40-60]	Speed: 26746.39 samples/sec	accuracy=nan
2022-05-13 14:51:43,838 Node[0] Epoch[17] Batch [60-80]	Speed: 26725.61 samples/sec	accuracy=nan
2022-05-13 14:51:46,276 Node[0] Epoch[17] Batch [80-100]	Speed: 26767.92 samples/sec	accuracy=nan
2022-05-13 14:51:48,717 Node[0] Epoch[17] Batch [100-120]	Speed: 26743.25 samples/sec	accuracy=nan
2022-05-13 14:51:51,157 Node[0] Epoch[17] Batch [120-140]	Speed: 26759.73 samples/sec	accuracy=nan
2022-05-13 14:51:53,597 Node[0] Epoch[17] Batch [140-160]	Speed: 26746.62 samples/sec	accuracy=nan
2022-05-13 14:51:56,039 Node[0] Epoch[17] Batch [160-180]	Speed: 26732.19 samples/sec	accuracy=nan
2022-05-13 14:51:58,483 Node[0] Epoch[17] Batch [180-200]	Speed: 26712.44 samples/sec	accuracy=nan
2022-05-13 14:52:00,925 Node[0] Epoch[17] Batch [200-220]	Speed: 26736.16 samples/sec	accuracy=nan
2022-05-13 14:52:03,368 Node[0] Epoch[17] Batch [220-240]	Speed: 26720.95 samples/sec	accuracy=nan
2022-05-13 14:52:05,811 Node[0] Epoch[17] Batch [240-260]	Speed: 26721.67 samples/sec	accuracy=nan
2022-05-13 14:52:08,254 Node[0] Epoch[17] Batch [260-280]	Speed: 26718.57 samples/sec	accuracy=nan
2022-05-13 14:52:10,699 Node[0] Epoch[17] Batch [280-300]	Speed: 26698.69 samples/sec	accuracy=nan
2022-05-13 14:52:13,145 Node[0] Epoch[17] Batch [300-320]	Speed: 26687.47 samples/sec	accuracy=nan
2022-05-13 14:52:15,584 Node[0] Epoch[17] Batch [320-340]	Speed: 26767.18 samples/sec	accuracy=nan
2022-05-13 14:52:18,024 Node[0] Epoch[17] Batch [340-360]	Speed: 26752.56 samples/sec	accuracy=nan
2022-05-13 14:52:20,463 Node[0] Epoch[17] Batch [360-380]	Speed: 26766.10 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471541927, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 18}}
2022-05-13 14:52:21,928 Node[0] Epoch[17] Time cost=47.984
:::MLLOG {"namespace": "", "time_ms": 1652471541928, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26699.78097345147}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 18}}
:::MLLOG {"namespace": "", "time_ms": 1652471541928, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26699.78097345147, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471541928, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 19}}
2022-05-13 14:52:24,493 Node[0] Epoch[18] Batch [0-20]	Speed: 26722.45 samples/sec	accuracy=nan
2022-05-13 14:52:26,934 Node[0] Epoch[18] Batch [20-40]	Speed: 26741.08 samples/sec	accuracy=nan
2022-05-13 14:52:29,375 Node[0] Epoch[18] Batch [40-60]	Speed: 26743.12 samples/sec	accuracy=nan
2022-05-13 14:52:31,817 Node[0] Epoch[18] Batch [60-80]	Speed: 26740.05 samples/sec	accuracy=nan
2022-05-13 14:52:34,259 Node[0] Epoch[18] Batch [80-100]	Speed: 26725.34 samples/sec	accuracy=nan
2022-05-13 14:52:36,703 Node[0] Epoch[18] Batch [100-120]	Speed: 26713.24 samples/sec	accuracy=nan
2022-05-13 14:52:39,146 Node[0] Epoch[18] Batch [120-140]	Speed: 26724.19 samples/sec	accuracy=nan
2022-05-13 14:52:41,587 Node[0] Epoch[18] Batch [140-160]	Speed: 26733.85 samples/sec	accuracy=nan
2022-05-13 14:52:44,030 Node[0] Epoch[18] Batch [160-180]	Speed: 26727.70 samples/sec	accuracy=nan
2022-05-13 14:52:46,470 Node[0] Epoch[18] Batch [180-200]	Speed: 26751.26 samples/sec	accuracy=nan
2022-05-13 14:52:48,912 Node[0] Epoch[18] Batch [200-220]	Speed: 26738.08 samples/sec	accuracy=nan
2022-05-13 14:52:51,352 Node[0] Epoch[18] Batch [220-240]	Speed: 26753.77 samples/sec	accuracy=nan
2022-05-13 14:52:53,794 Node[0] Epoch[18] Batch [240-260]	Speed: 26727.93 samples/sec	accuracy=nan
2022-05-13 14:52:56,236 Node[0] Epoch[18] Batch [260-280]	Speed: 26726.95 samples/sec	accuracy=nan
2022-05-13 14:52:58,676 Node[0] Epoch[18] Batch [280-300]	Speed: 26762.34 samples/sec	accuracy=nan
2022-05-13 14:53:01,118 Node[0] Epoch[18] Batch [300-320]	Speed: 26725.64 samples/sec	accuracy=nan
2022-05-13 14:53:03,559 Node[0] Epoch[18] Batch [320-340]	Speed: 26746.34 samples/sec	accuracy=nan
2022-05-13 14:53:06,003 Node[0] Epoch[18] Batch [340-360]	Speed: 26709.98 samples/sec	accuracy=nan
2022-05-13 14:53:08,448 Node[0] Epoch[18] Batch [360-380]	Speed: 26699.85 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471589913, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 19}}
2022-05-13 14:53:09,914 Node[0] Epoch[18] Time cost=47.986
:::MLLOG {"namespace": "", "time_ms": 1652471589914, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26698.624732989723}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 19}}
:::MLLOG {"namespace": "", "time_ms": 1652471589915, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26698.624732989723, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471590030, "event_type": "INTERVAL_START", "key": "eval_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1027, "epoch_num": 19}}
2022-05-13 14:53:11,730 Node[0] Epoch[18] Validation-accuracy=0.623520
2022-05-13 14:53:11,731 Node[0] Epoch[18] Validation-correct-count=3897.000000
2022-05-13 14:53:11,731 Node[0] Epoch[18] Validation-total-count=6250.000000
:::MLLOG {"namespace": "", "time_ms": 1652471591757, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1050, "epoch_num": 19}}
:::MLLOG {"namespace": "", "time_ms": 1652471591757, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.62656, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1056, "epoch_num": 19}}
:::MLLOG {"namespace": "", "time_ms": 1652471591757, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1059, "first_epoch_num": 16}}
:::MLLOG {"namespace": "", "time_ms": 1652471591757, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1075, "first_epoch_num": 20, "epoch_count": 4}}
:::MLLOG {"namespace": "", "time_ms": 1652471591757, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 20}}
2022-05-13 14:53:14,232 Node[0] Epoch[19] Batch [0-20]	Speed: 26496.99 samples/sec	accuracy=nan
2022-05-13 14:53:16,674 Node[0] Epoch[19] Batch [20-40]	Speed: 26725.67 samples/sec	accuracy=nan
2022-05-13 14:53:19,116 Node[0] Epoch[19] Batch [40-60]	Speed: 26740.45 samples/sec	accuracy=nan
2022-05-13 14:53:21,558 Node[0] Epoch[19] Batch [60-80]	Speed: 26721.91 samples/sec	accuracy=nan
2022-05-13 14:53:23,999 Node[0] Epoch[19] Batch [80-100]	Speed: 26749.85 samples/sec	accuracy=nan
2022-05-13 14:53:26,443 Node[0] Epoch[19] Batch [100-120]	Speed: 26707.71 samples/sec	accuracy=nan
2022-05-13 14:53:28,884 Node[0] Epoch[19] Batch [120-140]	Speed: 26746.56 samples/sec	accuracy=nan
2022-05-13 14:53:31,325 Node[0] Epoch[19] Batch [140-160]	Speed: 26738.54 samples/sec	accuracy=nan
2022-05-13 14:53:33,769 Node[0] Epoch[19] Batch [160-180]	Speed: 26715.46 samples/sec	accuracy=nan
2022-05-13 14:53:36,208 Node[0] Epoch[19] Batch [180-200]	Speed: 26758.90 samples/sec	accuracy=nan
2022-05-13 14:53:38,648 Node[0] Epoch[19] Batch [200-220]	Speed: 26760.76 samples/sec	accuracy=nan
2022-05-13 14:53:41,091 Node[0] Epoch[19] Batch [220-240]	Speed: 26720.35 samples/sec	accuracy=nan
2022-05-13 14:53:43,535 Node[0] Epoch[19] Batch [240-260]	Speed: 26703.87 samples/sec	accuracy=nan
2022-05-13 14:53:45,980 Node[0] Epoch[19] Batch [260-280]	Speed: 26705.54 samples/sec	accuracy=nan
2022-05-13 14:53:48,423 Node[0] Epoch[19] Batch [280-300]	Speed: 26722.95 samples/sec	accuracy=nan
2022-05-13 14:53:50,867 Node[0] Epoch[19] Batch [300-320]	Speed: 26701.94 samples/sec	accuracy=nan
2022-05-13 14:53:53,307 Node[0] Epoch[19] Batch [320-340]	Speed: 26762.87 samples/sec	accuracy=nan
2022-05-13 14:53:55,750 Node[0] Epoch[19] Batch [340-360]	Speed: 26721.22 samples/sec	accuracy=nan
2022-05-13 14:53:58,192 Node[0] Epoch[19] Batch [360-380]	Speed: 26733.27 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471639657, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 20}}
2022-05-13 14:53:59,658 Node[0] Epoch[19] Time cost=47.900
:::MLLOG {"namespace": "", "time_ms": 1652471639658, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26746.43621648021}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 20}}
:::MLLOG {"namespace": "", "time_ms": 1652471639658, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26746.43621648021, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471639658, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 21}}
2022-05-13 14:54:02,223 Node[0] Epoch[20] Batch [0-20]	Speed: 26711.38 samples/sec	accuracy=nan
2022-05-13 14:54:04,663 Node[0] Epoch[20] Batch [20-40]	Speed: 26758.52 samples/sec	accuracy=nan
2022-05-13 14:54:07,107 Node[0] Epoch[20] Batch [40-60]	Speed: 26705.03 samples/sec	accuracy=nan
2022-05-13 14:54:09,550 Node[0] Epoch[20] Batch [60-80]	Speed: 26726.63 samples/sec	accuracy=nan
2022-05-13 14:54:11,992 Node[0] Epoch[20] Batch [80-100]	Speed: 26727.29 samples/sec	accuracy=nan
2022-05-13 14:54:14,436 Node[0] Epoch[20] Batch [100-120]	Speed: 26715.34 samples/sec	accuracy=nan
2022-05-13 14:54:16,880 Node[0] Epoch[20] Batch [120-140]	Speed: 26705.76 samples/sec	accuracy=nan
2022-05-13 14:54:19,324 Node[0] Epoch[20] Batch [140-160]	Speed: 26714.66 samples/sec	accuracy=nan
2022-05-13 14:54:21,770 Node[0] Epoch[20] Batch [160-180]	Speed: 26691.22 samples/sec	accuracy=nan
2022-05-13 14:54:24,211 Node[0] Epoch[20] Batch [180-200]	Speed: 26742.10 samples/sec	accuracy=nan
2022-05-13 14:54:26,655 Node[0] Epoch[20] Batch [200-220]	Speed: 26711.74 samples/sec	accuracy=nan
2022-05-13 14:54:29,097 Node[0] Epoch[20] Batch [220-240]	Speed: 26724.61 samples/sec	accuracy=nan
2022-05-13 14:54:31,539 Node[0] Epoch[20] Batch [240-260]	Speed: 26731.77 samples/sec	accuracy=nan
2022-05-13 14:54:33,980 Node[0] Epoch[20] Batch [260-280]	Speed: 26741.51 samples/sec	accuracy=nan
2022-05-13 14:54:36,425 Node[0] Epoch[20] Batch [280-300]	Speed: 26706.11 samples/sec	accuracy=nan
2022-05-13 14:54:38,867 Node[0] Epoch[20] Batch [300-320]	Speed: 26734.52 samples/sec	accuracy=nan
2022-05-13 14:54:41,308 Node[0] Epoch[20] Batch [320-340]	Speed: 26739.33 samples/sec	accuracy=nan
2022-05-13 14:54:43,752 Node[0] Epoch[20] Batch [340-360]	Speed: 26711.26 samples/sec	accuracy=nan
2022-05-13 14:54:46,195 Node[0] Epoch[20] Batch [360-380]	Speed: 26715.93 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471687662, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 21}}
2022-05-13 14:54:47,663 Node[0] Epoch[20] Time cost=48.004
:::MLLOG {"namespace": "", "time_ms": 1652471687663, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26688.75950663696}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 21}}
:::MLLOG {"namespace": "", "time_ms": 1652471687663, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26688.75950663696, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471687663, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 22}}
2022-05-13 14:54:50,229 Node[0] Epoch[21] Batch [0-20]	Speed: 26740.79 samples/sec	accuracy=nan
2022-05-13 14:54:52,672 Node[0] Epoch[21] Batch [20-40]	Speed: 26727.72 samples/sec	accuracy=nan
2022-05-13 14:54:55,113 Node[0] Epoch[21] Batch [40-60]	Speed: 26739.56 samples/sec	accuracy=nan
2022-05-13 14:54:57,556 Node[0] Epoch[21] Batch [60-80]	Speed: 26717.37 samples/sec	accuracy=nan
2022-05-13 14:54:59,998 Node[0] Epoch[21] Batch [80-100]	Speed: 26739.59 samples/sec	accuracy=nan
2022-05-13 14:55:02,439 Node[0] Epoch[21] Batch [100-120]	Speed: 26740.13 samples/sec	accuracy=nan
2022-05-13 14:55:04,880 Node[0] Epoch[21] Batch [120-140]	Speed: 26741.87 samples/sec	accuracy=nan
2022-05-13 14:55:07,322 Node[0] Epoch[21] Batch [140-160]	Speed: 26731.06 samples/sec	accuracy=nan
2022-05-13 14:55:09,771 Node[0] Epoch[21] Batch [160-180]	Speed: 26659.55 samples/sec	accuracy=nan
2022-05-13 14:55:12,208 Node[0] Epoch[21] Batch [180-200]	Speed: 26791.18 samples/sec	accuracy=nan
2022-05-13 14:55:14,649 Node[0] Epoch[21] Batch [200-220]	Speed: 26738.91 samples/sec	accuracy=nan
2022-05-13 14:55:17,092 Node[0] Epoch[21] Batch [220-240]	Speed: 26720.74 samples/sec	accuracy=nan
2022-05-13 14:55:19,535 Node[0] Epoch[21] Batch [240-260]	Speed: 26724.76 samples/sec	accuracy=nan
2022-05-13 14:55:21,976 Node[0] Epoch[21] Batch [260-280]	Speed: 26741.99 samples/sec	accuracy=nan
2022-05-13 14:55:24,419 Node[0] Epoch[21] Batch [280-300]	Speed: 26715.45 samples/sec	accuracy=nan
2022-05-13 14:55:26,862 Node[0] Epoch[21] Batch [300-320]	Speed: 26728.19 samples/sec	accuracy=nan
2022-05-13 14:55:29,305 Node[0] Epoch[21] Batch [320-340]	Speed: 26719.59 samples/sec	accuracy=nan
2022-05-13 14:55:31,745 Node[0] Epoch[21] Batch [340-360]	Speed: 26748.67 samples/sec	accuracy=nan
2022-05-13 14:55:34,188 Node[0] Epoch[21] Batch [360-380]	Speed: 26728.44 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471735653, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 22}}
2022-05-13 14:55:35,654 Node[0] Epoch[21] Time cost=47.991
:::MLLOG {"namespace": "", "time_ms": 1652471735654, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26696.11613108177}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 22}}
:::MLLOG {"namespace": "", "time_ms": 1652471735654, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26696.11613108177, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471735654, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 23}}
2022-05-13 14:55:38,219 Node[0] Epoch[22] Batch [0-20]	Speed: 26751.57 samples/sec	accuracy=nan
2022-05-13 14:55:40,661 Node[0] Epoch[22] Batch [20-40]	Speed: 26736.10 samples/sec	accuracy=nan
2022-05-13 14:55:43,102 Node[0] Epoch[22] Batch [40-60]	Speed: 26735.57 samples/sec	accuracy=nan
2022-05-13 14:55:45,543 Node[0] Epoch[22] Batch [60-80]	Speed: 26749.65 samples/sec	accuracy=nan
2022-05-13 14:55:47,986 Node[0] Epoch[22] Batch [80-100]	Speed: 26713.14 samples/sec	accuracy=nan
2022-05-13 14:55:50,430 Node[0] Epoch[22] Batch [100-120]	Speed: 26710.14 samples/sec	accuracy=nan
2022-05-13 14:55:52,871 Node[0] Epoch[22] Batch [120-140]	Speed: 26745.86 samples/sec	accuracy=nan
2022-05-13 14:55:55,312 Node[0] Epoch[22] Batch [140-160]	Speed: 26743.74 samples/sec	accuracy=nan
2022-05-13 14:55:57,758 Node[0] Epoch[22] Batch [160-180]	Speed: 26688.45 samples/sec	accuracy=nan
2022-05-13 14:56:00,200 Node[0] Epoch[22] Batch [180-200]	Speed: 26738.07 samples/sec	accuracy=nan
2022-05-13 14:56:02,643 Node[0] Epoch[22] Batch [200-220]	Speed: 26715.73 samples/sec	accuracy=nan
2022-05-13 14:56:05,086 Node[0] Epoch[22] Batch [220-240]	Speed: 26722.66 samples/sec	accuracy=nan
2022-05-13 14:56:07,526 Node[0] Epoch[22] Batch [240-260]	Speed: 26753.99 samples/sec	accuracy=nan
2022-05-13 14:56:09,970 Node[0] Epoch[22] Batch [260-280]	Speed: 26712.09 samples/sec	accuracy=nan
2022-05-13 14:56:12,416 Node[0] Epoch[22] Batch [280-300]	Speed: 26682.71 samples/sec	accuracy=nan
2022-05-13 14:56:14,857 Node[0] Epoch[22] Batch [300-320]	Speed: 26745.27 samples/sec	accuracy=nan
2022-05-13 14:56:17,299 Node[0] Epoch[22] Batch [320-340]	Speed: 26737.19 samples/sec	accuracy=nan
2022-05-13 14:56:19,744 Node[0] Epoch[22] Batch [340-360]	Speed: 26701.95 samples/sec	accuracy=nan
2022-05-13 14:56:22,187 Node[0] Epoch[22] Batch [360-380]	Speed: 26719.00 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471783652, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 23}}
2022-05-13 14:56:23,652 Node[0] Epoch[22] Time cost=47.998
:::MLLOG {"namespace": "", "time_ms": 1652471783653, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26692.108227618864}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 23}}
:::MLLOG {"namespace": "", "time_ms": 1652471783653, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26692.108227618864, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471783768, "event_type": "INTERVAL_START", "key": "eval_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1027, "epoch_num": 23}}
2022-05-13 14:56:25,470 Node[0] Epoch[22] Validation-accuracy=0.698240
2022-05-13 14:56:25,470 Node[0] Epoch[22] Validation-correct-count=4364.000000
2022-05-13 14:56:25,470 Node[0] Epoch[22] Validation-total-count=6250.000000
:::MLLOG {"namespace": "", "time_ms": 1652471785488, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1050, "epoch_num": 23}}
:::MLLOG {"namespace": "", "time_ms": 1652471785488, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.70004, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1056, "epoch_num": 23}}
:::MLLOG {"namespace": "", "time_ms": 1652471785488, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1059, "first_epoch_num": 20}}
:::MLLOG {"namespace": "", "time_ms": 1652471785488, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1075, "first_epoch_num": 24, "epoch_count": 4}}
:::MLLOG {"namespace": "", "time_ms": 1652471785489, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 24}}
2022-05-13 14:56:27,963 Node[0] Epoch[23] Batch [0-20]	Speed: 26476.88 samples/sec	accuracy=nan
2022-05-13 14:56:30,404 Node[0] Epoch[23] Batch [20-40]	Speed: 26752.01 samples/sec	accuracy=nan
2022-05-13 14:56:32,845 Node[0] Epoch[23] Batch [40-60]	Speed: 26739.11 samples/sec	accuracy=nan
2022-05-13 14:56:35,283 Node[0] Epoch[23] Batch [60-80]	Speed: 26772.18 samples/sec	accuracy=nan
2022-05-13 14:56:37,726 Node[0] Epoch[23] Batch [80-100]	Speed: 26729.72 samples/sec	accuracy=nan
2022-05-13 14:56:40,169 Node[0] Epoch[23] Batch [100-120]	Speed: 26718.21 samples/sec	accuracy=nan
2022-05-13 14:56:42,615 Node[0] Epoch[23] Batch [120-140]	Speed: 26682.07 samples/sec	accuracy=nan
2022-05-13 14:56:45,059 Node[0] Epoch[23] Batch [140-160]	Speed: 26713.59 samples/sec	accuracy=nan
2022-05-13 14:56:47,501 Node[0] Epoch[23] Batch [160-180]	Speed: 26735.20 samples/sec	accuracy=nan
2022-05-13 14:56:49,942 Node[0] Epoch[23] Batch [180-200]	Speed: 26744.85 samples/sec	accuracy=nan
2022-05-13 14:56:52,381 Node[0] Epoch[23] Batch [200-220]	Speed: 26763.34 samples/sec	accuracy=nan
2022-05-13 14:56:54,824 Node[0] Epoch[23] Batch [220-240]	Speed: 26719.61 samples/sec	accuracy=nan
2022-05-13 14:56:57,267 Node[0] Epoch[23] Batch [240-260]	Speed: 26722.83 samples/sec	accuracy=nan
2022-05-13 14:56:59,708 Node[0] Epoch[23] Batch [260-280]	Speed: 26744.15 samples/sec	accuracy=nan
2022-05-13 14:57:02,149 Node[0] Epoch[23] Batch [280-300]	Speed: 26743.33 samples/sec	accuracy=nan
2022-05-13 14:57:04,591 Node[0] Epoch[23] Batch [300-320]	Speed: 26731.09 samples/sec	accuracy=nan
2022-05-13 14:57:07,033 Node[0] Epoch[23] Batch [320-340]	Speed: 26725.88 samples/sec	accuracy=nan
2022-05-13 14:57:09,476 Node[0] Epoch[23] Batch [340-360]	Speed: 26726.04 samples/sec	accuracy=nan
2022-05-13 14:57:11,922 Node[0] Epoch[23] Batch [360-380]	Speed: 26687.51 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471833388, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 24}}
2022-05-13 14:57:13,389 Node[0] Epoch[23] Time cost=47.900
:::MLLOG {"namespace": "", "time_ms": 1652471833389, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26746.53246765936}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 24}}
:::MLLOG {"namespace": "", "time_ms": 1652471833389, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26746.53246765936, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471833389, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 25}}
2022-05-13 14:57:15,956 Node[0] Epoch[24] Batch [0-20]	Speed: 26702.69 samples/sec	accuracy=nan
2022-05-13 14:57:18,401 Node[0] Epoch[24] Batch [20-40]	Speed: 26701.27 samples/sec	accuracy=nan
2022-05-13 14:57:20,844 Node[0] Epoch[24] Batch [40-60]	Speed: 26712.22 samples/sec	accuracy=nan
2022-05-13 14:57:23,286 Node[0] Epoch[24] Batch [60-80]	Speed: 26734.58 samples/sec	accuracy=nan
2022-05-13 14:57:25,729 Node[0] Epoch[24] Batch [80-100]	Speed: 26725.92 samples/sec	accuracy=nan
2022-05-13 14:57:28,177 Node[0] Epoch[24] Batch [100-120]	Speed: 26663.33 samples/sec	accuracy=nan
2022-05-13 14:57:30,618 Node[0] Epoch[24] Batch [120-140]	Speed: 26744.81 samples/sec	accuracy=nan
2022-05-13 14:57:33,062 Node[0] Epoch[24] Batch [140-160]	Speed: 26706.68 samples/sec	accuracy=nan
2022-05-13 14:57:35,505 Node[0] Epoch[24] Batch [160-180]	Speed: 26720.26 samples/sec	accuracy=nan
2022-05-13 14:57:37,947 Node[0] Epoch[24] Batch [180-200]	Speed: 26730.66 samples/sec	accuracy=nan
2022-05-13 14:57:40,393 Node[0] Epoch[24] Batch [200-220]	Speed: 26693.99 samples/sec	accuracy=nan
2022-05-13 14:57:42,835 Node[0] Epoch[24] Batch [220-240]	Speed: 26730.48 samples/sec	accuracy=nan
2022-05-13 14:57:45,280 Node[0] Epoch[24] Batch [240-260]	Speed: 26701.66 samples/sec	accuracy=nan
2022-05-13 14:57:47,720 Node[0] Epoch[24] Batch [260-280]	Speed: 26747.44 samples/sec	accuracy=nan
2022-05-13 14:57:50,164 Node[0] Epoch[24] Batch [280-300]	Speed: 26713.03 samples/sec	accuracy=nan
2022-05-13 14:57:52,609 Node[0] Epoch[24] Batch [300-320]	Speed: 26700.15 samples/sec	accuracy=nan
2022-05-13 14:57:55,050 Node[0] Epoch[24] Batch [320-340]	Speed: 26741.11 samples/sec	accuracy=nan
2022-05-13 14:57:57,494 Node[0] Epoch[24] Batch [340-360]	Speed: 26715.33 samples/sec	accuracy=nan
2022-05-13 14:57:59,939 Node[0] Epoch[24] Batch [360-380]	Speed: 26693.51 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471881406, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 25}}
2022-05-13 14:58:01,407 Node[0] Epoch[24] Time cost=48.017
:::MLLOG {"namespace": "", "time_ms": 1652471881407, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26681.571212365114}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 25}}
:::MLLOG {"namespace": "", "time_ms": 1652471881407, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26681.571212365114, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471881407, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 26}}
2022-05-13 14:58:03,976 Node[0] Epoch[25] Batch [0-20]	Speed: 26676.41 samples/sec	accuracy=nan
2022-05-13 14:58:06,417 Node[0] Epoch[25] Batch [20-40]	Speed: 26736.08 samples/sec	accuracy=nan
2022-05-13 14:58:08,861 Node[0] Epoch[25] Batch [40-60]	Speed: 26716.21 samples/sec	accuracy=nan
2022-05-13 14:58:11,301 Node[0] Epoch[25] Batch [60-80]	Speed: 26750.11 samples/sec	accuracy=nan
2022-05-13 14:58:13,744 Node[0] Epoch[25] Batch [80-100]	Speed: 26725.76 samples/sec	accuracy=nan
2022-05-13 14:58:16,187 Node[0] Epoch[25] Batch [100-120]	Speed: 26722.16 samples/sec	accuracy=nan
2022-05-13 14:58:18,630 Node[0] Epoch[25] Batch [120-140]	Speed: 26716.63 samples/sec	accuracy=nan
2022-05-13 14:58:21,071 Node[0] Epoch[25] Batch [140-160]	Speed: 26743.34 samples/sec	accuracy=nan
2022-05-13 14:58:23,514 Node[0] Epoch[25] Batch [160-180]	Speed: 26723.65 samples/sec	accuracy=nan
2022-05-13 14:58:25,954 Node[0] Epoch[25] Batch [180-200]	Speed: 26749.59 samples/sec	accuracy=nan
2022-05-13 14:58:28,393 Node[0] Epoch[25] Batch [200-220]	Speed: 26767.42 samples/sec	accuracy=nan
2022-05-13 14:58:30,839 Node[0] Epoch[25] Batch [220-240]	Speed: 26684.42 samples/sec	accuracy=nan
2022-05-13 14:58:33,285 Node[0] Epoch[25] Batch [240-260]	Speed: 26687.25 samples/sec	accuracy=nan
2022-05-13 14:58:35,729 Node[0] Epoch[25] Batch [260-280]	Speed: 26716.09 samples/sec	accuracy=nan
2022-05-13 14:58:38,173 Node[0] Epoch[25] Batch [280-300]	Speed: 26706.98 samples/sec	accuracy=nan
2022-05-13 14:58:40,615 Node[0] Epoch[25] Batch [300-320]	Speed: 26730.83 samples/sec	accuracy=nan
2022-05-13 14:58:43,057 Node[0] Epoch[25] Batch [320-340]	Speed: 26739.06 samples/sec	accuracy=nan
2022-05-13 14:58:45,497 Node[0] Epoch[25] Batch [340-360]	Speed: 26747.37 samples/sec	accuracy=nan
2022-05-13 14:58:47,940 Node[0] Epoch[25] Batch [360-380]	Speed: 26724.56 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471929407, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 26}}
2022-05-13 14:58:49,408 Node[0] Epoch[25] Time cost=48.001
:::MLLOG {"namespace": "", "time_ms": 1652471929408, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26690.559174003884}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 26}}
:::MLLOG {"namespace": "", "time_ms": 1652471929408, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26690.559174003884, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471929408, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 27}}
2022-05-13 14:58:51,969 Node[0] Epoch[26] Batch [0-20]	Speed: 26760.51 samples/sec	accuracy=nan
2022-05-13 14:58:54,412 Node[0] Epoch[26] Batch [20-40]	Speed: 26727.35 samples/sec	accuracy=nan
2022-05-13 14:58:56,856 Node[0] Epoch[26] Batch [40-60]	Speed: 26713.74 samples/sec	accuracy=nan
2022-05-13 14:58:59,298 Node[0] Epoch[26] Batch [60-80]	Speed: 26723.43 samples/sec	accuracy=nan
2022-05-13 14:59:01,740 Node[0] Epoch[26] Batch [80-100]	Speed: 26740.59 samples/sec	accuracy=nan
2022-05-13 14:59:04,182 Node[0] Epoch[26] Batch [100-120]	Speed: 26728.32 samples/sec	accuracy=nan
2022-05-13 14:59:06,622 Node[0] Epoch[26] Batch [120-140]	Speed: 26747.45 samples/sec	accuracy=nan
2022-05-13 14:59:09,068 Node[0] Epoch[26] Batch [140-160]	Speed: 26694.81 samples/sec	accuracy=nan
2022-05-13 14:59:11,511 Node[0] Epoch[26] Batch [160-180]	Speed: 26715.81 samples/sec	accuracy=nan
2022-05-13 14:59:13,954 Node[0] Epoch[26] Batch [180-200]	Speed: 26727.71 samples/sec	accuracy=nan
2022-05-13 14:59:16,397 Node[0] Epoch[26] Batch [200-220]	Speed: 26720.74 samples/sec	accuracy=nan
2022-05-13 14:59:18,838 Node[0] Epoch[26] Batch [220-240]	Speed: 26739.21 samples/sec	accuracy=nan
2022-05-13 14:59:21,284 Node[0] Epoch[26] Batch [240-260]	Speed: 26688.32 samples/sec	accuracy=nan
2022-05-13 14:59:23,728 Node[0] Epoch[26] Batch [260-280]	Speed: 26715.40 samples/sec	accuracy=nan
2022-05-13 14:59:26,170 Node[0] Epoch[26] Batch [280-300]	Speed: 26731.96 samples/sec	accuracy=nan
2022-05-13 14:59:28,613 Node[0] Epoch[26] Batch [300-320]	Speed: 26724.48 samples/sec	accuracy=nan
2022-05-13 14:59:31,054 Node[0] Epoch[26] Batch [320-340]	Speed: 26733.99 samples/sec	accuracy=nan
2022-05-13 14:59:33,505 Node[0] Epoch[26] Batch [340-360]	Speed: 26637.09 samples/sec	accuracy=nan
2022-05-13 14:59:35,944 Node[0] Epoch[26] Batch [360-380]	Speed: 26764.40 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652471977412, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 27}}
2022-05-13 14:59:37,413 Node[0] Epoch[26] Time cost=48.005
:::MLLOG {"namespace": "", "time_ms": 1652471977413, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26688.33454695239}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 27}}
:::MLLOG {"namespace": "", "time_ms": 1652471977413, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26688.33454695239, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652471977529, "event_type": "INTERVAL_START", "key": "eval_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1027, "epoch_num": 27}}
2022-05-13 14:59:39,210 Node[0] Epoch[26] Validation-accuracy=0.730720
2022-05-13 14:59:39,211 Node[0] Epoch[26] Validation-correct-count=4567.000000
2022-05-13 14:59:39,211 Node[0] Epoch[26] Validation-total-count=6250.000000
:::MLLOG {"namespace": "", "time_ms": 1652471979266, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1050, "epoch_num": 27}}
:::MLLOG {"namespace": "", "time_ms": 1652471979266, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.73166, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1056, "epoch_num": 27}}
:::MLLOG {"namespace": "", "time_ms": 1652471979267, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1059, "first_epoch_num": 24}}
:::MLLOG {"namespace": "", "time_ms": 1652471979267, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1075, "first_epoch_num": 28, "epoch_count": 4}}
:::MLLOG {"namespace": "", "time_ms": 1652471979267, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 28}}
2022-05-13 14:59:41,744 Node[0] Epoch[27] Batch [0-20]	Speed: 26445.28 samples/sec	accuracy=nan
2022-05-13 14:59:44,186 Node[0] Epoch[27] Batch [20-40]	Speed: 26724.90 samples/sec	accuracy=nan
2022-05-13 14:59:46,623 Node[0] Epoch[27] Batch [40-60]	Speed: 26789.24 samples/sec	accuracy=nan
2022-05-13 14:59:49,064 Node[0] Epoch[27] Batch [60-80]	Speed: 26742.86 samples/sec	accuracy=nan
2022-05-13 14:59:51,503 Node[0] Epoch[27] Batch [80-100]	Speed: 26764.97 samples/sec	accuracy=nan
2022-05-13 14:59:53,949 Node[0] Epoch[27] Batch [100-120]	Speed: 26692.10 samples/sec	accuracy=nan
2022-05-13 14:59:56,391 Node[0] Epoch[27] Batch [120-140]	Speed: 26730.29 samples/sec	accuracy=nan
2022-05-13 14:59:58,835 Node[0] Epoch[27] Batch [140-160]	Speed: 26707.26 samples/sec	accuracy=nan
2022-05-13 15:00:01,277 Node[0] Epoch[27] Batch [160-180]	Speed: 26734.99 samples/sec	accuracy=nan
2022-05-13 15:00:03,720 Node[0] Epoch[27] Batch [180-200]	Speed: 26724.01 samples/sec	accuracy=nan
2022-05-13 15:00:06,163 Node[0] Epoch[27] Batch [200-220]	Speed: 26716.01 samples/sec	accuracy=nan
2022-05-13 15:00:08,605 Node[0] Epoch[27] Batch [220-240]	Speed: 26731.29 samples/sec	accuracy=nan
2022-05-13 15:00:11,048 Node[0] Epoch[27] Batch [240-260]	Speed: 26725.98 samples/sec	accuracy=nan
2022-05-13 15:00:13,495 Node[0] Epoch[27] Batch [260-280]	Speed: 26677.03 samples/sec	accuracy=nan
2022-05-13 15:00:15,938 Node[0] Epoch[27] Batch [280-300]	Speed: 26722.86 samples/sec	accuracy=nan
2022-05-13 15:00:18,384 Node[0] Epoch[27] Batch [300-320]	Speed: 26689.65 samples/sec	accuracy=nan
2022-05-13 15:00:20,823 Node[0] Epoch[27] Batch [320-340]	Speed: 26760.98 samples/sec	accuracy=nan
2022-05-13 15:00:23,267 Node[0] Epoch[27] Batch [340-360]	Speed: 26712.65 samples/sec	accuracy=nan
2022-05-13 15:00:25,710 Node[0] Epoch[27] Batch [360-380]	Speed: 26721.13 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652472027173, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 28}}
2022-05-13 15:00:27,174 Node[0] Epoch[27] Time cost=47.907
:::MLLOG {"namespace": "", "time_ms": 1652472027174, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26742.667522369036}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 28}}
:::MLLOG {"namespace": "", "time_ms": 1652472027174, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26742.667522369036, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652472027175, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 29}}
2022-05-13 15:00:29,737 Node[0] Epoch[28] Batch [0-20]	Speed: 26752.16 samples/sec	accuracy=nan
2022-05-13 15:00:32,180 Node[0] Epoch[28] Batch [20-40]	Speed: 26719.83 samples/sec	accuracy=nan
2022-05-13 15:00:34,619 Node[0] Epoch[28] Batch [40-60]	Speed: 26768.40 samples/sec	accuracy=nan
2022-05-13 15:00:37,064 Node[0] Epoch[28] Batch [60-80]	Speed: 26692.19 samples/sec	accuracy=nan
2022-05-13 15:00:39,509 Node[0] Epoch[28] Batch [80-100]	Speed: 26707.21 samples/sec	accuracy=nan
2022-05-13 15:00:41,950 Node[0] Epoch[28] Batch [100-120]	Speed: 26742.69 samples/sec	accuracy=nan
2022-05-13 15:00:44,391 Node[0] Epoch[28] Batch [120-140]	Speed: 26740.52 samples/sec	accuracy=nan
2022-05-13 15:00:46,833 Node[0] Epoch[28] Batch [140-160]	Speed: 26733.03 samples/sec	accuracy=nan
2022-05-13 15:00:49,278 Node[0] Epoch[28] Batch [160-180]	Speed: 26694.18 samples/sec	accuracy=nan
2022-05-13 15:00:51,721 Node[0] Epoch[28] Batch [180-200]	Speed: 26723.61 samples/sec	accuracy=nan
2022-05-13 15:00:54,166 Node[0] Epoch[28] Batch [200-220]	Speed: 26700.67 samples/sec	accuracy=nan
2022-05-13 15:00:56,608 Node[0] Epoch[28] Batch [220-240]	Speed: 26733.99 samples/sec	accuracy=nan
2022-05-13 15:00:59,053 Node[0] Epoch[28] Batch [240-260]	Speed: 26699.07 samples/sec	accuracy=nan
2022-05-13 15:01:01,500 Node[0] Epoch[28] Batch [260-280]	Speed: 26679.88 samples/sec	accuracy=nan
2022-05-13 15:01:07,517 Node[0] Epoch[28] Batch [280-300]	Speed: 10848.11 samples/sec	accuracy=nan
2022-05-13 15:01:09,958 Node[0] Epoch[28] Batch [300-320]	Speed: 26744.20 samples/sec	accuracy=nan
2022-05-13 15:01:12,400 Node[0] Epoch[28] Batch [320-340]	Speed: 26728.96 samples/sec	accuracy=nan
2022-05-13 15:01:14,841 Node[0] Epoch[28] Batch [340-360]	Speed: 26747.99 samples/sec	accuracy=nan
2022-05-13 15:01:17,286 Node[0] Epoch[28] Batch [360-380]	Speed: 26704.70 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652472078748, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 29}}
2022-05-13 15:01:18,749 Node[0] Epoch[28] Time cost=51.574
:::MLLOG {"namespace": "", "time_ms": 1652472078749, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 24841.1276726995}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 29}}
:::MLLOG {"namespace": "", "time_ms": 1652472078750, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 24841.1276726995, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652472078750, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 30}}
2022-05-13 15:01:21,314 Node[0] Epoch[29] Batch [0-20]	Speed: 26716.94 samples/sec	accuracy=nan
2022-05-13 15:01:23,757 Node[0] Epoch[29] Batch [20-40]	Speed: 26723.69 samples/sec	accuracy=nan
2022-05-13 15:01:26,201 Node[0] Epoch[29] Batch [40-60]	Speed: 26710.94 samples/sec	accuracy=nan
2022-05-13 15:01:28,643 Node[0] Epoch[29] Batch [60-80]	Speed: 26731.12 samples/sec	accuracy=nan
2022-05-13 15:01:31,081 Node[0] Epoch[29] Batch [80-100]	Speed: 26771.78 samples/sec	accuracy=nan
2022-05-13 15:01:33,523 Node[0] Epoch[29] Batch [100-120]	Speed: 26736.88 samples/sec	accuracy=nan
2022-05-13 15:01:35,968 Node[0] Epoch[29] Batch [120-140]	Speed: 26702.64 samples/sec	accuracy=nan
2022-05-13 15:01:38,407 Node[0] Epoch[29] Batch [140-160]	Speed: 26758.40 samples/sec	accuracy=nan
2022-05-13 15:01:40,848 Node[0] Epoch[29] Batch [160-180]	Speed: 26747.50 samples/sec	accuracy=nan
2022-05-13 15:01:43,286 Node[0] Epoch[29] Batch [180-200]	Speed: 26768.25 samples/sec	accuracy=nan
2022-05-13 15:01:45,728 Node[0] Epoch[29] Batch [200-220]	Speed: 26742.57 samples/sec	accuracy=nan
2022-05-13 15:01:48,169 Node[0] Epoch[29] Batch [220-240]	Speed: 26737.45 samples/sec	accuracy=nan
2022-05-13 15:01:50,608 Node[0] Epoch[29] Batch [240-260]	Speed: 26762.18 samples/sec	accuracy=nan
2022-05-13 15:01:53,048 Node[0] Epoch[29] Batch [260-280]	Speed: 26752.86 samples/sec	accuracy=nan
2022-05-13 15:01:57,702 Node[0] Epoch[29] Batch [280-300]	Speed: 14026.84 samples/sec	accuracy=nan
2022-05-13 15:02:00,145 Node[0] Epoch[29] Batch [300-320]	Speed: 26723.16 samples/sec	accuracy=nan
2022-05-13 15:02:02,586 Node[0] Epoch[29] Batch [320-340]	Speed: 26749.24 samples/sec	accuracy=nan
2022-05-13 15:02:05,031 Node[0] Epoch[29] Batch [340-360]	Speed: 26696.55 samples/sec	accuracy=nan
2022-05-13 15:02:07,471 Node[0] Epoch[29] Batch [360-380]	Speed: 26758.73 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652472128933, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 30}}
2022-05-13 15:02:08,934 Node[0] Epoch[29] Time cost=50.184
:::MLLOG {"namespace": "", "time_ms": 1652472128934, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 25529.276607868895}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 30}}
:::MLLOG {"namespace": "", "time_ms": 1652472128934, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 25529.276607868895, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652472128935, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 31}}
2022-05-13 15:02:11,501 Node[0] Epoch[30] Batch [0-20]	Speed: 26701.00 samples/sec	accuracy=nan
2022-05-13 15:02:13,944 Node[0] Epoch[30] Batch [20-40]	Speed: 26729.44 samples/sec	accuracy=nan
2022-05-13 15:02:16,384 Node[0] Epoch[30] Batch [40-60]	Speed: 26744.74 samples/sec	accuracy=nan
2022-05-13 15:02:18,829 Node[0] Epoch[30] Batch [60-80]	Speed: 26706.46 samples/sec	accuracy=nan
2022-05-13 15:02:21,270 Node[0] Epoch[30] Batch [80-100]	Speed: 26740.38 samples/sec	accuracy=nan
2022-05-13 15:02:23,711 Node[0] Epoch[30] Batch [100-120]	Speed: 26741.53 samples/sec	accuracy=nan
2022-05-13 15:02:26,153 Node[0] Epoch[30] Batch [120-140]	Speed: 26731.11 samples/sec	accuracy=nan
2022-05-13 15:02:28,598 Node[0] Epoch[30] Batch [140-160]	Speed: 26700.59 samples/sec	accuracy=nan
2022-05-13 15:02:31,042 Node[0] Epoch[30] Batch [160-180]	Speed: 26710.05 samples/sec	accuracy=nan
2022-05-13 15:02:33,487 Node[0] Epoch[30] Batch [180-200]	Speed: 26696.58 samples/sec	accuracy=nan
2022-05-13 15:02:35,932 Node[0] Epoch[30] Batch [200-220]	Speed: 26703.02 samples/sec	accuracy=nan
2022-05-13 15:02:38,374 Node[0] Epoch[30] Batch [220-240]	Speed: 26734.99 samples/sec	accuracy=nan
2022-05-13 15:02:40,820 Node[0] Epoch[30] Batch [240-260]	Speed: 26691.69 samples/sec	accuracy=nan
2022-05-13 15:02:43,263 Node[0] Epoch[30] Batch [260-280]	Speed: 26714.79 samples/sec	accuracy=nan
2022-05-13 15:02:47,945 Node[0] Epoch[30] Batch [280-300]	Speed: 13943.64 samples/sec	accuracy=nan
2022-05-13 15:02:51,893 Node[0] Epoch[30] Batch [300-320]	Speed: 16532.62 samples/sec	accuracy=nan
2022-05-13 15:02:54,335 Node[0] Epoch[30] Batch [320-340]	Speed: 26740.54 samples/sec	accuracy=nan
2022-05-13 15:02:56,779 Node[0] Epoch[30] Batch [340-360]	Speed: 26701.95 samples/sec	accuracy=nan
2022-05-13 15:02:59,224 Node[0] Epoch[30] Batch [360-380]	Speed: 26705.73 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652472180687, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 31}}
2022-05-13 15:03:00,688 Node[0] Epoch[30] Time cost=51.753
:::MLLOG {"namespace": "", "time_ms": 1652472180688, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 24755.460410774314}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 31}}
:::MLLOG {"namespace": "", "time_ms": 1652472180688, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 24755.460410774314, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652472180803, "event_type": "INTERVAL_START", "key": "eval_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1027, "epoch_num": 31}}
2022-05-13 15:03:02,532 Node[0] Epoch[30] Validation-accuracy=0.758400
2022-05-13 15:03:02,533 Node[0] Epoch[30] Validation-correct-count=4740.000000
2022-05-13 15:03:02,533 Node[0] Epoch[30] Validation-total-count=6250.000000
:::MLLOG {"namespace": "", "time_ms": 1652472182533, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1050, "epoch_num": 31}}
:::MLLOG {"namespace": "", "time_ms": 1652472182533, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.7523, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1056, "epoch_num": 31}}
:::MLLOG {"namespace": "", "time_ms": 1652472182533, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1059, "first_epoch_num": 28}}
:::MLLOG {"namespace": "", "time_ms": 1652472182534, "event_type": "INTERVAL_START", "key": "block_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1075, "first_epoch_num": 32, "epoch_count": 4}}
:::MLLOG {"namespace": "", "time_ms": 1652472182534, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 32}}
2022-05-13 15:03:05,010 Node[0] Epoch[31] Batch [0-20]	Speed: 26470.39 samples/sec	accuracy=nan
2022-05-13 15:03:07,452 Node[0] Epoch[31] Batch [20-40]	Speed: 26733.19 samples/sec	accuracy=nan
2022-05-13 15:03:09,893 Node[0] Epoch[31] Batch [40-60]	Speed: 26740.19 samples/sec	accuracy=nan
2022-05-13 15:03:12,335 Node[0] Epoch[31] Batch [60-80]	Speed: 26733.81 samples/sec	accuracy=nan
2022-05-13 15:03:14,776 Node[0] Epoch[31] Batch [80-100]	Speed: 26746.99 samples/sec	accuracy=nan
2022-05-13 15:03:17,217 Node[0] Epoch[31] Batch [100-120]	Speed: 26743.74 samples/sec	accuracy=nan
2022-05-13 15:03:19,660 Node[0] Epoch[31] Batch [120-140]	Speed: 26715.18 samples/sec	accuracy=nan
2022-05-13 15:03:22,103 Node[0] Epoch[31] Batch [140-160]	Speed: 26727.32 samples/sec	accuracy=nan
2022-05-13 15:03:24,549 Node[0] Epoch[31] Batch [160-180]	Speed: 26686.83 samples/sec	accuracy=nan
2022-05-13 15:03:26,993 Node[0] Epoch[31] Batch [180-200]	Speed: 26713.99 samples/sec	accuracy=nan
2022-05-13 15:03:29,433 Node[0] Epoch[31] Batch [200-220]	Speed: 26747.08 samples/sec	accuracy=nan
2022-05-13 15:03:31,875 Node[0] Epoch[31] Batch [220-240]	Speed: 26730.90 samples/sec	accuracy=nan
2022-05-13 15:03:34,319 Node[0] Epoch[31] Batch [240-260]	Speed: 26715.95 samples/sec	accuracy=nan
2022-05-13 15:03:36,761 Node[0] Epoch[31] Batch [260-280]	Speed: 26735.80 samples/sec	accuracy=nan
2022-05-13 15:03:39,205 Node[0] Epoch[31] Batch [280-300]	Speed: 26706.32 samples/sec	accuracy=nan
2022-05-13 15:03:43,789 Node[0] Epoch[31] Batch [300-320]	Speed: 14240.44 samples/sec	accuracy=nan
2022-05-13 15:03:46,231 Node[0] Epoch[31] Batch [320-340]	Speed: 26732.55 samples/sec	accuracy=nan
2022-05-13 15:03:48,679 Node[0] Epoch[31] Batch [340-360]	Speed: 26670.45 samples/sec	accuracy=nan
2022-05-13 15:03:51,125 Node[0] Epoch[31] Batch [360-380]	Speed: 26688.14 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652472232592, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 32}}
2022-05-13 15:03:52,593 Node[0] Epoch[31] Time cost=50.059
:::MLLOG {"namespace": "", "time_ms": 1652472232593, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 25593.17153551765}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 32}}
:::MLLOG {"namespace": "", "time_ms": 1652472232593, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 25593.17153551765, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652472232593, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 33}}
2022-05-13 15:03:55,156 Node[0] Epoch[32] Batch [0-20]	Speed: 26754.48 samples/sec	accuracy=nan
2022-05-13 15:03:57,598 Node[0] Epoch[32] Batch [20-40]	Speed: 26722.42 samples/sec	accuracy=nan
2022-05-13 15:04:00,041 Node[0] Epoch[32] Batch [40-60]	Speed: 26721.09 samples/sec	accuracy=nan
2022-05-13 15:04:02,487 Node[0] Epoch[32] Batch [60-80]	Speed: 26693.73 samples/sec	accuracy=nan
2022-05-13 15:04:04,931 Node[0] Epoch[32] Batch [80-100]	Speed: 26709.30 samples/sec	accuracy=nan
2022-05-13 15:04:07,375 Node[0] Epoch[32] Batch [100-120]	Speed: 26711.91 samples/sec	accuracy=nan
2022-05-13 15:04:09,817 Node[0] Epoch[32] Batch [120-140]	Speed: 26731.39 samples/sec	accuracy=nan
2022-05-13 15:04:12,266 Node[0] Epoch[32] Batch [140-160]	Speed: 26657.47 samples/sec	accuracy=nan
2022-05-13 15:04:14,710 Node[0] Epoch[32] Batch [160-180]	Speed: 26703.76 samples/sec	accuracy=nan
2022-05-13 15:04:17,159 Node[0] Epoch[32] Batch [180-200]	Speed: 26665.59 samples/sec	accuracy=nan
2022-05-13 15:04:19,599 Node[0] Epoch[32] Batch [200-220]	Speed: 26744.44 samples/sec	accuracy=nan
2022-05-13 15:04:22,041 Node[0] Epoch[32] Batch [220-240]	Speed: 26736.79 samples/sec	accuracy=nan
2022-05-13 15:04:24,485 Node[0] Epoch[32] Batch [240-260]	Speed: 26711.82 samples/sec	accuracy=nan
2022-05-13 15:04:26,929 Node[0] Epoch[32] Batch [260-280]	Speed: 26707.02 samples/sec	accuracy=nan
2022-05-13 15:04:29,372 Node[0] Epoch[32] Batch [280-300]	Speed: 26719.98 samples/sec	accuracy=nan
2022-05-13 15:04:31,816 Node[0] Epoch[32] Batch [300-320]	Speed: 26708.22 samples/sec	accuracy=nan
2022-05-13 15:04:34,262 Node[0] Epoch[32] Batch [320-340]	Speed: 26698.70 samples/sec	accuracy=nan
2022-05-13 15:04:36,703 Node[0] Epoch[32] Batch [340-360]	Speed: 26736.95 samples/sec	accuracy=nan
2022-05-13 15:04:39,152 Node[0] Epoch[32] Batch [360-380]	Speed: 26655.65 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652472280618, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 33}}
2022-05-13 15:04:40,619 Node[0] Epoch[32] Time cost=48.025
:::MLLOG {"namespace": "", "time_ms": 1652472280619, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26676.866410956623}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 33}}
:::MLLOG {"namespace": "", "time_ms": 1652472280619, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26676.866410956623, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652472280619, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 34}}
2022-05-13 15:04:43,187 Node[0] Epoch[33] Batch [0-20]	Speed: 26700.94 samples/sec	accuracy=nan
2022-05-13 15:04:45,631 Node[0] Epoch[33] Batch [20-40]	Speed: 26709.14 samples/sec	accuracy=nan
2022-05-13 15:04:48,075 Node[0] Epoch[33] Batch [40-60]	Speed: 26705.20 samples/sec	accuracy=nan
2022-05-13 15:04:50,516 Node[0] Epoch[33] Batch [60-80]	Speed: 26744.80 samples/sec	accuracy=nan
2022-05-13 15:04:52,959 Node[0] Epoch[33] Batch [80-100]	Speed: 26724.98 samples/sec	accuracy=nan
2022-05-13 15:04:55,404 Node[0] Epoch[33] Batch [100-120]	Speed: 26699.39 samples/sec	accuracy=nan
2022-05-13 15:04:57,848 Node[0] Epoch[33] Batch [120-140]	Speed: 26710.12 samples/sec	accuracy=nan
2022-05-13 15:05:00,289 Node[0] Epoch[33] Batch [140-160]	Speed: 26734.40 samples/sec	accuracy=nan
2022-05-13 15:05:02,737 Node[0] Epoch[33] Batch [160-180]	Speed: 26673.37 samples/sec	accuracy=nan
2022-05-13 15:05:05,178 Node[0] Epoch[33] Batch [180-200]	Speed: 26739.39 samples/sec	accuracy=nan
2022-05-13 15:05:07,622 Node[0] Epoch[33] Batch [200-220]	Speed: 26711.22 samples/sec	accuracy=nan
2022-05-13 15:05:10,064 Node[0] Epoch[33] Batch [220-240]	Speed: 26731.52 samples/sec	accuracy=nan
2022-05-13 15:05:12,394 Node[0] Epoch[33] Batch [240-260]	Speed: 28022.50 samples/sec	accuracy=nan
2022-05-13 15:05:14,952 Node[0] Epoch[33] Batch [260-280]	Speed: 25521.01 samples/sec	accuracy=nan
2022-05-13 15:05:18,915 Node[0] Epoch[33] Batch [280-300]	Speed: 16470.41 samples/sec	accuracy=nan
2022-05-13 15:05:21,354 Node[0] Epoch[33] Batch [300-320]	Speed: 26771.56 samples/sec	accuracy=nan
2022-05-13 15:05:23,794 Node[0] Epoch[33] Batch [320-340]	Speed: 26746.11 samples/sec	accuracy=nan
2022-05-13 15:05:26,238 Node[0] Epoch[33] Batch [340-360]	Speed: 26713.31 samples/sec	accuracy=nan
2022-05-13 15:05:28,682 Node[0] Epoch[33] Batch [360-380]	Speed: 26708.32 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652472330147, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 34}}
2022-05-13 15:05:30,148 Node[0] Epoch[33] Time cost=49.529
:::MLLOG {"namespace": "", "time_ms": 1652472330148, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 25867.082766691423}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 34}}
:::MLLOG {"namespace": "", "time_ms": 1652472330148, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 25867.082766691423, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652472330149, "event_type": "INTERVAL_START", "key": "epoch_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 915, "epoch_num": 35}}
2022-05-13 15:05:32,717 Node[0] Epoch[34] Batch [0-20]	Speed: 26708.76 samples/sec	accuracy=nan
2022-05-13 15:05:35,163 Node[0] Epoch[34] Batch [20-40]	Speed: 26680.17 samples/sec	accuracy=nan
2022-05-13 15:05:37,607 Node[0] Epoch[34] Batch [40-60]	Speed: 26708.29 samples/sec	accuracy=nan
2022-05-13 15:05:40,050 Node[0] Epoch[34] Batch [60-80]	Speed: 26730.22 samples/sec	accuracy=nan
2022-05-13 15:05:42,492 Node[0] Epoch[34] Batch [80-100]	Speed: 26728.65 samples/sec	accuracy=nan
2022-05-13 15:05:44,936 Node[0] Epoch[34] Batch [100-120]	Speed: 26707.33 samples/sec	accuracy=nan
2022-05-13 15:05:47,381 Node[0] Epoch[34] Batch [120-140]	Speed: 26701.81 samples/sec	accuracy=nan
2022-05-13 15:05:49,825 Node[0] Epoch[34] Batch [140-160]	Speed: 26716.38 samples/sec	accuracy=nan
2022-05-13 15:05:52,268 Node[0] Epoch[34] Batch [160-180]	Speed: 26712.44 samples/sec	accuracy=nan
2022-05-13 15:05:54,713 Node[0] Epoch[34] Batch [180-200]	Speed: 26704.64 samples/sec	accuracy=nan
2022-05-13 15:05:57,154 Node[0] Epoch[34] Batch [200-220]	Speed: 26741.46 samples/sec	accuracy=nan
2022-05-13 15:05:59,597 Node[0] Epoch[34] Batch [220-240]	Speed: 26721.20 samples/sec	accuracy=nan
2022-05-13 15:06:02,041 Node[0] Epoch[34] Batch [240-260]	Speed: 26708.17 samples/sec	accuracy=nan
2022-05-13 15:06:04,484 Node[0] Epoch[34] Batch [260-280]	Speed: 26725.75 samples/sec	accuracy=nan
2022-05-13 15:06:06,927 Node[0] Epoch[34] Batch [280-300]	Speed: 26720.73 samples/sec	accuracy=nan
2022-05-13 15:06:09,372 Node[0] Epoch[34] Batch [300-320]	Speed: 26701.18 samples/sec	accuracy=nan
2022-05-13 15:06:11,817 Node[0] Epoch[34] Batch [320-340]	Speed: 26700.17 samples/sec	accuracy=nan
2022-05-13 15:06:14,266 Node[0] Epoch[34] Batch [340-360]	Speed: 26653.29 samples/sec	accuracy=nan
2022-05-13 15:06:16,712 Node[0] Epoch[34] Batch [360-380]	Speed: 26687.64 samples/sec	accuracy=nan
:::MLLOG {"namespace": "", "time_ms": 1652472378178, "event_type": "INTERVAL_END", "key": "epoch_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 988, "epoch_num": 35}}
2022-05-13 15:06:18,179 Node[0] Epoch[34] Time cost=48.030
:::MLLOG {"namespace": "", "time_ms": 1652472378179, "event_type": "POINT_IN_TIME", "key": "tracked_stats", "value": {"imgs_sec": 26674.424526327395}, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1004, "step": 35}}
:::MLLOG {"namespace": "", "time_ms": 1652472378179, "event_type": "POINT_IN_TIME", "key": "throughput", "value": 26674.424526327395, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1007}}
:::MLLOG {"namespace": "", "time_ms": 1652472378295, "event_type": "INTERVAL_START", "key": "eval_start", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1027, "epoch_num": 35}}
2022-05-13 15:06:20,008 Node[0] Epoch[34] Validation-accuracy=0.766720
2022-05-13 15:06:20,009 Node[0] Epoch[34] Validation-correct-count=4792.000000
2022-05-13 15:06:20,009 Node[0] Epoch[34] Validation-total-count=6250.000000
:::MLLOG {"namespace": "", "time_ms": 1652472380009, "event_type": "INTERVAL_END", "key": "eval_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1050, "epoch_num": 35}}
:::MLLOG {"namespace": "", "time_ms": 1652472380009, "event_type": "POINT_IN_TIME", "key": "eval_accuracy", "value": 0.762, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1056, "epoch_num": 35}}
:::MLLOG {"namespace": "", "time_ms": 1652472380009, "event_type": "INTERVAL_END", "key": "block_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1059, "first_epoch_num": 32}}
:::MLLOG {"namespace": "", "time_ms": 1652472380009, "event_type": "INTERVAL_END", "key": "run_stop", "value": null, "metadata": {"file": "/workspace/image_classification/common/fit.py", "lineno": 1063, "status": "success"}}
+ ret_code=0
+ sleep 3
+ ret_code=0
+ sleep 3
+ ret_code=0
+ sleep 3
+ ret_code=0
+ sleep 3
+ ret_code=0
+ sleep 3
+ ret_code=0
+ sleep 3
+ [[ 0 != 0 ]]
++ date +%s
+ end=1652472396
++ date '+%Y-%m-%d %r'
+ end_fmt='2022-05-13 03:06:36 PM'
+ echo 'ENDING TIMING RUN AT 2022-05-13 03:06:36 PM'
+ result=1801
ENDING TIMING RUN AT 2022-05-13 03:06:36 PM
+ result_name=IMAGE_CLASSIFICATION
+ echo 'RESULT,IMAGE_CLASSIFICATION,,1801,root,2022-05-13 02:36:35 PM'
RESULT,IMAGE_CLASSIFICATION,,1801,root,2022-05-13 02:36:35 PM
+ export PROFILE=0
+ PROFILE=0
+ ret_code=0
+ sleep 3
+ ret_code=0
+ sleep 3
+ [[ 0 != 0 ]]
++ date +%s
+ end=1652472397
++ date '+%Y-%m-%d %r'
+ end_fmt='2022-05-13 03:06:37 PM'
+ echo 'ENDING TIMING RUN AT 2022-05-13 03:06:37 PM'
ENDING TIMING RUN AT 2022-05-13 03:06:37 PM
+ result=1801
+ result_name=IMAGE_CLASSIFICATION
RESULT,IMAGE_CLASSIFICATION,,1801,root,2022-05-13 02:36:36 PM
+ echo 'RESULT,IMAGE_CLASSIFICATION,,1801,root,2022-05-13 02:36:36 PM'
+ export PROFILE=0
+ PROFILE=0
+ [[ 0 != 0 ]]
++ date +%s
+ end=1652472397
++ date '+%Y-%m-%d %r'
+ end_fmt='2022-05-13 03:06:37 PM'
ENDING TIMING RUN AT 2022-05-13 03:06:37 PM
+ echo 'ENDING TIMING RUN AT 2022-05-13 03:06:37 PM'
+ result=1802
+ result_name=IMAGE_CLASSIFICATION
+ echo 'RESULT,IMAGE_CLASSIFICATION,,1802,root,2022-05-13 02:36:35 PM'
RESULT,IMAGE_CLASSIFICATION,,1802,root,2022-05-13 02:36:35 PM
+ export PROFILE=0
+ PROFILE=0
+ [[ 0 != 0 ]]
++ date +%s
+ end=1652472398
++ date '+%Y-%m-%d %r'
+ end_fmt='2022-05-13 03:06:38 PM'
ENDING TIMING RUN AT 2022-05-13 03:06:38 PM
+ echo 'ENDING TIMING RUN AT 2022-05-13 03:06:38 PM'
+ result=1802
+ result_name=IMAGE_CLASSIFICATION
+ echo 'RESULT,IMAGE_CLASSIFICATION,,1802,root,2022-05-13 02:36:36 PM'
RESULT,IMAGE_CLASSIFICATION,,1802,root,2022-05-13 02:36:36 PM
+ export PROFILE=0
+ PROFILE=0
+ [[ 0 != 0 ]]
++ date +%s
+ end=1652472398
++ date '+%Y-%m-%d %r'
+ end_fmt='2022-05-13 03:06:38 PM'
+ echo 'ENDING TIMING RUN AT 2022-05-13 03:06:38 PM'
ENDING TIMING RUN AT 2022-05-13 03:06:38 PM
+ result=1802
+ result_name=IMAGE_CLASSIFICATION
+ echo 'RESULT,IMAGE_CLASSIFICATION,,1802,root,2022-05-13 02:36:36 PM'
+ export PROFILE=0
+ PROFILE=0
RESULT,IMAGE_CLASSIFICATION,,1802,root,2022-05-13 02:36:36 PM
+ [[ 0 != 0 ]]
++ date +%s
+ end=1652472399
++ date '+%Y-%m-%d %r'
+ end_fmt='2022-05-13 03:06:39 PM'
+ echo 'ENDING TIMING RUN AT 2022-05-13 03:06:39 PM'
ENDING TIMING RUN AT 2022-05-13 03:06:39 PM
+ result=1803
+ result_name=IMAGE_CLASSIFICATION
+ echo 'RESULT,IMAGE_CLASSIFICATION,,1803,root,2022-05-13 02:36:36 PM'
+ export PROFILE=0
+ PROFILE=0
RESULT,IMAGE_CLASSIFICATION,,1803,root,2022-05-13 02:36:36 PM
+ [[ 0 != 0 ]]
++ date +%s
+ end=1652472399
++ date '+%Y-%m-%d %r'
+ end_fmt='2022-05-13 03:06:39 PM'
+ echo 'ENDING TIMING RUN AT 2022-05-13 03:06:39 PM'
ENDING TIMING RUN AT 2022-05-13 03:06:39 PM
+ result=1803
+ result_name=IMAGE_CLASSIFICATION
+ echo 'RESULT,IMAGE_CLASSIFICATION,,1803,root,2022-05-13 02:36:36 PM'
RESULT,IMAGE_CLASSIFICATION,,1803,root,2022-05-13 02:36:36 PM
+ export PROFILE=0
+ PROFILE=0
+ [[ 0 != 0 ]]
++ date +%s
+ end=1652472400
++ date '+%Y-%m-%d %r'
+ end_fmt='2022-05-13 03:06:40 PM'
+ echo 'ENDING TIMING RUN AT 2022-05-13 03:06:40 PM'
ENDING TIMING RUN AT 2022-05-13 03:06:40 PM
+ result=1804
+ result_name=IMAGE_CLASSIFICATION
+ echo 'RESULT,IMAGE_CLASSIFICATION,,1804,root,2022-05-13 02:36:36 PM'
+ export PROFILE=0
+ PROFILE=0
RESULT,IMAGE_CLASSIFICATION,,1804,root,2022-05-13 02:36:36 PM
