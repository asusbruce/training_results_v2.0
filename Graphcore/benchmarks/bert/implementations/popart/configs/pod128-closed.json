{
    "submission_division": "closed",
    "submission_platform": "ipu-pod128-POPART-closed",
    "loss_averaging_basis": "pertoken",
    "accuracy_averaging_basis": "pertoken",
    "task": "PRETRAINING",
    "use_prepacked_pretraining_dataset": true,
    "max_sequences_per_pack": 3,
    "avg_seq_per_pack": 2,
    "num_layers": 24,
    "encoder_start_pipeline_stage": 1,
    "att_ffn_placement": [[1, [3, 3]], [2, [3, 3]], [3, [3, 3]], [4, [4, 3]], [5, [3, 4]], [6, [4, 3]], [7, [3, 4]], [0, [1, 1]]],
    "hidden_size": 1024,
    "attention_heads": 16,
    "sequence_length": 512,
    "mask_tokens": 76,
    "vocab_length": 30912,
    "popart_dtype": "FLOAT16",
    "lamb_accl_dtype": "FLOAT16",
    "activation_checkpoint_dtype": "FLOAT16",
    "no_dropout": false,
    "no_attn_dropout": false,
    "stochastic_rounding": true,
    "enable_half_partials": true,
    "batches_per_step":  1,
    "epochs": 1,
    "epochs_per_save": 1,
    "steps_per_log": 40,
    "aggregate_metrics_over_steps": 1,
    "loss_scaling": 10.0,
    "batch_size": 3,
    "gradient_accumulation_factor": 64,
    "replication_factor": 16,
    "split_qkv": false,
    "split_linear_layers": false,
    "optimizer_state_offchip": false,
    "gradient_reduction_type": "Mean",
    "optimizer": "LAMB_NO_BIAS",
    "beta1": 0.62,
    "beta2": 0.885,
    "weight_decay": 1e-3,
    "lr_bert_schedule": {"init_lr": 3.5e-3, "num_training_steps": 700, "num_warmup_steps": 0},
    "input_files": ["data/jan2020_three_seq_per_pack_with_duplications/strategy*"],
    "on_the_spot_validation_files": ["data/jan2020_packed_eval_10k/strategy*"],
    "max_training_sequences": 4500000,
    "shuffle": true,
    "duplication_factor": 3,
    "epochs_to_cache": 1,
    "embedding_serialization_vocab_steps": 4,
    "available_memory_proportion": [1, 1, 1, 1, 1, 1, 1, 1],
    "execution_mode": "PIPELINE",
    "checkpoint_dir": "checkpoints/mk2/pod128-closed",
    "tf_checkpoint": "tf-checkpoints/bs64k_32k_ckpt/model.ckpt-28252",
    "no_validation": true,
    "engine_cache": "engine_cache/pod128-closed",
    "replicated_tensor_sharding": true,
    "projection_bias": true,
    "reduce_nsp_overhead": false,
    "merge_collectives" : true,
    "gradient_clipping_norm": 100.0
}